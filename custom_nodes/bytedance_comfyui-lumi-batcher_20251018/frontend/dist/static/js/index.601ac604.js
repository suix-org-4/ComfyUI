(()=>{"use strict";var e={7666:function(e,t,a){let l,n,s,r,i;a(9343);var o,c,d,u,h,p,m,g,_,f,x,v=a(2676),C=a(8751),w=a(2699),j=a.n(w);let y=new Set(["width","height","top","right","bottom","left","paddingTop","paddingRight","paddingBottom","paddingLeft","marginTop","marginRight","marginBottom","marginLeft","maxWidth","maxHeight","fontSize"]),S=e=>e.replace(/([A-Z])/g,(e,t,a)=>0===a?e.toLowerCase():`-${e.toLowerCase()}`),N=e=>Object.entries(e).reduce((e,t)=>{let[a,l]=t,n=l;return"number"==typeof l&&y.has(a)&&(n+="px"),`${e}${S(a)}:${n};`},""),b={width:"100%",height:"100%",position:"absolute",top:0,left:0,zIndex:9999},k=(e,t)=>{let a=document.createElement("div");(0,w.isString)(t)?a.classList.add(t):a.style.cssText=N(Object.assign({},b,t??{})),document.body.appendChild(a);let l=(0,C.createRoot)(a);return l.render(e),{unmount:()=>{l.unmount(),a.remove()}}};var T=a(5271),E=a(5523),A=a(6416),M=a(9189),I=((o={}).TASK_LIST_TITLE="task_list_title",o.TASK_LIST_SEARCH_PLACEHOLDER="task_list_search_placeholder",o.NEW_GUIDER_HELP="new_guider_help",o.CREATE_BATCH_TASK="create_batch_task",o.WINDOW_MINIMIZE="window_minimize",o.DOWNLOAD="download",o.DOWNLOAD_ONLY_PICTURE="download_only_picture",o.DOWNLOAD_ALL_FILES="download_all_files",o.DOWNLOAD_END="download_end",o.RESULT_DIFF_CHECK="result_diff_check",o.COPY_PARAMS="copy",o.CANCEL_TASK="cancel_task",o.BATCH_TASK_TITLE="batch_task_title",o.PARAM_VALUES_COUNT_UNIT="param_values_count_unit",o.FINAL_RESULT_COUNT="final_result_count",o.PARAMS_NAME="params_name",o.PARAM_NAME="param_name",o.PARAM_LIST="param_list",o.PARAMS_COUNT="params_count",o.PARAMS_COPIES="params_copies",o.CONTAIN_PARAMS="contain_params",o.SELECT_NODE_PLACEHOLDER="select_node_placeholder",o.BATCH_ADD_VALUES_PLACEHOLDER="batch_add_values_placeholder",o.BATCH_ADD_VALUES_PLACEHOLDER_SIMPLE="batch_add_values_placeholder_simple",o.ADD_PARAM="add_param",o.EXIT="exit",o.SINGLE_PARAM_TEXT="single_param_text",o.GROUP_PARAM_TEXT="group_param_text",o.SAVE_PARAM_CONFIG="save_param_config",o.SAVE_PARAM_CONFIG_CONTINUE="save_param_config_continue",o.SUBMIT_CREATE_BATCH_TASK="submit_create_batch_task",o.SPENT_LONG_TIME_TEXT="spent_long_time_text",o.GROUP_PARAM_TYPE="group_param_type",o.SINGLE_PARAM_TYPE="single_param_type",o.SHARE="share",o.RESULT_SHARE="result_share",o.SHARE_LINK_COPIED="share_link_copied",o.SHARE_ID_UNKNOW="share_id_unknow",o.TABLE_CONFIG_BOARD="table_config_board",o.TABLE_CONFIG_GROUP="table_config_group",o.X_AXIS="x_axis",o.Y_AXIS="y_axis",o.SELECT_PARAM_PLACEHOLDER="select_param_placeholder",o.RESET="reset",o.CONFIRM="confirm",o.STATUS_RUNNING="status_running",o.STATUS_CREATING="status_creating",o.STATUS_COMPLETED="status_completed",o.STATUS_SUCCEED="status_succeed",o.STATUS_FAILED="status_failed",o.STATUS_CANCELLED="status_cancelled",o.STATUS_PARTIAL_SUCCEED="status_partial_succeed",o.STATUS_WAITING="status_waiting",o.STATUS_DIRTY="status_dirty",o.DELETE="Delete",o.EDIT="Edit",o.CREATE_DATASET="create_dataset",o.DATASET_LIST_SEARCH_PLACEHOLDER="dataset_list_search_placeholder",o),L=((c={}).ZH="zh-CN",c.EN="en-US",c);let z={"zh-CN":"简体中文","en-US":"English"},R={[I.TASK_LIST_TITLE]:{"zh-CN":"批量任务列表","en-US":"Task List"},[I.TASK_LIST_SEARCH_PLACEHOLDER]:{"zh-CN":"请输入任务名称","en-US":"Please enter the task name"},[I.NEW_GUIDER_HELP]:{"zh-CN":"新手帮助","en-US":"Assistance for Beginners"},[I.CREATE_BATCH_TASK]:{"zh-CN":"新建批量任务","en-US":"New Task"},[I.WINDOW_MINIMIZE]:{"zh-CN":"窗口最小化","en-US":"Minimize"},[I.DOWNLOAD]:{"zh-CN":"下载","en-US":"Download"},[I.DOWNLOAD_ONLY_PICTURE]:{"zh-CN":"仅下载图（快）","en-US":"Download the pictures"},[I.DOWNLOAD_ALL_FILES]:{"zh-CN":"下载图和全部文件（慢）","en-US":"Download the pictures and files"},[I.DOWNLOAD_END]:{"zh-CN":"开始下载批量任务结果","en-US":"Start downloading batch task results"},[I.RESULT_DIFF_CHECK]:{"zh-CN":"结果对比","en-US":"Preview of Results"},[I.COPY_PARAMS]:{"zh-CN":"复制参数","en-US":"copy"},[I.CANCEL_TASK]:{"zh-CN":"取消任务","en-US":"cancel"},[I.BATCH_TASK_TITLE]:{"zh-CN":"新建任务，为任务取个名字吧","en-US":"Create a new task and give it a name"},[I.PARAM_VALUES_COUNT_UNIT]:{"zh-CN":"份","en-US":"portion"},[I.FINAL_RESULT_COUNT]:{"zh-CN":"最终生成数量","en-US":"Quality of the final result"},[I.PARAMS_NAME]:{"zh-CN":"参数","en-US":"parameters"},[I.PARAM_NAME]:{"zh-CN":"参数","en-US":"parameter"},[I.PARAM_LIST]:{"zh-CN":"参数列表","en-US":"Parameter list"},[I.PARAMS_COUNT]:{"zh-CN":"参数个数","en-US":"The number of parameters"},[I.PARAMS_COPIES]:{"zh-CN":"参数份数","en-US":"The number of parameter copies"},[I.CONTAIN_PARAMS]:{"zh-CN":"内含参数","en-US":"Contained parameters"},[I.SELECT_NODE_PLACEHOLDER]:{"zh-CN":"请选择或模糊搜索","en-US":"Please select or search"},[I.BATCH_ADD_VALUES_PLACEHOLDER]:{"zh-CN":"数值，可通过“；”批量添加，enter回车键确定提交","en-US":"，You can complete batch addition through ; and complete the input by pressing Enter."},[I.BATCH_ADD_VALUES_PLACEHOLDER_SIMPLE]:{"zh-CN":"值，enter键提交","en-US":"，You can complete the input by pressing Enter."},[I.ADD_PARAM]:{"zh-CN":"参数值","en-US":"parameter"},[I.SINGLE_PARAM_TEXT]:{"zh-CN":"参数(不捆绑)","en-US":"parameter"},[I.GROUP_PARAM_TEXT]:{"zh-CN":"组合参数(捆绑)","en-US":"parameter（pair/multivariate tuple）"},[I.SAVE_PARAM_CONFIG]:{"zh-CN":"完成","en-US":"Complete"},[I.SAVE_PARAM_CONFIG_CONTINUE]:{"zh-CN":"完成后继续","en-US":"Add More Parameters"},[I.SUBMIT_CREATE_BATCH_TASK]:{"zh-CN":"提交任务","en-US":"Submit the task"},[I.SPENT_LONG_TIME_TEXT]:{"zh-CN":"这个过程可能耗时较长，请耐心等待","en-US":"This may take a while"},[I.GROUP_PARAM_TYPE]:{"zh-CN":"组合参数","en-US":"Parameter（pair/multivariate tuple）"},[I.SINGLE_PARAM_TYPE]:{"zh-CN":"单参数","en-US":"Parameter"},[I.SHARE]:{"zh-CN":"分享","en-US":"share"},[I.RESULT_SHARE]:{"zh-CN":"结果分享","en-US":"share"},[I.SHARE_LINK_COPIED]:{"zh-CN":"已复制分享链接","en-US":"Share link copied"},[I.SHARE_ID_UNKNOW]:{"zh-CN":"链接中未包含分享 id","en-US":"The link does not contain a share id"},[I.TABLE_CONFIG_BOARD]:{"zh-CN":"表格配置面板","en-US":"Table configuration panel"},[I.TABLE_CONFIG_GROUP]:{"zh-CN":"按以下参数聚合","en-US":"Aggregate by the following parameters"},[I.X_AXIS]:{"zh-CN":"横轴","en-US":"X-axis"},[I.Y_AXIS]:{"zh-CN":"纵轴","en-US":"Y-axis"},[I.SELECT_PARAM_PLACEHOLDER]:{"zh-CN":"请选择参数","en-US":"Select parameters"},[I.STATUS_SUCCEED]:{"zh-CN":"成功","en-US":"Succeed"},[I.STATUS_COMPLETED]:{"zh-CN":"推理完成","en-US":"Completed"},[I.STATUS_FAILED]:{"zh-CN":"失败","en-US":"Failed"},[I.STATUS_CANCELLED]:{"zh-CN":"已取消","en-US":"Cancelled"},[I.STATUS_PARTIAL_SUCCEED]:{"zh-CN":"部分成功","en-US":"Partially Succeed"},[I.STATUS_RUNNING]:{"zh-CN":"生成中","en-US":"Running"},[I.STATUS_CREATING]:{"zh-CN":"创建中","en-US":"Creating"},[I.STATUS_WAITING]:{"zh-CN":"排队中","en-US":"Waiting"},[I.STATUS_DIRTY]:{"zh-CN":"已失效","en-US":"Dirty"},[I.RESET]:{"zh-CN":"重置","en-US":"Reset"},[I.CONFIRM]:{"zh-CN":"确定","en-US":"Confirm"},[I.EXIT]:{"zh-CN":"退出","en-US":"Exit"},[I.DELETE]:{"zh-CN":"删除","en-US":"Delete"},[I.EDIT]:{"zh-CN":"编辑","en-US":"Edit"},[I.CREATE_DATASET]:{"zh-CN":"新建数据集","en-US":"Create Dataset"},[I.DATASET_LIST_SEARCH_PLACEHOLDER]:{"zh-CN":"请输入数据集名称","en-US":"Please enter the dataset name"}};var U=a(833);let P="comfyui-lumi-batcher-language",O=new class{getLanguage(){return window.localStorage.getItem(P)||L.EN}setLanguage(e){window.localStorage.setItem(P,e)}setRuntimeLanguage(e){this.language=e}getText(e){return R[e][this.language]}constructor(){(0,U._)(this,"language",void 0),this.language=this.getLanguage()}};var Z=((d={})[d.List=0]="List",d[d.Creator=1]="Creator",d[d.Result=2]="Result",d);let D={uiConfig:{showVersion:!1,showTitle:!1,showCreateTask:!1,showCopy:!1,showCancel:!1,listPaddingHorizontal:0},containerRect:{clientHeight:0,clientWidth:0},task:{newGuideHelpLink:"",outputRuleLink:"https://bytedance.larkoffice.com/docx/LGLWdPIj8ooQyxxMAOQcWmR8nCh#AcwWdo7MFozfVHxDsVucEIienAw"}},F=(0,M.U)(e=>({...D,reset(){e(D)}})),H={type:Z.List,isLock:!1,language:O.getLanguage()},B=(0,M.U)(e=>({...H,lock(){e({isLock:!0})},unlock(){e({isLock:!1})},changeType(t){let a=F.getState().onCompStatusChange;a&&a(t),e({type:t})},reset(){e(H)}}));var V=a(7328);function W(e){let{style:t,direction:a,wrap:l,justify:n,align:s,flex:r,gap:i,...o}=e,c={...t,display:"flex",flex:r,flexDirection:a,flexWrap:"boolean"==typeof l?l?"wrap":"nowrap":l,justifyContent:n,alignItems:s,gap:i};return(0,v.jsx)("div",{...o,style:c})}let $={simplified_chinese:{"en-US":"简体中文","zh-CN":"简体中文"},text:{"en-US":"Text","zh-CN":"文本"},picture:{"en-US":"Image","zh-CN":"图片"},video:{"en-US":"Video","zh-CN":"视频"},number:{"en-US":"Number","zh-CN":"数字"},parameter_1:{"en-US":"Parameter 1","zh-CN":"参数1"},generating:{"en-US":"Running","zh-CN":"生成中"},in_line:{"en-US":"Waiting","zh-CN":"排队中"},success:{"en-US":"Success","zh-CN":"成功"},fail:{"en-US":"Failed","zh-CN":"失败"},partial_success:{"en-US":"Partially Succeed","zh-CN":"部分成功"},cancelled:{"en-US":"Cancelled","zh-CN":"已取消"},expired:{"en-US":"Expired","zh-CN":"已失效"},"no_relevant_content__try_another_word~":{"en-US":"No relevant content, try another word~","zh-CN":"无相关内容，换个词试试～"},"network_exception__try_again_later~":{"en-US":"Network exception, please try again later~","zh-CN":"网络异常，稍后再试～"},"{placeholder1}_batch_generation":{"en-US":"{placeholder1} batch generation","zh-CN":"{placeholder1} 批量生成"},meet_various_debugging_scenarios__debugging_parameters_can_be_freely_combined__a:{"en-US":"Meet various debugging scenarios, debugging parameters can be freely combined, and generation results support batch comparison preview","zh-CN":"满足各种调试场景，调试参数可自由组合，生成结果支持批量对比预览"},"batch_tool_version_number__{batchtoolsversion}":{"en-US":"Batch tool version number: {BatchToolsVersion}","zh-CN":"批量工具版本号: {BatchToolsVersion}"},serial_number:{"en-US":"Serial number","zh-CN":"序号"},task_name:{"en-US":"Task name","zh-CN":"任务名称"},creation_time:{"en-US":"Creation time","zh-CN":"创建时间"},generation_quantity:{"en-US":"Generation quantity","zh-CN":"生成数量"},state:{"en-US":"Status","zh-CN":"状态"},operation:{"en-US":"Operation","zh-CN":"操作"},task_list_is_empty:{"en-US":"Task list is empty","zh-CN":"任务列表为空"},"loading_please_wait~":{"en-US":"Loading, please wait~","zh-CN":"加载中，请稍后～"},the_result_set_has_been_generated_and_is_to_be_packaged__please_wait_a_moment_:{"en-US":"The result set has been generated and is to be packaged, please wait a moment","zh-CN":"结果集已生成，待打包处理，请稍等"},the_result_set_is_being_packaged_and_processed__please_wait_a_moment_:{"en-US":"The result set is being packaged and processed, please wait a moment","zh-CN":"结果集已正在打包处理，请稍等"},result_set_packaging_processing_failed:{"en-US":"Result set packaging processing failed","zh-CN":"结果集打包处理失败"},the_result_set_has_been_packaged__click_to_download_:{"en-US":"The result set has been packaged, click to download","zh-CN":"结果集已打包完成，点击下载"},data_is_being_prepared__please_wait___:{"en-US":"Data is being prepared, please wait...","zh-CN":"正在准备数据，请稍后..."},"Are_you_sure_you_want_to_switch_the_table_configuration?_the_current_custom_row__column_configuration_will_be_cleared":{"en-US":"Are you sure you want to switch the table configuration? The current custom row and column configuration will be cleared","zh-CN":"确定切换表格配置吗，切换后将清空当前自定义行、列配置"},please_enter_a_data_item_name:{"en-US":"Search data item","zh-CN":"搜索数据项"},has_selected:{"en-US":"Selected","zh-CN":"已选"},items:{"en-US":"Items","zh-CN":"项"},all_choose:{"en-US":"Select all","zh-CN":"全选"},clear_all:{"en-US":"Clear all","zh-CN":"清空"},no_search_results_yet__try_searching_for_other_content:{"en-US":"No search results yet, try searching for other content","zh-CN":"暂无搜索结果，试试搜索其他内容"},reset_to_default:{"en-US":"Reset to default","zh-CN":"恢复预设"},cancel:{"en-US":"Cancel","zh-CN":"取消"},confirm:{"en-US":"Confirm","zh-CN":"确定"},no_data_yet:{"en-US":"No data yet","zh-CN":"暂无数据"},checking_workflow:{"en-US":"Checking workflow","zh-CN":"正在检测工作流"},exit_operation_means_that_your_batch_tasks_and_parameters_will_not_be_preserved_:{"en-US":"Parameter settings will not be saved. Exit now? ","zh-CN":"退出操作意味着你所进行的批量任务和参数将不会被保留。你确定要退出吗"},give_up:{"en-US":"Cancel","zh-CN":"放弃"},ok_to_quit:{"en-US":"Exit","zh-CN":"确定退出"},new_batch_task:{"en-US":"New batch task","zh-CN":"新建批量任务"},custom_parameters:{"en-US":"Custom parameters","zh-CN":"自定义参数"},parameter_name:{"en-US":"Parameter name","zh-CN":"参数名"},type:{"en-US":"Type","zh-CN":"类型"},parameter:{"en-US":"Parameter","zh-CN":"参数"},source:{"en-US":"Source","zh-CN":"来源"},no_content_yet:{"en-US":"No content yet","zh-CN":"暂无内容"},come_up_with_a_name_for_the_batch_task_:{"en-US":"Come up with a name for the batch task~","zh-CN":"为批量任务取个名字吧～"},final_number_of_generate_count_:{"en-US":"Final number of generate count=","zh-CN":"最终生成数="},parameter_1_x_parameter_2_x____parameter_n:{"en-US":"Parameter 1 x Parameter 2 x... Parameter N","zh-CN":"参数1 x 参数2 x... 参数N"},support_custom_naming__which_is_convenient_for_you_to_manage_and_filter_the_grap:{"en-US":"Support custom naming, which is convenient for you to manage and filter the graph results. If not named, the system will randomly assign~","zh-CN":"支持自定义命名，便于你管理和跑图结果筛选。未命名则系统随机分配～"},type_:{"en-US":"Type:","zh-CN":"类型："},parameter_:{"en-US":"Parameter:","zh-CN":"参数："},reset:{"en-US":"Reset","zh-CN":"重置"},ok:{"en-US":"OK","zh-CN":"确定"},parameter_value_:{"en-US":"Parameter value:","zh-CN":"参数值："},"{internal_name}_value__enter_key_to_submit":{"en-US":"{internal_name} value, press Enter to submit","zh-CN":"{internal_name}值，enter键提交"},"parameter_{placeholder1}":{"en-US":"Parameter {placeholder1}","zh-CN":"参数{placeholder1}"},"are_you_sure_to_delete_this_parameter?":{"en-US":"Are you sure to delete this parameter?","zh-CN":"确认删除该参数吗？"},create_batch_task_successfully:{"en-US":"Batch task created successfully","zh-CN":"创建批量任务成功"},"confirm_to_cancel_the_task?":{"en-US":"Confirm to cancel the task?","zh-CN":"确认取消任务吗？"},custom_rows:{"en-US":"Custom rows","zh-CN":"自定义行"},custom_columns:{"en-US":"Custom columns","zh-CN":"自定义列"},parameter_copied_successfully:{"en-US":"Parameter copied successfully","zh-CN":"参数复制成功"},please_select_or_fuzzy_search__select_at_least_2:{"en-US":"Please select or fuzzy search, select at least 2","zh-CN":"请选择或模糊搜索，至少选择2个"},"random_seed_{placeholder1}":{"en-US":"Random seed {placeholder1}","zh-CN":"随机种子{placeholder1}"},please_enter_the_number_you_want_to_generate_randomly_:{"en-US":"Please enter the number you want to generate randomly","zh-CN":"请输入你想随机生成的个数"},random_generation:{"en-US":"Random generation","zh-CN":"随机生成"},"combine_parameters_(bundled)_select_at_least_two_parameters":{"en-US":"Add at least two parameters for combination","zh-CN":"组合参数（捆绑）至少选择两个参数"},save:{"en-US":"Save","zh-CN":"保存"},newbie_help:{"en-US":"Beginner's Guide","zh-CN":"新手帮助"},guide_image_alt:{"en-US":"Guide image","zh-CN":"引导图片"},export_the_file_template__fill_in_the_information__and_upload_it_to_complete_the:{"en-US":"Export the file template, fill in the information, then upload to complete parsing~","zh-CN":"导出文件模版，填写信息后，上传即可完成解析～"},"download_the_{filetype}_template":{"en-US":"Download {fileType} template","zh-CN":"下载{fileType}模板"},row_data:{"en-US":"Row data","zh-CN":"行数据"},"successful_{success};_failed__{placeholder3}":{"en-US":"Successful {success}; Failed {placeholder3}","zh-CN":"已成功：{success}；已失败：{placeholder3}"},reason_for_failure_:{"en-US":"Reason for failure: ","zh-CN":"失败原因："},"the_specific_reasons_are__{placeholder1}":{"en-US":"The specific reasons are: {placeholder1}","zh-CN":"。具体原因有：{placeholder1}"},cancel_task_successfully:{"en-US":"Cancel task successfully","zh-CN":"取消任务成功"},cancel_task_failed:{"en-US":"Cancel task failed","zh-CN":"取消任务失败"},it_is_detected_that_there_is_no_output_node_in_the_current_workflow__please_add_one:{"en-US":"No output node detected in current workflow. Please add one before batch validation!","zh-CN":"检测到当前工作流没有输出节点，请添加相关节点后再进行批量验证!"},please_check_the_output_node_specification__:{"en-US":'Please check output node specifications. The output node must be a "LumiBatchOutput" node.',"zh-CN":"输出节点规范请查看,"},current_workflow_cannot_be_executed:{"en-US":"Current workflow cannot be executed. Please ensure workflow runs successfully before batch validation.","zh-CN":"当前工作流跑不通，请跑通工作流后再进行批量验证"},previous_cell:{"en-US":"Previous cell","zh-CN":"上一个单元格"},next_cell:{"en-US":"Next cell","zh-CN":"后一个单元格"},this_task_is_not_compatible_with_the_current_workflow_and_cannot_perform_a_copy_:{"en-US":"This task is not compatible with the current workflow and cannot perform a copy operation","zh-CN":"当前任务与当前工作流不兼容，无法进行复制操作"},help_documentation:{"en-US":"Help documentation","zh-CN":"帮助文档"},confirm_to_delete_the_task:{"en-US":"Deleting the task will also delete the task results. Confirm deletion?","zh-CN":"删除任务同时会删除任务结果，确定删除吗？"},delete_task:{"en-US":"Delete task","zh-CN":"删除任务"},delete_task_successfully:{"en-US":"Delete task successfully","zh-CN":"删除任务成功"},delete_task_failed:{"en-US":"Delete task failed","zh-CN":"删除任务失败"},download:{"en-US":"Download","zh-CN":"下载"},download_failed:{"en-US":"Download failed","zh-CN":"下载失败"},the_parameter_type_check_failed__please_check_the_parameter_configuration__:{"en-US":"The parameter type check failed. Please check the parameter configuration~","zh-CN":"参数类型检查失败，请检查参数配置~"},the_parameters_have_been_successfully_uploaded_and_parsed__the_details_are_as_follow:{"en-US":"The parameters have been successfully uploaded and parsed. The details are as follows:","zh-CN":"参数已成功上传并解析，详情如下："}},G={};class K{static t(e,t,a){let l=O.getLanguage(),n=$[e],s=a;return n?s=n[l]:G[e]={[L.EN]:a,[L.ZH]:a},t&&Object.keys(t).forEach(e=>{let a=RegExp(`\\{${e}\\}`,"g");s=s.replace(a,t[e])}),s}static getTranslationsData(){return JSON.stringify($)}static getLoseTranslationData(){return JSON.stringify(G)}}window.ComfyUILumiBatcherI18n=K;var q=a(4456),Y=a(6713),X=a(1142);let J=e=>(0,v.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16",...e,children:[(0,v.jsx)("g",{clipPath:"url(#language_svg__a)",children:(0,v.jsx)("path",{stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",strokeOpacity:.85,strokeWidth:1.5,d:"M8 1.334C10 2.667 10.615 5.528 10.666 8 10.615 10.472 10 13.334 8 14.667M8 1.334C6 2.666 5.385 5.527 5.333 8 5.385 10.472 6 13.334 8 14.667M8 1.334A6.667 6.667 0 0 0 1.333 8M8 1.334A6.667 6.667 0 0 1 14.666 8M8 14.667A6.667 6.667 0 0 0 14.666 8M8 14.667A6.667 6.667 0 0 1 1.333 8m13.333 0c-1.333 2-4.194 2.615-6.666 2.667C5.528 10.615 2.666 10 1.333 8m13.333 0C13.333 6 10.472 5.385 8 5.334 5.528 5.385 2.666 6 1.333 8"})}),(0,v.jsx)("defs",{children:(0,v.jsx)("clipPath",{id:"language_svg__a",children:(0,v.jsx)("path",{fill:"#fff",d:"M0 0h16v16H0z"})})})]});var Q=a(9981),ee=a.n(Q);let et=[{key:L.ZH,label:"简体中文",icon:e=>(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16",...e,children:(0,v.jsx)("path",{fill:"#fff",fillOpacity:.85,fillRule:"evenodd",d:"M2.666 3c0-.184.15-.333.334-.333h10c.184 0 .333.149.333.333v10c0 .184-.15.333-.333.333H3A.333.333 0 0 1 2.666 13zM3 1.333c-.92 0-1.667.746-1.667 1.667v10c0 .92.746 1.667 1.667 1.667h10c.92 0 1.666-.747 1.666-1.667V3c0-.92-.746-1.667-1.666-1.667zM8 4c.368 0 .666.298.666.667v.666h2.667c.368 0 .667.299.667.667v3.333a.667.667 0 0 1-.667.667H8.666v1.667a.667.667 0 1 1-1.333 0V10H4.666A.667.667 0 0 1 4 9.333V6c0-.368.298-.667.666-.667h2.667v-.666C7.333 4.298 7.631 4 8 4M5.333 6.667h2v2h-2zm3.333 0v2h2v-2z",clipRule:"evenodd"})})},{key:L.EN,label:"English",icon:e=>(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16",...e,children:(0,v.jsx)("path",{fill:"#fff",fillOpacity:.85,fillRule:"evenodd",d:"M3 2.667A.333.333 0 0 0 2.666 3v10c0 .184.15.333.334.333h10c.184 0 .333-.149.333-.333V3A.333.333 0 0 0 13 2.667zM1.333 3c0-.92.746-1.667 1.667-1.667h10c.92 0 1.666.746 1.666 1.667v10c0 .92-.746 1.667-1.666 1.667H3c-.92 0-1.667-.747-1.667-1.667zm8 5.167v2.166a.667.667 0 0 1-1.333 0v-4a.667.667 0 0 1 1.314-.159 2.167 2.167 0 0 1 3.02 1.993v2.166a.667.667 0 0 1-1.334 0V8.167a.833.833 0 0 0-1.667 0M5 6.333v1h1.833a.667.667 0 0 1 0 1.334H5v1h1.833a.667.667 0 0 1 0 1.333h-2.5a.667.667 0 0 1-.667-.667V5.667c0-.369.299-.667.667-.667H7a.667.667 0 0 1 0 1.333z",clipRule:"evenodd"})})}],ea=()=>{let e=B(e=>e.language);return(0,v.jsx)(q.Z,{position:"br",droplist:(0,v.jsx)(Y.Z,{selectedKeys:[e],onClickMenuItem:e=>{O.setLanguage(e),window.location.reload()},children:et.map(t=>(0,v.jsx)(Y.Z.Item,{className:"language-menu-item",children:(0,v.jsxs)(V.Z,{size:8,className:ee()("language-menu-item-content",e===t.key?"language-trigger-button-active":""),children:[(0,v.jsx)(t.icon,{}),(0,v.jsx)("span",{style:{marginRight:30},children:t.label}),e===t.key?(0,v.jsx)(X.Z,{style:{color:"var(--text-color-text-1, rgba(255, 255, 255, 0.85))"}}):(0,v.jsx)("div",{style:{width:16}})]})},t.key))}),children:(0,v.jsx)(E.Z,{className:"language-trigger-button",type:"default",size:"small",icon:(0,v.jsx)(J,{}),children:z[e]})})},el=e=>(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16",...e,children:(0,v.jsx)("path",{stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",strokeOpacity:.9,strokeWidth:1.5,d:"M2.667 9.333h4m0 0v4m0-4L2 14m11.333-7.333h-4m0 0v-4m0 4L14 2"})});var en=a(1355);let es={appId:773786,channel:"cn",appName:"ComfyUI-Lumi-Batcher"},er=(()=>{if((0,w.isNil)(es))throw Error("Failed to get tea config with unknown region = cn");return es})(),ei=new class{config(e){this._uid=e,this._instance.config({user_unique_id:e,_staging_flag:0})}configParams(e){this._instance.config({...e})}send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._instance.event(e,t)}constructor(){(0,U._)(this,"_instance",new en.P(er.appName)),(0,U._)(this,"_uid",""),this._instance.init({app_id:er.appId,channel:er.channel}),this._instance.start()}};var eo=((u={}).BatchToolsEntranceExpose="batch_tools_entrance_expose",u.BatchToolsOpenModal="batch_tools_open_modal",u.BatchToolsCreateTask="batch_tools_create_task",u.BatchToolsSubmitTask="batch_tools_submit_task",u.BatchToolsWindowMinimize="batch_tools_window_minimize",u.BatchToolsDownloadResult="batch_tools_download_result",u.BatchToolsPreviewResult="batch_tools_preview_result",u.BatchToolsCopyParams="batch_tools_copy_params",u.BatchToolsCancelTask="batch_tools_cancel_task",u);let ec=()=>{ei.send(eo.BatchToolsEntranceExpose)},ed=()=>{ei.send(eo.BatchToolsOpenModal)},eu=()=>{ei.send(eo.BatchToolsCreateTask)},eh=()=>{ei.send(eo.BatchToolsSubmitTask)},ep=()=>{ei.send(eo.BatchToolsWindowMinimize)},em=()=>{ei.send(eo.BatchToolsDownloadResult)},eg=()=>{ei.send(eo.BatchToolsPreviewResult)},e_=()=>{ei.send(eo.BatchToolsCopyParams)},ef=()=>{ei.send(eo.BatchToolsCancelTask)};function ex(e){let{className:t,...a}=e,l=B(e=>e.closeModal);return(0,v.jsx)(E.Z,{...a,className:ee()("batch-tools-modal-button-close",t),type:"default",size:"small",icon:(0,v.jsx)(el,{}),onClick:()=>{ep(),l&&l()},children:O.getText(I.WINDOW_MINIMIZE)})}function ev(){return(0,v.jsxs)(W,{className:"batch-tools-modal-header",justify:"space-between",align:"center",children:[(0,v.jsxs)(V.Z,{size:4,children:[(0,v.jsx)("div",{className:"batch-tools-modal-header-title",children:K.t("{placeholder1}_batch_generation",{placeholder1:"ComfyUI-Lumi-Batcher"},"{placeholder1} 批量生成")}),(0,v.jsx)("div",{className:"batch-tools-modal-header-subtitle",children:K.t("meet_various_debugging_scenarios__debugging_parameters_can_be_freely_combined__a",{},"满足各种调试场景，调试参数可自由组合，生成结果支持批量对比预览")})]}),(0,v.jsxs)(V.Z,{size:24,children:[(0,v.jsx)(ea,{}),(0,v.jsx)(ex,{})]})]})}var eC=a(8831),ew=a(5126),ej=a(5508),ey=a(8233),eS=a(8560),eN=a(9073),eb=a(9206);let ek={data:O.getText(I.SINGLE_PARAM_TYPE),group:O.getText(I.GROUP_PARAM_TYPE)};var eT=((h={}).TABLE="table",h.CARDS="cards",h);let eE="https://bytedance.larkoffice.com/docx/LGLWdPIj8ooQyxxMAOQcWmR8nCh";K.t("text",{},"文本"),K.t("picture",{},"图片"),K.t("video",{},"视频"),K.t("number",{},"数字");let eA={xlsx:"demo-params.xlsx",xlsx_group:"demo-params-group.xlsx",zip_image:"demo-params-image.zip",zip_video:"demo-params-video.zip"},eM={xlsx:"https://lf3-static.bytednsdoc.com/obj/eden-cn/nupaonpmeh7nuhpeuhpa/batch-tools-sdk/data-param-value-demo.xlsx",zip_image:"https://lf3-static.bytednsdoc.com/obj/eden-cn/nupaonpmeh7nuhpeuhpa/batch-tools-sdk/image-param-value-demo.zip",xlsx_group:"https://lf3-static.bytednsdoc.com/obj/eden-cn/nupaonpmeh7nuhpeuhpa/batch-tools-sdk/group-param-value-demo.xlsx",zip_video:"https://lf3-static.bytednsdoc.com/obj/eden-cn/nupaonpmeh7nuhpeuhpa/batch-tools-sdk/video-param-value-demo.zip"};var eI=a(2655);let eL=()=>(0,eI.Z)(),ez=()=>({taskName:"",currentParamsConfig:{config_id:eL(),type:"data",nodeId:void 0,internal_name:void 0,name:K.t("parameter_1",{},"参数1"),values:[]},allNodesOptions:[],paramsConfig:[],paramsListDisplayMode:eT.TABLE,paramsEditMode:"create",editIndex:-1,checkWorkflowLoading:!1,currentNodeInfoMap:{},isShowValuesError:!1,selectedDatasets:[]}),eR=(0,M.U)((e,t)=>({...ez(),updateCurrentNodeInfoMap(a,l){e({currentNodeInfoMap:Object.assign({},t().currentNodeInfoMap,{[a]:l})})},updateCurrentConfig(a){e({currentParamsConfig:Object.assign({},t().currentParamsConfig,a)})},addParamsConfig(){let{paramsConfig:a}=t();e({currentParamsConfig:{config_id:eL(),type:"data",nodeId:void 0,internal_name:void 0,name:`${O.getText(I.PARAM_NAME)}${a.length+1}`,values:[]},editIndex:-1,paramsEditMode:"create"})},updateParamsConfig(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;e({currentParamsConfig:j().cloneDeep(t),paramsEditMode:"edit",editIndex:a}),tQ()},deleteParamsConfig(a){let l=t();l.paramsConfig.splice(a,1),e({paramsConfig:[...l.paramsConfig]})},copy(t){var a;e({taskName:`${t.taskName}[copy]`,paramsConfig:null==(a=t.paramsConfig)?void 0:a.filter(e=>"system"!==e.category)})},reset(t){let a=ez();if(t){let l={};t.forEach(e=>l[e]=a[e]),e(e=>{var t;return null==(t=e.form)||t.setFieldsValue(l),{...e,...l}})}else e(a)},batchAddParamsConfig(a){let{paramsConfig:l}=t();l.push(...a),e({paramsConfig:[...l]})},batchUpdateParamsConfig(a){let{paramsConfig:l}=t();a.forEach((e,t)=>{let n=l.findIndex(t=>t.config_id===e.config_id);-1!==n&&(l[n]=e,a.splice(t,1))}),e({paramsConfig:[...l]})},selectedDatasets:[],setSelectedDatasets:t=>e({selectedDatasets:t}),clearSelectedDatasets:()=>e({selectedDatasets:[]})}));var eU=a(6991),eP=a(8033),eO=a(4914),eZ=a(4236);let eD=" [output]",eF=/\.(mp4|avi|mov|wmv|flv|mkv|webm|mpeg|mpg|m4v|3gp|3g2|mxf|ogv|ts|vob)$/i,eH=/\.(bmp|jpg|png|tif|gif|pcx|tga|exif|fpx|svg|psd|cdr|pcd|dxf|ufo|eps|ai|raw|WMF|webp|jpeg)$/;var eB=((p={}).IMAGE="image",p.INT="int",p.STRING="string",p.FLOAT="float",p.UNDEFINED="undefined",p.NUMBER="number",p.VIDEO="video",p);let eV=e=>{let t=String(e).toLowerCase();if(void 0===e)return"undefined";if("number"==typeof e)return"number";if(eH.test(eW(t)))return"image";if(eF.test(t))return"video";if("string"==typeof e)return"string";else return"string"},eW=e=>{let t=String(e);return String(t).endsWith(" [output]")?t.split(" [output]")[0]:t},e$=e=>`${e}${eD}`;function eG(e){return(0,w.isString)(e)&&eH.test(eW(e.toLowerCase()))?"image":(0,w.isString)(e)&&eF.test(e.toLowerCase())?"video":(0,w.isNumber)(e)?"number":"text"}function eK(e,t,a){var l,n;if((0,w.isNil)(t)||(0,w.isNil)(a))return"text";let s=null==(l=e.find(e=>e.id===t))?void 0:l.paramsList;return eG(null==s||null==(n=s.find(e=>e.label===a))?void 0:n.value)}var eq=a(1932),eY=a(5161),eX=a(7099);let eJ=e=>{let{onClick:t}=e;return(0,v.jsx)(eC.Z,{className:"clear-icon",onClick:t})};var eQ=a(882);let e0=e=>{let{props:t,index:a,values:l,internal_name:n,rootRef:s}=e,{label:r,closable:i,onClose:o}=t,c=l.length,[d,u]=(0,T.useState)(null),h=()=>{var e;u((null==(e=s.current)?void 0:e.getBoundingClientRect())||null)};(0,T.useEffect)(()=>{h()},[]);let p=(0,T.useMemo)(()=>{if(!d)return{count:3,width:100};let{width:e}=d;return e<=154?{count:1,width:e-54}:{count:Math.floor((e-54)/100),width:100}},[d]),m=(0,T.useMemo)(()=>a>0?null:(0,v.jsx)(eY.Z.Paragraph,{className:"clear-arco-typography-margin-bottom",ellipsis:{rows:1,showTooltip:!0,wrapper:"div"},style:{marginLeft:8,width:(null==d?void 0:d.width)?(null==d?void 0:d.width)-54-18:100},children:`${c} ${n} values selected`}),[d,a,c,n]);return(0,v.jsx)(v.Fragment,{children:c>p.count?m:(0,v.jsx)(eQ.Z,{closable:i,onClose:o,style:{margin:"2px 6px 2px 0",maxWidth:p.width},children:(0,v.jsx)(eY.Z.Paragraph,{className:"clear-arco-typography-margin-bottom",ellipsis:{rows:1,showTooltip:!0,wrapper:"span"},children:r})})})};var e1=a(4200),e2=a(9584);let e3=e=>{let t="";for(;t.length<e;)for(let a of(0,eI.Z)().replace(/-/g,"")){let l=parseInt(a,16)%10;if((t+=0===l?"1":l.toString()).length===e)break}return Number(t)},e5=e=>{let t=new Set,a=()=>{let e=e3(8);return t.has(e)?a():(t.add(e),e)};for(let t=0;t<e;t++)a();return Array.from(t)},e4=e=>{let{config:t,rootDomRef:a,onChange:l}=e,[n,s]=(0,T.useState)(null),[r,i]=(0,T.useState)(!1),[o,c]=(0,T.useState)(0),d=()=>{var e;s((null==(e=a.current)?void 0:e.getBoundingClientRect())||null)},u=()=>{i(!1),l(e5(o))},h=(0,T.useMemo)(()=>(0,v.jsxs)("div",{className:"random-seed-content",style:{width:null==n?void 0:n.width},children:[(0,v.jsxs)("section",{className:"random-seed-content-header",children:[(0,v.jsx)("p",{className:"random-seed-content-header-title",children:K.t("random_seed_{placeholder1}",{placeholder1:t.internal_name??""},"随机种子{placeholder1}")}),(0,v.jsx)(eC.Z,{onClick:()=>i(!1)})]}),(0,v.jsx)("section",{className:"random-seed-content-main",children:(0,v.jsx)(e1.Z,{placeholder:K.t("please_enter_the_number_you_want_to_generate_randomly_",{},"请输入你想随机生成的个数"),onChange:c})}),(0,v.jsxs)("section",{className:"random-seed-content-footer",children:[(0,v.jsx)(E.Z,{type:"secondary",onClick:()=>i(!1),children:K.t("cancel",{},"取消")}),(0,v.jsx)(E.Z,{type:"primary",onClick:u,style:{marginLeft:8},disabled:!o,children:K.t("ok",{},"确定")})]})]}),[o,u,n,r]);return(0,v.jsx)(e2.Z,{popupVisible:r,showArrow:!0,trigger:"click",position:"bl",popup:()=>h,onVisibleChange:e=>{d(),i(e)},getPopupContainer:()=>a.current,children:(0,v.jsx)("p",{className:"random-seed-trigger-text",onClick:()=>{i(!0)},children:K.t("random_generation",{},"随机生成")})})};class e6{interpret(){let e=[],t=Math.pow(10,Math.max(this.getPrecision(this.start),this.getPrecision(this.end),this.getPrecision(this.step))),a=this.start*t,l=this.end*t,n=this.step*t,s=n>0?n:-n;if(a>l)for(let n=this.startInclusive?a:a-s;this.endInclusive?n>=l:n>l;n-=s)e.push(n/t);else for(let n=this.startInclusive?a:a+s;this.endInclusive?n<=l:n<l;n+=s)e.push(n/t);return e}getPrecision(e){let t=e.toString(),a=t.indexOf(".");return -1===a?0:t.length-a-1}constructor(e,t,a,l,n){(0,U._)(this,"start",void 0),(0,U._)(this,"end",void 0),(0,U._)(this,"step",void 0),(0,U._)(this,"startInclusive",void 0),(0,U._)(this,"endInclusive",void 0),this.start=e,this.end=t,this.step=a,this.startInclusive=l,this.endInclusive=n}}let e7={create(e){let t=e.match(/(?:([\[【\(（])([0-9.]+)(?:,|，)([0-9.]+)([\]】\)）])(?:[:：])(-?[0-9.]+))/);if(t){let e=t[1],a=t[4];return new e6(parseFloat(t[2]),parseFloat(t[3]),parseFloat(t[5]),["[","【"].includes(e),["]","】"].includes(a))}throw Error("Invalid expression format")}},e8=e=>{try{return e7.create(e).interpret()}catch(t){return[e]}},e9=(e,t)=>{let a=e;switch(t){case eB.NUMBER:case eB.INT:case eB.FLOAT:try{a=Number(a),isNaN(a)&&(a=e)}catch{a=e}break;case eB.STRING:a=String(e??"").trim()}return a},te=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eB.STRING;return e instanceof Array?e.filter(e=>""!==e).map(e=>e8(String(e))).flat(1).map(e=>e9(e,t)):e?e8(String(e)).map(e=>e9(e,t)).flat(1):[e9(e,t)]};var tt=a(7801),ta=a(6616);let tl=e=>(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16",...e,children:(0,v.jsx)("path",{stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.33,d:"M14 10v.8c0 1.12 0 1.68-.218 2.108a2 2 0 0 1-.874.874C12.48 14 11.92 14 10.8 14H5.2c-1.12 0-1.68 0-2.108-.218a2 2 0 0 1-.874-.874C2 12.48 2 11.92 2 10.8V10m9.333-4.667L8 2m0 0L4.667 5.333M8 2v8"})}),tn=e=>(0,v.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:34,height:34,fill:"none",viewBox:"0 0 34 34",...e,children:[(0,v.jsx)("g",{filter:"url(#icon-loading_svg__a)",children:(0,v.jsx)("path",{fill:"url(#icon-loading_svg__b)",fillRule:"evenodd",d:"M17 10.333A6.667 6.667 0 1 0 23.667 17 1.667 1.667 0 1 1 27 17c0 5.523-4.477 10-10 10S7 22.523 7 17 11.477 7 17 7a1.667 1.667 0 1 1 0 3.333",clipRule:"evenodd"})}),(0,v.jsxs)("defs",{children:[(0,v.jsxs)("linearGradient",{id:"icon-loading_svg__b",x1:7,x2:27.785,y1:11.444,y2:14.864,gradientUnits:"userSpaceOnUse",children:[(0,v.jsx)("stop",{stopColor:"#fff"}),(0,v.jsx)("stop",{offset:.276,stopColor:"#CDD8E7"}),(0,v.jsx)("stop",{offset:.475,stopColor:"#BAC9DF"}),(0,v.jsx)("stop",{offset:.703,stopColor:"#D4D5D6"}),(0,v.jsx)("stop",{offset:1,stopColor:"#A0B3CA"})]}),(0,v.jsxs)("filter",{id:"icon-loading_svg__a",width:33.333,height:33.333,x:.333,y:.417,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,v.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,v.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,v.jsx)("feOffset",{dy:.083}),(0,v.jsx)("feGaussianBlur",{stdDeviation:3.333}),(0,v.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,v.jsx)("feColorMatrix",{values:"0 0 0 0 0.121569 0 0 0 0 0.258824 0 0 0 0 0.4 0 0 0 0.04 0"}),(0,v.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_5208_12554"}),(0,v.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_5208_12554",result:"shape"})]})]})]}),ts=a.p+"static/image/upload-popover-xlsx.20a41bf2.jpg",tr=a.p+"static/image/upload-popover-xlsx-short.29d3c973.jpg",ti=a.p+"static/image/upload-popover-zip.28bc556f.jpg",to=a.p+"static/image/upload-popover-zip-short.25b8625f.jpg",tc=a.p+"static/image/upload-popover-xlsx-en.5bf830c8.png",td=a.p+"static/image/upload-popover-zip-en.d68b9a9a.png",tu=a.p+"static/image/upload-popover-xlsx-short-en.65b51193.png",th=a.p+"static/image/upload-popover-zip-short-en.541e54e3.png";function tp(e){let{width:t,fileType:a,size:l}=e,n=function(e,t){let a=O.getLanguage(),l=a===L.EN?tc:ts,n=a===L.EN?td:ti,s=a===L.EN?tu:tr,r=a===L.EN?th:to;return(0,T.useMemo)(()=>{let a;return"xlsx"===e?"large"===t?l:s:"large"===t?n:r},[e,t])}(a,l),s=async()=>{tt.Z.success(K.t("template_downloaded",{},"模板已下载"));let e=eA[a],t=eM[a];try{let a=await (await fetch(t).then(e=>200!==e.status?Promise.reject(Error(K.t("template_download_failed",{},"模板下载失败"))):e)).blob(),l=window.URL.createObjectURL(a),n=document.createElement("a");n.style.display="none",n.href=l,n.download=e,document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(l)}catch(e){tt.Z.error(K.t("download_failed",{},"下载失败"))}};return(0,v.jsxs)(W,{className:"upload-popover-content",style:{width:t},direction:"column",onMouseDown:e=>e.stopPropagation(),children:[(0,v.jsx)(W,{className:"upload-popover-content-header",justify:"space-between",align:"center",children:(0,v.jsx)("div",{className:"upload-popover-content-header-title",children:K.t("newbie_help",{},"新手帮助")})}),(0,v.jsxs)(W,{className:"upload-popover-content-info",direction:"column",gap:16,children:[(0,v.jsxs)(W,{direction:"large"===l?"row":"column",gap:16,children:[(0,v.jsx)("img",{className:"upload-popover-content-info-img",style:{width:"large"===l?"50%":"100%"},alt:K.t("guide_image_alt",{},"引导图片"),src:n}),(0,v.jsx)("div",{className:"upload-popover-content-info-tips",children:K.t("export_the_file_template__fill_in_the_information__and_upload_it_to_complete_the",{},"导出文件模版，填写信息后，上传即可完成解析～")})]}),(0,v.jsx)(W,{justify:"end",children:(0,v.jsx)(E.Z,{type:"primary",onClick:s,children:K.t("download_the_{filetype}_template",{fileType:a},"下载{fileType}模板")})})]})]})}let tm=e=>{let t=eV(e),a=".zip";return t===eB.IMAGE?`${a}, .bmp, .jpg, .png, .tif, .gif, .pcx, .tga, .exif, .fpx,
    .svg, .psd, .cdr, .pcd, .dxf, .ufo, .eps, .ai, .raw, .WMF, .webp, .jpeg`:t===eB.VIDEO?`${a}, .mp4, .avi, .mov,`:".xls, .xlsx, .txt"},tg=(e,t)=>{var a,l;if(!e)return{};let n=window.app.graph.getNodeById(e),s=null==n?void 0:n.widgets.find(e=>e.name===t),r=null==s?void 0:s.value,i=(null==s||null==(a=s.options)?void 0:a.values)??[],o=!!(null==s||null==(l=s.linkedWidgets)?void 0:l.some(e=>"control_after_generate"===e.name)),c=eV(r);return console.log("nodeInfo",n),{key:`${e}_${t}`,paramValue:r,paramType:c,paramOptions:i,uploadAccept:tm(r),isSeed:o,nodeInfo:n}},t_=(e,t)=>eV(e)===t,tf=e=>`${null==e?void 0:e.nodeId}_${null==e?void 0:e.internal_name}`;class tx extends Error{static create(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new tx({code:e,message:t})}static check(e){let{data:t}=e;(0,w.isNumber)(null==t?void 0:t.code)&&!tx.normalCodeSet.has(null==t?void 0:t.code)&&((null==t?void 0:t.message)??e.statusText)}static is(e){return e instanceof tx}constructor(e){super(`RequestError: ${JSON.stringify(e)}`)}}(0,U._)(tx,"errorCodeSet",new Set([400,401,403,404,405,408,500,501,502,503,504])),(0,U._)(tx,"normalCodeSet",new Set([0,200,204,206]));let tv=a(4767).Z.create({headers:{"Content-Type":"application/json"}});tv.interceptors.response.use(e=>(tx.check(e),e),e=>{if(400===e.request.status&&"/prompt"===e.request._url)throw Error(e.response.data?JSON.stringify(e.response.data):e.message);throw new tx(e.message)});let tC="/api/comfyui-lumi-batcher";async function tw(e){return(await tv.post(`${tC}/resolve-file`,e,{headers:{"Content-Type":"multipart/form-data"}})).data}let tj=e=>{var t,a;let{popover:l,rootDomRef:n,currentParamConfig:s,onUpdateUploadingStatus:r,onChange:i,onVisibleChange:o}=e,[c]=eR((0,ew.N)(e=>[e.currentNodeInfoMap])),[d,u]=(0,T.useState)(null),[h,p]=(0,T.useState)([]),[m,g]=(0,T.useState)(new Map),[_,f]=(0,T.useState)([]),x=s.nodeId?null==(t=c[tf(s)])?void 0:t.uploadAccept:"",C=s.nodeId?null==(a=c[tf(s)])?void 0:a.paramType:"",w=async e=>{let{file:t}=e,a=`.${t.name.split(".").pop()}`;try{let e=new FormData;e.append("file",t),e.append("file_extension",a);let l=await tw(e);0===l.data.length&&f(e=>[...e,t.name]),g(e=>(e.set(t.name,l.data),e))}catch(e){f(e=>[...e,t.name]),console.error(e)}finally{p(e=>e.map(e=>{var a;return(null==(a=e.originFile)?void 0:a.name)===t.name&&(e.percent=100),e}))}},j=()=>{p([]),g(new Map),f([])},y=(0,T.useMemo)(()=>!h.every(e=>100===e.percent),[h]);(0,T.useEffect)(()=>{if(!y&&h.length){let e=[];h.forEach(t=>{var a;let l=m.get(null==(a=t.originFile)?void 0:a.name)??[];C&&[eB.IMAGE,eB.VIDEO].includes(C)&&x?e.push(...l.filter(e=>x.includes((e.split(".").pop()||"").toLowerCase()))):e.push(...l)}),h.every(e=>{var t;return _.includes(null==(t=e.originFile)?void 0:t.name)})||0===e.length?tt.Z.error(K.t("file_parsing_failed__please_check_the_file~",{},"文件解析失败，请检查文件～")):h.some(e=>{var t;return _.includes(null==(t=e.originFile)?void 0:t.name)})&&e.length>0?tt.Z.error(K.t("some_files_were_parsed_successfully__please_check_the_files~",{},"部分文件解析成功，请检查文件~")):tt.Z.success(K.t("the_parameters_have_been_successfully_uploaded_and_parsed__the_details_are_as_follow",{},"参数已成功上传并解析，详情如下表～")),r(!1),i(e),j()}},[h,y,m,_]);let S=(0,v.jsx)(ta.Z,{accept:x??"",showUploadList:!1,fileList:h,multiple:!0,customRequest:w,onChange:p,children:(0,v.jsx)(tl,{style:{cursor:"pointer",verticalAlign:"middle"},onClick:()=>{r(!0)}})}),N=l?(0,v.jsx)(e2.Z,{className:"upload-trigger-left-0",position:"bottom",onVisibleChange:e=>{var t;u((null==(t=n.current)?void 0:t.getBoundingClientRect())||null),o(e)},alignPoint:!1,popupAlign:{bottom:[0,8]},popup:()=>l?(0,v.jsx)(tp,{width:(null==d?void 0:d.width)||0,fileType:l.type,size:l.size}):null,getPopupContainer:()=>n.current,children:S}):S;return(0,v.jsx)(v.Fragment,{children:y?(0,v.jsx)(tn,{className:"icon-loading-rotate"}):N})},ty=e=>{var t;let{onChange:a,placeholder:l="",autoFocus:n,defaultValue:s="",noSplit:r,popover:i,currentParamConfig:o,size:c="large",enterFrom:d="batch-input"}=e,[u,h]=eR((0,ew.N)(e=>[e.currentNodeInfoMap,e.updateCurrentNodeInfoMap])),p=(0,T.useRef)(null),m=(0,T.useRef)(null),[g,_]=(0,T.useState)(s),[f,x]=(0,T.useState)(""),[C,w]=(0,T.useState)(!1),[j,y]=(0,T.useState)(!1),S=(null==o?void 0:o.nodeId)?u[tf(o)]:{},N=(null==S||null==(t=S.paramOptions)?void 0:t.length)>0;(0,T.useEffect)(()=>{if(!o.nodeId)return;let e=tg(o.nodeId,o.internal_name);h(e.key,e)},[o]);let b=e=>{let t=e||g;if(!j){if(t instanceof Array){a(te(t,null==S?void 0:S.paramType)),_("");return}r?a(te(t,null==S?void 0:S.paramType)):(t&&(/[;；]/.test(t)?a(te(t.split(/[;；]/),null==S?void 0:S.paramType)):a(te(t,null==S?void 0:S.paramType))),_(""))}},k=()=>{w(!1),b()},E=()=>{var e;null==(e=m.current)||e.focus()};(0,T.useEffect)(()=>{n&&E()},[]);let A=(0,T.useMemo)(()=>(0,v.jsxs)(V.Z,{size:"small",style:{zIndex:2},children:[(0,v.jsx)(eJ,{onClick:()=>{_("")}}),(0,v.jsx)(tj,{currentParamConfig:o,rootDomRef:p,popover:i,isUploading:j,onUpdateUploadingStatus:y,onChange:a,onVisibleChange:e=>w(!e)})]}),[o,p,i,j,y,_,a]),M=(0,T.useMemo)(()=>((null==S?void 0:S.paramOptions)||[]).filter(e=>S.paramType===eB.IMAGE?eH.test(String(e).toLowerCase()):S.paramType!==eB.VIDEO||eF.test(String(e).toLowerCase())),[S]);return(0,v.jsxs)("div",{ref:p,style:{position:"relative"},className:"input-param-value-wrapper",children:[N?(0,v.jsx)(eq.Z,{className:"input-param-value-select",ref:m,size:c,mode:"batch-input"===d?"multiple":void 0,defaultValue:s,value:g?g instanceof Array?g:[g]:[],onChange:e=>{_(e),"single-input"===d&&b(e)},onInputValueChange:x,popupVisible:C,allowCreate:{formatter:e=>({value:e,label:e})},renderTag:(e,t,a)=>{let{label:l,closable:n,onClose:s}=e;return(0,v.jsx)(e0,{props:{label:l,closable:n,onClose:s},rootRef:p,index:t,values:a,internal_name:o.internal_name??""})},renderFormat:(e,t)=>"single-input"===d?(0,v.jsx)(eY.Z.Paragraph,{className:"clear-arco-typography-margin-bottom",ellipsis:{rows:1,showTooltip:!0,wrapper:"div"},children:"string"==typeof t?t:String(t)}):t,getPopupContainer:()=>"batch-input"===d&&p.current||document.body,suffixIcon:A,onFocus:()=>{y(!1),w(!0)},onBlur:k,onKeyDown:e=>{if((13===e.keyCode||"Enter"===e.code)&&!f){var t;null==(t=m.current)||t.blur(),e.preventDefault()}},children:M.map(e=>{var t;let a=String(e||"");return(0,v.jsx)(eq.Z.Option,{value:(null==(t=String(null==S?void 0:S.paramValue))?void 0:t.endsWith(eD))?e$(a):a,children:e},eL())})}):(0,v.jsx)(eX.Z,{className:"input-param-value-input",ref:m,autoFocus:n,defaultValue:s,size:c,placeholder:"",onPressEnter:()=>{b()},value:g,onBlur:k,onFocus:()=>y(!1),onChange:e=>{_(e)},suffix:A}),(null==g?void 0:g.length)===0&&(null==f?void 0:f.length)===0&&(0,v.jsxs)("div",{className:"custom-placeholder",children:[(0,v.jsx)(eY.Z.Paragraph,{onClick:E,className:"clear-arco-typography-margin-bottom placeholder-text",ellipsis:{rows:1,showTooltip:!0,wrapper:"div"},children:l}),(null==S?void 0:S.isSeed)&&"batch-input"===d?(0,v.jsx)(e4,{onChange:a,inputDomRef:m,rootDomRef:p,config:o}):null]})]})};var tS=a(8202),tN=a(468);let tb=()=>{let[e,t,a]=eR((0,ew.N)(e=>[e.currentParamsConfig,e.updateCurrentConfig,e.allNodesOptions])),{type:l}=e;return"group"!==l?null:(0,v.jsx)(tS.Z,{cols:2,colGap:12,rowGap:16,className:"grid-demo-grid",children:e.values.map((l,n)=>{let{type:s,config_id:r,nodeId:i,internal_name:o}=l,c=eK(a,l.nodeId,l.internal_name);return"file"===s?(0,v.jsx)(tN.Z,{children:(0,v.jsx)("div",{children:K.t("file",{},"文件")})},r):(0,v.jsx)(tN.Z,{children:(0,v.jsx)(ty,{popover:{type:"video"===c?"zip_video":"image"===c?"zip_image":"xlsx",size:"small"},currentParamConfig:l,placeholder:`${o}${O.getText(I.BATCH_ADD_VALUES_PLACEHOLDER_SIMPLE)}`,onChange:a=>{let l=j().cloneDeep(e);l.values[n].values=[...e.values[n].values,...a],t({values:l.values})}})},r)})})};var tk=a(6826);let tT=tk.Z.Node,tE=()=>{let[e,t]=(0,T.useState)(300),[a,l,n,s,r]=eR((0,ew.N)(e=>[e.currentParamsConfig,e.paramsConfig,e.allNodesOptions,e.editIndex,e.updateCurrentConfig])),{type:i}=a,[o,c]=(0,T.useState)("");(0,T.useEffect)(()=>{let e=document.querySelector(".params-config-modal-wrap");(null==e?void 0:e.clientHeight)&&t(Math.min((null==e?void 0:e.clientHeight)-250,500))},[]),(0,T.useEffect)(()=>{let{nodeId:e,internal_name:t}=a;"group"===i?a.values.length>0?c(a.values.map(e=>JSON.stringify({id:e.nodeId,nodeLabel:e.internal_name}))):c(""):e&&t?c(JSON.stringify({id:a.nodeId,nodeLabel:a.internal_name})):c("")},[a]);let d=(0,T.useCallback)((e,t)=>{let a=!1;return l.forEach((l,n)=>{n===s||a||("group"===l.type?a=l.values.some(a=>a.nodeId===e&&a.internal_name===t):l.nodeId===e&&l.internal_name===t&&(a=!0))}),a},[l]);return(0,v.jsx)(tk.Z,{className:"tree-select-wrapper",value:o,allowClear:!0,triggerProps:{className:"params-select-container"},dropdownMenuStyle:{height:e,maxHeight:"unset"},size:"small",showSearch:!0,filterTreeNode:(e,t)=>t.props.title.toLowerCase().indexOf(e.toLowerCase())>-1,placeholder:"group"===i?K.t("please_select_or_fuzzy_search__select_at_least_2",{},"请选择或模糊搜索，至少选择2个"):O.getText(I.SELECT_NODE_PLACEHOLDER),multiple:"group"===i,treeCheckable:"group"===i,onChange:e=>{if(console.log("TreeSelect",e),c(e),e||r({nodeId:"",internal_name:"",values:[]}),"group"===i){let t=[];e.forEach(e=>{let l=JSON.parse(e),n=a.values.find(e=>e.nodeId===l.id&&e.internal_name===l.nodeLabel);t.push({type:"data",nodeId:l.id,name:l.nodeLabel,internal_name:l.nodeLabel,config_id:eL(),values:n?n.values:[]})}),r({values:t})}else{let t=JSON.parse(e);r({nodeId:t.id,internal_name:t.nodeLabel})}},children:n.map(e=>{let{paramsList:t,id:a,label:l}=e,n=t.filter(e=>!e.isLinked);return(null==n?void 0:n.length)?(0,v.jsx)(tT,{title:l,disabled:!0,children:n.map(e=>{let{label:t}=e;return(0,v.jsx)(tT,{title:t,isLeaf:!0,disabled:d(a,t)},JSON.stringify({id:a,nodeLabel:t}))})},a):null})})};var tA=a(7506),tM=a(1406),tI=a(7169);let tL=a.p+"static/image/values-empty-guide.96a20f00.png",tz=a.p+"static/image/values-empty-guide-en.f990a27f.png";var tR=a(3477);let tU=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"output",a=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(!e)return"";let l=a?"":`&cache=${Date.now()}}`;return(null==e?void 0:e.endsWith(eD))&&(t="output",e=eW(e)),`${tC}/view-image?file_name=${encodeURIComponent(e)}&type=${t}${l}`};function tP(e){let t=Math.floor(e/60),a=Math.floor(e%60);return`${String(t).padStart(2,"0")}:${String(a).padStart(2,"0")}`}let tO={tag:"tag-kI6uIp"},tZ=e=>{let{hoverPlay:t=!1,showTime:a=!1,clickToFullScreen:l=!1}=e,[n,s]=(0,T.useState)(null),[r,i]=(0,T.useState)("00:00 / 00:00"),[o,c]=(0,T.useState)(!1),{src:d=""}=e,[u,h]=(0,T.useState)("");(0,T.useEffect)(()=>{h(d)},[d]),(0,T.useEffect)(()=>{if(!n||!t||o)return;let e=()=>{n.play()},a=()=>{n.pause(),n.currentTime=0};return n.addEventListener("mouseover",e),n.addEventListener("mouseleave",a),()=>{n.removeEventListener("mouseenter",e),n.removeEventListener("mouseleave",a)}},[t,n,o]),(0,T.useEffect)(()=>{n&&(n.addEventListener("timeupdate",e),n.addEventListener("loadedmetadata",e));function e(){if(!n)return;let e=tP(n.currentTime),t=tP(n.duration);i(`${e} / ${t}`)}},[n]);let p=(0,T.useMemo)(()=>a?(0,v.jsx)(eQ.Z,{className:tO.tag,color:"rgba(40, 40, 40, 0.58)",children:r}):null,[a,r]);return((0,T.useEffect)(()=>{if(!n||!l)return;let e=()=>{let e=document.fullscreenElement===n;c(e),n.style.objectFit=e?"contain":"cover"};return document.addEventListener("fullscreenchange",e),()=>{document.removeEventListener("fullscreenchange",e)}},[l,n]),u)?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("video",{ref:s,onClick:()=>{l&&(null==n?void 0:n.requestFullscreen)&&n.requestFullscreen()},controls:!0,...e,style:{...e.style??{},cursor:l?"zoom-in":"default"},src:u}),p]}):null},tD=e=>{let{value:t,width:a,height:l,maxWidth:n="unset",maxHeight:s="unset",isError:r=!1}=e,[i,o]=(0,T.useState)(eG(t)),c=(0,T.useMemo)(()=>{let e=tU(String(t),"input",!1);return"image"===i?(0,v.jsx)(tR.Z,{onError:()=>{o("text")},className:"param-value-preview-image",src:e,style:{maxWidth:n,maxHeight:s,border:r?"1px solid #ff453a":"1px solid var(--border-color-border-1, rgba(255, 255, 255, 0.12))",borderRadius:4},width:a??void 0,height:l??void 0}):"video"===i?(0,v.jsx)(tZ,{src:e,style:{maxWidth:n,maxHeight:s,border:r?"1px solid #ff453a":"1px solid var(--border-color-border-1, rgba(255, 255, 255, 0.12))",borderRadius:4,objectFit:"cover",marginTop:8,width:a??void 0,height:l??void 0},clickToFullScreen:!0,className:"param-value-preview-video",hoverPlay:!0,controls:!1}):(0,v.jsx)(eY.Z.Paragraph,{className:"clear-arco-typography-margin-bottom",ellipsis:{rows:1,showTooltip:!0,wrapper:"div"},style:{color:r?"#ff453a":""},children:t})},[l,r,s,n,i,t,a]);return void 0===t?null:c},tF=e=>String(e).length<2?`0${e}`:String(e);var tH=((m={}).LocalTask="local_task",m.ComfyUITask="comfyui_task",m);let tB=(l="comfyui-lumi-batcher",e=>e?`${l}-${e}`:l),tV=()=>{let[e,t,a,l]=eR((0,ew.N)(e=>[e.currentParamsConfig,e.currentNodeInfoMap,e.isShowValuesError,e.updateCurrentConfig])),[n,s]=(0,T.useState)({}),{type:r}=e,i=(e,t)=>{s(a=>({...a,[e]:t}))},o=s=>{let{id:o,value:c,internal_name:d="",index:u,nodeId:h}=s,p=(h?t[tf(s)]:"")||{};return(0,v.jsx)("div",{className:ee()("params-values-edit-value"),children:n[o]?(0,v.jsx)(ty,{size:"default",enterFrom:"single-input",currentParamConfig:s,noSplit:!0,placeholder:`${K.t("{internal_name}_value__enter_key_to_submit",{internal_name:d},"{internal_name}值，enter键提交")}`,defaultValue:c,onChange:t=>{let a=j().cloneDeep(e);if("group"===r){let e=a.values.findIndex(e=>e.nodeId===h&&e.internal_name===d);a.values[e].values[u]=t instanceof Array?t[0]:t}else a.values[u]=t instanceof Array?t[0]:t;l({values:a.values}),i(o,!1)}}):(0,v.jsx)("div",{className:"params-values-preview-container",children:(0,v.jsx)(tD,{value:c,height:32,width:32,isError:!!a&&!t_(c,p.paramType)})})})},c=(0,T.useMemo)(()=>{let t=[{title:(0,v.jsx)(v.Fragment,{children:K.t("serial_number",{},"序号")}),width:100,fixed:"left",render:(e,t,a)=>(0,v.jsx)("span",{children:tF(a+1)})}];if("group"===r){var a;null==(a=e.values)||a.forEach(e=>{t.push({title:e.internal_name,dataIndex:`${e.config_id}value`,width:200,render:(t,a,l)=>(0,v.jsx)(o,{id:a.id,nodeId:e.nodeId,value:a[`${e.config_id}value`],internal_name:e.internal_name,index:l})})})}else t.push({className:"params-values-table-cell",title:e.internal_name,dataIndex:`${e.config_id}value`,width:200,render:(t,a,l)=>(0,v.jsx)(o,{id:a.id,nodeId:e.nodeId,value:a[`${e.config_id}value`],internal_name:e.internal_name,index:l})});return t.push({title:(0,v.jsx)(v.Fragment,{children:K.t("operation",{},"操作")}),fixed:"right",width:100,render:(t,a,l)=>(0,v.jsxs)(V.Z,{children:[(0,v.jsx)(E.Z,{shape:"circle",icon:(0,v.jsx)(tM.Z,{}),size:"mini",onClick:()=>{s(e=>({...e,[a.id]:!0}))}}),(0,v.jsx)(E.Z,{shape:"circle",icon:(0,v.jsx)(tI.Z,{}),size:"mini",onClick:()=>{if("group"===r){var t;null==(t=e.values)||t.forEach(e=>{e.values.splice(l,1)})}else e.values.splice(l,1);eR.setState({currentParamsConfig:{...e}})}})]})}),t},[e,n,a]),d=(0,T.useMemo)(()=>{var t,a;let l=[];return"group"===r?null==(t=e.values)||t.forEach(e=>{var t;null==(t=e.values)||t.forEach((t,a)=>{l[a]?l[a][`${e.config_id}value`]=t:l.push({[`${e.config_id}value`]:t,id:eL()})})}):null==(a=e.values)||a.forEach(t=>{l.push({[`${e.config_id}value`]:t,id:eL(),nodeId:e.nodeId})}),l},[e]),u=(0,T.useMemo)(()=>"group"===r?e.values.some(e=>{var t;return(null==e||null==(t=e.values)?void 0:t.length)>0}):e.values.length>0,[e]),h=(0,T.useMemo)(()=>u?(0,v.jsx)(tA.Z,{rowKey:"id",className:tB("params-value-list-table"),columns:c,data:d,pagination:!1,scroll:{x:500,y:!0}}):(0,v.jsx)("img",{className:"img",src:O.getLanguage()===L.EN?tz:tL,alt:""}),[d,c]);return(0,v.jsxs)("div",{className:tB("params-value-list"),children:[(0,v.jsx)("div",{className:"title-container",children:(0,v.jsx)("span",{className:"title",children:O.getText(I.PARAM_LIST)})}),h]})},tW=eU.Z.Group,t$=()=>{let[e,t]=eR((0,ew.N)(e=>[e.currentParamsConfig,e.allNodesOptions])),[a]=eP.Z.useForm(),{type:l}=e;(0,T.useEffect)(()=>{eR.setState({form:a})},[a]);let n=t=>{eR.setState({currentParamsConfig:Object.assign({},e,t)})},s=(0,T.useMemo)(()=>{let a=eK(t,e.nodeId,e.internal_name);if("group"===l){var s;return(null==(s=e.values)?void 0:s.length)?(0,v.jsx)(eP.Z.Item,{label:K.t("parameter_value_",{},"参数值："),children:(0,v.jsx)(tb,{})}):null}return e.internal_name?(0,v.jsx)(eP.Z.Item,{label:K.t("parameter_value_",{},"参数值："),children:(0,v.jsx)(ty,{currentParamConfig:e,popover:{type:"video"===a?"zip_video":"image"===a?"zip_image":"xlsx",size:"large"},onChange:t=>{n({values:[...e.values,...t]})},placeholder:`${e.internal_name}${O.getText(I.BATCH_ADD_VALUES_PLACEHOLDER)}`})}):null},[e]);return(0,v.jsxs)("div",{className:"params-config-content",children:[(0,v.jsxs)(eP.Z,{form:a,size:"default",autoComplete:"off",initialValues:{...e},className:"params-config-content-form",labelCol:{style:{width:"fit-content",flex:"unset",flexShrink:0}},wrapperCol:{flex:"1",style:{}},children:[(0,v.jsx)(eZ.Z,{children:(0,v.jsx)(eP.Z.Item,{label:K.t("type_",{},"类型："),field:"type",className:"test",children:(0,v.jsxs)(tW,{defaultValue:"normal",onChange:e=>{n({type:e,internal_name:"",nodeId:"",values:[]})},children:[(0,v.jsx)(eU.Z,{value:"data",children:O.getText(I.SINGLE_PARAM_TEXT)}),(0,v.jsx)(eU.Z,{value:"group",children:O.getText(I.GROUP_PARAM_TEXT)})]})})}),(0,v.jsxs)(eZ.Z,{gutter:24,children:[(0,v.jsx)(eO.Z,{span:12,className:"params-config-form-item-wrapper",children:(0,v.jsx)(eP.Z.Item,{label:K.t("parameter_",{},"参数："),style:{flexWrap:"nowrap"},children:(0,v.jsx)(tE,{})})}),(0,v.jsx)(eO.Z,{span:12,children:s})]})]}),(0,v.jsx)(tV,{})]})};var tG=a(3491);let tK=()=>{let[e,t]=eR((0,ew.N)(e=>[e.currentParamsConfig,e.currentNodeInfoMap])),{type:a}=e,l=()=>{let{values:l}=e,n=!0,s=e=>{var a;if(!e.nodeId)return;let l=null==(a=t[tf(e)])?void 0:a.paramType;e.values.every(e=>eV(e)===l)||(n=!1)};return"group"===a?l.forEach(e=>{s(e)}):s(e),n||(eR.setState({isShowValuesError:!0}),tt.Z.error(K.t("the_parameter_type_check_failed__please_check_the_parameter_configuration~",{},"参数类型检查不通过，请检查参数配置~"))),n};return{checkParamsValues:l,checkParamsConfig:()=>{let t=l();return t&&("group"===a?e.values.some(t=>t.values.length!==e.values[0].values.length)?(tt.Z.error(K.t("the_number_of_parameter_values_in_the_combination_parameter_does_not_correspond",{},"组合参数中参数值数量对应不上")),t=!1):e.values.some(e=>!e.values.length)?(tt.Z.error(K.t("the_number_of_parameter_values_cannot_be_0_",{},"参数值份数不能为0")),t=!1):e.values.length<2&&(tt.Z.error(K.t("combine_parameters_(bundled)_select_at_least_two_parameters",{},"组合参数（捆绑）至少选择两个参数")),t=!1):e.values.length||(tt.Z.error(K.t("the_number_of_parameter_values_cannot_be_0_",{},"参数值份数不能为0")),t=!1)),t}}};function tq(e){let{className:t,style:a,value:l,onChange:n,fontSize:s=24,maxWidth:r=600,maxLength:i=100,tooltipProps:o={}}=e,c=(0,T.useRef)(null),d=(0,T.useRef)(null),u=(0,T.useRef)(null),[h,p]=(0,T.useState)(()=>l),[m,g]=(0,T.useState)(0),[_,f]=(0,T.useState)(!1);return(0,T.useEffect)(()=>{p(l)},[l]),(0,T.useEffect)(()=>{var e,t;g(((null==(e=d.current)?void 0:e.offsetWidth)??100)>r?r:(null==(t=d.current)?void 0:t.offsetWidth)??100)},[h]),(0,T.useEffect)(()=>{h||_||p(l)},[l,h,_]),(0,v.jsxs)("div",{ref:u,className:t,style:{...a,position:"relative",marginRight:16},children:[(0,v.jsx)(tG.Z,{...o,content:m===r?h:void 0,children:(0,v.jsx)(eX.Z,{ref:c,value:h,onChange:p,maxLength:i,onKeyDown:e=>{if(13===e.keyCode||"Enter"===e.code){var t;null==(t=c.current)||t.blur()}},onBlur:e=>{var t;n&&n(e.target.value.trim()),f(!1),null==(t=c.current)||t.blur()},onFocus:()=>f(!0),style:{width:m+10,maxWidth:m+10,border:0,borderRadius:0,background:"#fff0",padding:0,fontSize:s,fontWeight:500,lineHeight:"32px",textOverflow:"ellipsis"}})}),(0,v.jsx)(tM.Z,{style:{position:"absolute",left:m+10,top:10,fontSize:16,color:"var(--color-text-2)",cursor:"pointer"},onClick:()=>{var e;f(!0),null==(e=c.current)||e.focus()}}),(0,v.jsx)("span",{ref:d,style:{position:"absolute",width:"max-content",visibility:"hidden",height:0,display:"block",fontSize:s},children:h})]})}let tY="batch-tools-show-params-config-title-tip",tX=()=>{let e=localStorage.getItem(tY),[t,a,l,n,s,r]=eR((0,ew.N)(e=>[e.currentParamsConfig,e.closeParamsModal,e.paramsConfig,e.paramsEditMode,e.editIndex,e.updateCurrentConfig])),[i,o]=(0,T.useState)(!e),{checkParamsConfig:c}=tK(),{type:d}=t,u=(0,T.useMemo)(()=>"group"===d?t.values.length:Number(+!!t.internal_name),[t,d]),h=(0,T.useMemo)(()=>{let e=t.values.length;if("group"===d){var a,l,n;e=(null==(n=t.values)||null==(l=n[0])||null==(a=l.values)?void 0:a.length)??0,t.values.forEach(t=>{var a;(null==(a=t.values)?void 0:a.length)>e&&(e=t.values.length)})}return e},[t,d]),p=(0,T.useMemo)(()=>"group"===d?t.values.every(e=>0===e.values.length||!e.nodeId):0===t.values.length||!t.nodeId,[t,d]),m=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];c()&&(l.push(t),eR.setState({paramsConfig:[...l],currentParamsConfig:{config_id:eL(),type:t.type,nodeId:void 0,internal_name:void 0,name:`${K.t("parameter_{placeholder1}",{placeholder1:l.length+1},"参数{placeholder1}")}`,values:[]},isShowValuesError:!1}),e||null==a||a())};return(0,T.useEffect)(()=>(o(!e),setTimeout(()=>{o(!1)},5e3),()=>{localStorage.setItem(tY,"true")}),[]),(0,v.jsxs)("div",{className:"params-config-header",children:[(0,v.jsxs)(V.Z,{className:"params-config-header-left",children:[(0,v.jsx)(tG.Z,{position:"bl",content:K.t("support_custom_naming__which_is_convenient_for_you_to_manage_and_filter_the_grap",{},"支持自定义命名，便于你管理和跑图结果筛选。未命名则系统随机分配～"),popupVisible:i,getPopupContainer:()=>document.body,children:(0,v.jsx)(tq,{tooltipProps:{position:"bl",getPopupContainer:()=>document.body},maxWidth:500,value:t.name,onChange:e=>{if(!e)return void tt.Z.error(K.t("parameter_name_cannot_be_empty",{},"参数名称不能为空"));r({name:e})}})}),(0,v.jsxs)(eQ.Z,{className:"tag",children:[O.getText(I.PARAMS_COUNT),"：",u]}),(0,v.jsxs)(eQ.Z,{className:"tag",children:[O.getText(I.PARAMS_COPIES),"：",h]})]}),(0,v.jsx)(V.Z,{className:"params-config-header-right",children:"edit"===n?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(E.Z,{className:"params-config-header-cancel-button",type:"outline",status:"default",onClick:()=>{eR.setState({isShowValuesError:!1}),null==a||a()},disabled:p,children:K.t("cancel",{},"取消")}),(0,v.jsx)(E.Z,{type:"primary",onClick:()=>{c()&&-1!==s&&(l.splice(s,1,t),eR.setState({paramsConfig:[...l],isShowValuesError:!1}),null==a||a())},disabled:p,children:K.t("save",{},"保存")})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(E.Z,{type:"outline",status:"default",onClick:()=>m(!0),disabled:p,className:"params-config-header-continue-button",children:O.getText(I.SAVE_PARAM_CONFIG_CONTINUE)}),(0,v.jsx)(E.Z,{type:"primary",onClick:()=>m(),disabled:p,children:O.getText(I.SAVE_PARAM_CONFIG)})]})})]})},tJ=()=>(0,v.jsxs)(eS.Z,{style:{height:"100%"},children:[(0,v.jsx)(eb.Z,{children:(0,v.jsx)(tX,{})}),(0,v.jsx)(eN.Z,{children:(0,v.jsx)(t$,{})})]}),tQ=()=>{let{close:e}=A.Z.confirm({title:(0,v.jsx)("div",{}),wrapClassName:"params-config-modal-wrap",icon:null,footer:null,className:"params-config-modal",content:(0,v.jsx)(tJ,{}),alignCenter:!0,focusLock:!1,closable:!0,escToExit:!1,maskClosable:!1});eR.setState({closeParamsModal:e})},t0=e=>(0,v.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:359,height:440,fill:"none",viewBox:"0 0 359 440",...e,children:[(0,v.jsx)("path",{fill:"#fff",fillOpacity:.08,stroke:"#fff",strokeOpacity:.1,d:"M78.708 1 69.48 11.466H1V435a4 4 0 0 0 4 4h349a4 4 0 0 0 4-4V5a4 4 0 0 0-4-4z"}),(0,v.jsx)("path",{fill:"#fff",fillOpacity:.08,fillRule:"evenodd",d:"M1 1h42l-5 6H1zm49 0h6l-5 6h-6zm19 0h-6l-5 6h6z",clipRule:"evenodd"})]}),t1=e=>(0,v.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:360,height:440,fill:"none",viewBox:"0 0 360 440",...e,children:[(0,v.jsx)("path",{fill:"url(#params-card-select-bkg_svg__a)",fillOpacity:.2,stroke:"url(#params-card-select-bkg_svg__b)",d:"M78.598 1 69.34 11.466H.667V435a4 4 0 0 0 4 4h350a4 4 0 0 0 4-4V5a4 4 0 0 0-4-4z"}),(0,v.jsx)("path",{fill:"url(#params-card-select-bkg_svg__c)",fillRule:"evenodd",d:"M2 1h42l-5 6H2zm49 0h6l-5 6h-6zm19 0h-6l-5 6h6z",clipRule:"evenodd"}),(0,v.jsxs)("defs",{children:[(0,v.jsxs)("linearGradient",{id:"params-card-select-bkg_svg__a",x1:179.667,x2:179.667,y1:1,y2:439,gradientUnits:"userSpaceOnUse",children:[(0,v.jsx)("stop",{}),(0,v.jsx)("stop",{offset:1,stopColor:"#47FFF2"})]}),(0,v.jsxs)("linearGradient",{id:"params-card-select-bkg_svg__b",x1:358.667,x2:-74.632,y1:1,y2:96.169,gradientUnits:"userSpaceOnUse",children:[(0,v.jsx)("stop",{stopColor:"#47FFF2"}),(0,v.jsx)("stop",{offset:1,stopColor:"#0AD3FB"})]}),(0,v.jsxs)("linearGradient",{id:"params-card-select-bkg_svg__c",x1:70,x2:61.604,y1:1,y2:26.571,gradientUnits:"userSpaceOnUse",children:[(0,v.jsx)("stop",{stopColor:"#47FFF2"}),(0,v.jsx)("stop",{offset:1,stopColor:"#0AD3FB"})]})]})]}),t2=()=>{let[e,t,a]=eR((0,ew.N)(e=>[e.paramsConfig,e.updateParamsConfig,e.deleteParamsConfig])),l=e=>{let{info:t}=e,{nodeId:a,internal_name:l}=t;return(0,v.jsx)("span",{className:"params-card-value",children:`#${a}/${l}`})};return(0,v.jsx)("div",{className:"params-cards-container",children:e.map((n,s)=>{var r,i;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:"params-card",children:[(0,v.jsx)("span",{className:"params-card-num",children:"group"===n.type?null==(i=n.values[0])||null==(r=i.values)?void 0:r.length:n.values.length}),(0,v.jsxs)("div",{className:"params-card-content",children:[(0,v.jsx)(t0,{className:"params-card-bkg"}),(0,v.jsx)(t1,{className:"params-card-bkg-select"}),(0,v.jsxs)("section",{className:"params-card-text-container",children:[(0,v.jsx)(eY.Z.Paragraph,{className:"params-card-title",ellipsis:{rows:1,showTooltip:!0,wrapper:"div"},children:n.name}),(0,v.jsxs)("span",{className:"params-card-label",children:[O.getText(I.CONTAIN_PARAMS),"："]}),(0,v.jsx)(V.Z,{size:"large",direction:"vertical",children:"group"===n.type?n.values.map(e=>(0,v.jsx)(l,{info:e})):(0,v.jsx)(l,{info:n})})]}),(0,v.jsxs)("section",{className:"params-card-footer",children:[(0,v.jsx)(E.Z,{type:"text",icon:(0,v.jsx)(tI.Z,{}),style:{color:"rgba(255, 255, 255, 0.90)"},onClick:()=>a(s),children:O.getText(I.DELETE)}),(0,v.jsx)(E.Z,{type:"text",icon:(0,v.jsx)(tM.Z,{}),onClick:()=>t(n,s),style:{color:"rgba(255, 255, 255, 0.90)"},children:O.getText(I.EDIT)})]})]})]},n.config_id),s!==e.length-1&&(0,v.jsx)("div",{className:"params-card-x",children:"x"})]})})})},t3=a.p+"static/image/empty-list-img.7cbd5a7b.png",t5=()=>(0,v.jsxs)(V.Z,{direction:"vertical",size:"large",className:"container-ygf0Pl",children:[(0,v.jsx)("img",{className:"emptyImg-dEb1QE",src:t3,alt:""}),(0,v.jsx)("p",{className:"text-VNWKyH",children:K.t("no_content_yet",{},"暂无内容")})]}),t4=()=>{let[e,t,a,l]=eR((0,ew.N)(e=>[e.paramsConfig,e.paramsListDisplayMode,e.updateParamsConfig,e.deleteParamsConfig])),n=(0,T.useMemo)(()=>[{title:K.t("parameter_name",{},"参数名"),dataIndex:"name",width:200,render:e=>(0,v.jsx)("span",{children:e})},{title:K.t("type",{},"类型"),dataIndex:"type",width:200,render:e=>(0,v.jsx)("span",{children:ek[e]})},{title:K.t("parameter",{},"参数"),width:200,render(e,t){let a="";return a="group"===t.type?t.values.map(e=>e.internal_name).toString():t.internal_name||"",(0,v.jsx)("span",{children:a})}},{title:O.getText(I.PARAMS_COPIES),width:200,render(e,t){var a,l;return(0,v.jsx)("span",{children:"group"===t.type?null==(l=t.values[0])||null==(a=l.values)?void 0:a.length:t.values.length})}},{title:K.t("source",{},"来源"),dataIndex:"",width:200,render:(e,t)=>(0,v.jsx)("span",{children:t.dataset_id?K.t("dataset_import",{},"数据集导入"):K.t("custom_parameters",{},"自定义参数")})},{title:K.t("operation",{},"操作"),width:200,render:(e,t,n)=>(0,v.jsxs)(V.Z,{children:[(0,v.jsx)(E.Z,{shape:"circle",icon:(0,v.jsx)(tM.Z,{}),size:"mini",onClick:()=>{a(t,n)}}),(0,v.jsx)(ej.Z,{title:K.t("are_you_sure_to_delete_this_parameter?",{},"确认删除该参数吗？"),onOk:()=>l(n),children:(0,v.jsx)(E.Z,{shape:"circle",icon:(0,v.jsx)(tI.Z,{}),size:"mini"})})]})}],[l,a]),s=(0,T.useMemo)(()=>t===eT.CARDS?(0,v.jsx)(t2,{}):(0,v.jsx)(tA.Z,{className:"table",rowKey:"config_id",columns:n,data:e,pagination:!1}),[t,e,n]);return(0,v.jsx)("div",{className:"params-list-container",children:e.length>0?s:(0,v.jsx)(t5,{})})},t6=()=>{let[e]=eR((0,ew.N)(e=>[e.addParamsConfig]));return(0,v.jsxs)("div",{className:"sdk-creator-content",children:[(0,v.jsxs)("section",{className:"sdk-creator-content-title",children:[(0,v.jsx)("p",{className:"sdk-creator-content-title-text",children:O.getText(I.PARAM_LIST)}),(0,v.jsx)(V.Z,{children:(0,v.jsx)(E.Z,{type:"primary",status:"default",onClick:()=>{e(),tQ()},size:"small",children:K.t("custom_parameters",{},"自定义参数")})})]}),(0,v.jsx)(t4,{})]})},t7=a.p+"static/image/final_count.b3e28698.png";async function t8(e){return(await tv.post(`${tC}/batch-task/create`,e)).data}async function t9(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return(await tv.get(`${tC}/batch-task/list?name=${e}&page_size=${t}&page_num=${a}&status=${l}&order_by=created_at desc`)).data}async function ae(e){return(await tv.post(`${tC}/batch-task/cancel`,{batch_task_id:e})).data}async function at(e){return(await tv.post(`${tC}/batch-task/delete`,{batch_task_id:e})).data}let aa=async(e,t)=>await tv.post(`${tC}/batch-task/update-name`,{batch_task_id:e,name:t}),al=async e=>await tv.get(`${tC}/batch-task/detail`,{params:{batch_task_id:e}});function an(e){for(let t=0;t<localStorage.length;t++){let a=localStorage.key(t);if(a&&a.startsWith(e))return localStorage.getItem(a)}return""}let as=()=>{let e=an("firebase:authUser");if(!e)return"";try{var t,a;return(null==(a=JSON.parse(e))||null==(t=a.stsTokenManager)?void 0:t.accessToken)??""}catch(e){return""}},ar=()=>{let e=an("firebase:authUser");if(!e)return"";try{var t;return(null==(t=JSON.parse(e))?void 0:t.apiKey)??""}catch(e){return""}},ai=async()=>{try{var e;let t,a,{paramsConfig:l,taskName:n}=eR.getState();if(null==(e=window.app)?void 0:e.ue_modified_prompt){let e=await window.app.ue_modified_prompt();t=e.output,a=e.workflow}else a=(t=await window.app.graphToPrompt()).workflow,t=t.output;await t8({client_id:sessionStorage.getItem("clientId")??"",prompt:t,workflow:a,auth_token_comfy_org:as(),api_key_comfy_org:ar(),extra_data:{extra_pnginfo:{workflow:a}},task_name:n,params_config:l}),console.log("创建批量任务成功"),tt.Z.success(K.t("create_batch_task_successfully",{},"创建批量任务成功"))}catch(e){console.log("创建批量任务失败",e),tt.Z.error(K.t("failed_to_create_batch_task",{},"创建批量任务失败"))}},ao=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,v.jsxs)("div",{className:"batch-tools-count-label",children:[(0,v.jsx)("span",{className:"batch-tools-count-number",children:e},eL()),t?(0,v.jsx)("span",{children:t},eL()):null]},eL())},ac=e=>{let t=1,a=[];return e.forEach((l,n)=>{var s,r,i,o;let c=0;c="group"===l.type?null==(i=l.values)||null==(r=i[0])||null==(s=r.values)?void 0:s.length:null==(o=l.values)?void 0:o.length;let d=l.name.length>10?`${l.name.slice(0,10)}...`:l.name;a.push(ao(c,n!==e.length-1?`${O.getText(I.PARAM_VALUES_COUNT_UNIT)}(${d}) x `:`${O.getText(I.PARAM_VALUES_COUNT_UNIT)}(${d})`)),t*=c}),{domList:a,count:e.length?t:0}},ad={container:"container-RaepCY",section:"section-qKaj_9",finalCount:"finalCount-hyBl8l",finalCountDefault:"finalCountDefault-LKP96_",header:"header-WPq9iX",headerTitle:"headerTitle-OPcRxW",headerCount:"headerCount-D4413O",content:"content-dDEHTL",card:"card-B22HNx",cardCount:"cardCount-y2xyZi",cardText:"cardText-yVvA0m",titleName:"titleName-n5KRLP"},au=e=>{let{label:t,content:a}=e;return(0,v.jsxs)("div",{className:"formItemLayout-LrQEOz",children:[(0,v.jsx)("p",{className:"formItemLayoutLabel-OEWa6G",children:t}),(0,v.jsx)("div",{children:a})]})},ah=()=>{let[e,t,a]=eR((0,ew.N)(e=>[e.taskName,e.paramsConfig,e.reset])),[l]=B((0,ew.N)(e=>[e.changeType])),[n,s]=(0,T.useState)(!1),r=(0,T.useMemo)(()=>ac(t),[t]),i=(0,T.useMemo)(()=>(0,v.jsx)("div",{className:"input-wrapper",children:(0,v.jsx)(eX.Z,{style:{width:"100%"},value:e,placeholder:K.t("come_up_with_a_name_for_the_batch_task_",{},"为批量任务取个名字吧～"),onChange:e=>{eR.setState({taskName:e})},maxLength:50})}),[e]),o=async()=>{eh(),s(!0);try{await new Promise(e=>{ai().then(()=>{e("")})}),l(Z.List),a()}catch(e){tt.Z.error(K.t("please_check_that_all_forms_are_completed",{},"请检查所有表单内容均填写完整"))}finally{s(!1)}};return(0,v.jsxs)("div",{className:ad.container,children:[(0,v.jsxs)("section",{className:ee()(ad.section,ad.finalCount),children:[(0,v.jsxs)("header",{className:ad.header,children:[(0,v.jsx)("p",{className:ad.headerTitle,children:O.getText(I.FINAL_RESULT_COUNT)}),(0,v.jsx)("p",{className:ad.headerCount,children:r.count.toLocaleString()})]}),t.length>0?(0,v.jsx)(eN.Z,{className:ad.content,children:t.map(e=>{let{type:t,config_id:a}=e,l="group"===t?e.values[0].values.length:e.values.length,n="group"===t?e.values.map(e=>e.internal_name).join("、"):e.internal_name;return(0,v.jsxs)("div",{className:ad.card,children:[(0,v.jsx)("p",{className:ad.cardCount,children:(l||0).toLocaleString()}),(0,v.jsx)("p",{className:ad.cardText,children:n})]},a)})}):(0,v.jsxs)("div",{className:ad.finalCountDefault,children:[(0,v.jsx)("img",{style:{width:120},src:t7,alt:""}),(0,v.jsxs)("span",{children:[K.t("final_number_of_generate_count_",{},"最终生成数="),(0,v.jsx)("br",{}),K.t("parameter_1_x_parameter_2_x____parameter_n",{},"参数1 x 参数2 x... 参数N")]})]})]}),(0,v.jsxs)("section",{className:ee()(ad.section,ad.titleName),children:[(0,v.jsx)(au,{label:K.t("task_name",{},"任务名称"),content:i}),(0,v.jsx)(E.Z,{type:"primary",onClick:o,disabled:0===t.length||0===e.trim().length,loading:n,style:{width:"100%",height:44,borderRadius:100},children:n?O.getText(I.SPENT_LONG_TIME_TEXT):O.getText(I.SUBMIT_CREATE_BATCH_TASK)})]})]})},ap=()=>{var e;return null==(e=window.app)?void 0:e.graphToPrompt().then(e=>{let{output:t}=e,a=[];return Object.keys(t).forEach(e=>{let{class_type:l,inputs:n}=t[e],s=[];Object.keys(n).forEach(e=>{s.push({label:e,value:n[e],isLinked:"object"==typeof n[e]})}),a.push({id:e,label:`#${e}: ${l}`,paramsList:s})}),eR.setState({allNodesOptions:a}),{allNodesOptions:a}})},am=async(e,t,a)=>{let l={client_id:(window.name||sessionStorage.getItem("clientId"))??"",workflow:a,prompt:t,extra_data:{extra_pnginfo:{workflow:a}}};return -1===e?l.front=!0:0!==e&&(l.number=e),await tv.post(`${tC}/workflow-validate`,l)};var ag=a(4411),a_=a(8422);let af=["SaveImage","Image Save","VHS_VideoCombine","VideoCombine_Adv","ShowText|pysssss","DisplayString","SaveVideo"],ax=e=>Object.values(e).some(e=>af.includes(e.class_type)),av=async()=>{try{var e;let t,a;if(null==(e=window.app)?void 0:e.ue_modified_prompt){let e=await window.app.ue_modified_prompt();t=e.output,a=e.workflow}else a=(t=await window.app.graphToPrompt()).workflow,t=t.output;let l=F.getState().task.outputRuleLink;if(!ax(t))return tt.Z.normal({id:"workflow_check_error",content:(0,v.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,v.jsx)(a_.Z,{style:{fontSize:20,color:"rgb(var(--danger-6))"}}),(0,v.jsxs)("div",{style:{display:"inline-block",textAlign:"left"},children:[K.t("it_is_detected_that_there_is_no_output_node_in_the_current_workflow__please_add_one",{},"检测到当前工作流没有输出节点，请添加相关节点后再进行批量验证!"),(0,v.jsx)("br",{}),K.t("please_check_the_output_node_specification__",{},"输出节点规范请查看,"),(0,v.jsx)(ag.Z,{href:l,target:"_blank",children:K.t("help_documentation",{},"帮助文档")})]})]})}),!1;try{await am(0,t,a)}catch(e){return tt.Z.error(K.t("current_workflow_cannot_be_executed",{},"检测到当前工作流无法跑通，请跑通工作流后再进行批量验证")),!1}return!0}catch(e){return console.error("Failed to execute create-task check"),!1}},aC=e=>(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:14,height:14,fill:"none",viewBox:"0 0 14 14",...e,children:(0,v.jsx)("path",{stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.33,d:"M12.25 5.25v-3.5m0 0h-3.5m3.5 0L7 7M5.833 1.75H4.55c-.98 0-1.47 0-1.844.19a1.75 1.75 0 0 0-.765.766c-.191.374-.191.864-.191 1.844v4.9c0 .98 0 1.47.19 1.845.169.329.436.597.766.764.374.191.864.191 1.844.191h4.9c.98 0 1.47 0 1.845-.19a1.75 1.75 0 0 0 .764-.766c.191-.374.191-.864.191-1.844V8.167"})}),aw={container:"container-Ivc2WF",header:"header-jAAYYL",headerLeft:"headerLeft-whUjnl",headerText:"headerText-KDEu_r",headerTitle:"headerTitle-yB4TK7"},aj=e=>{let{title:t,hideGuide:a=!1,backContent:l,content:n,style:s,onBack:r,guideLink:i=eE,headerClassName:o="",contentClassName:c=""}=e;return(0,v.jsxs)(eS.Z,{className:ee()(aw.container),style:s,children:[(0,v.jsxs)(eb.Z,{className:ee()(aw.header,o),children:[(0,v.jsx)("div",{onClick:()=>{r&&r()},children:l||(0,v.jsxs)(V.Z,{className:aw.headerLeft,children:[(0,v.jsx)(ey.Z,{}),(0,v.jsx)("p",{className:aw.headerText,children:K.t("return",{},"返回")})]})}),(0,v.jsx)("p",{className:aw.headerTitle,children:t}),a?null:(0,v.jsx)(V.Z,{children:(0,v.jsx)(E.Z,{href:i,target:"_blank",type:"secondary",size:"default",icon:(0,v.jsx)(aC,{}),style:{backgroundColor:"var(--color-fill-2)",height:36},children:O.getText(I.NEW_GUIDER_HELP)})})]}),(0,v.jsx)(eN.Z,{className:ee()(c),children:n})]})},ay=()=>{eu(),eR.setState({checkWorkflowLoading:!0}),av().then(e=>{eR.setState({checkWorkflowLoading:!1}),e&&B.getState().changeType(Z.Creator)})},aS=()=>{let[e,t]=eR((0,ew.N)(e=>[e.paramsConfig,e.reset])),[a]=F((0,ew.N)(e=>[e.task])),[l]=B((0,ew.N)(e=>[e.changeType]));(0,T.useEffect)(()=>{ap()},[]);let n=(0,T.useMemo)(()=>(0,v.jsxs)("div",{className:"batch-tools-creator-content",children:[(0,v.jsx)(t6,{}),(0,v.jsx)(ah,{})]}),[]),s=(0,T.useCallback)(()=>{l(Z.List),t()},[l,t]),r=(0,T.useMemo)(()=>(0,v.jsx)(V.Z,{className:"batch-tools-creator-back-content",children:(0,v.jsx)(ej.Z,{focusLock:!0,title:K.t("exit_operation_means_that_your_batch_tasks_and_parameters_will_not_be_preserved_",{},"退出操作意味着你所进行的批量任务和参数将不会被保留。你确定要退出吗"),onOk:s,cancelText:K.t("give_up",{},"放弃"),okText:K.t("ok_to_quit",{},"确定退出"),disabled:0===e.length,children:(0,v.jsxs)("div",{className:"batch-tools-creator-back-button",onClick:()=>{0===e.length&&s()},children:[(0,v.jsx)(ey.Z,{style:{fontSize:16}}),O.getText(I.EXIT)]})})}),[s,e]);return(0,v.jsx)(aj,{guideLink:a.newGuideHelpLink||eE,title:K.t("new_batch_task",{},"新建批量任务"),content:n,backContent:r,style:{height:"100%"}})};var aN=a(5195),ab=a(2425),ak=((g={}).Video="video",g.Image="image",g.Text="text",g);async function aT(e){return(await tv.get(`${tC}/batch-task/result?batch_task_id=${e}`)).data.data}let aE=e=>(0,v.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:200,height:200,fill:"none",viewBox:"0 0 200 200",...e,children:[(0,v.jsxs)("g",{clipPath:"url(#question_svg__a)",children:[(0,v.jsx)("path",{fill:"#000",stroke:"#000",d:"M100.75 191.987c6.215-.558 8.701-9.199 10.359-15.052l4.972 15.052z"}),(0,v.jsx)("path",{fill:"#C5C5C5",d:"M103.975 62.974c-3.941-5.03-1.949-13.818 7.345-23.034 12.98-11.882 25.529-9.255 26.117-8.98.588.274 13.004 9.06 24.825 21.305s24.193 22.732 24.345 39.535c.153 16.803-17.259 22.885-30.032 22.961s-41.277-.282-46.752-1.194c-3.435 4.507-8.898 9.378-10.913 10.434 4.227 3.632 19.318 18.976 21.133 22.216s9.722 14.519 6.092 32.279c-1.663 8.138-8.169 12.305-14.891 13.612 0 0-9.206-.052-12.334 0-7.776.13-88.02 0-90.353 0s-3.006-2.093 0-8.198 14.09-25.368 19.898-28.806c2.312-1.304 7.533 2.07 8.63 2.852 1.027.731 2.022 1.594 3.444 1.476s8.84-.152 11.209-.075c-4.286-3-20.033-17.685-21.958-24.83-1.53-5.678.3-8.958 1.113-9.715-8.528-4.988-17.206-14.892-13.81-29.607.952-4.128 3.53-8.428 5.453-9.667 3.615-2.33 15.882-3.507 23.32-4.186 32.698-2.986 107.186-1.904 109.448-1.883-3.118-2.375-15.199-15.931-15.48-16.388-.773 2.213-3.828 5.022-6.111 4.706-2.026-.28-3.153-3.453-.809-8.48a30 30 0 0 1-2.491 2.294c-1.244 1.011-2.804 1.219-3.37 0-.499-1.072-.333-3.117.819-5.84-1.232 1.161-2.459 2.126-3.561 2.684-3.689 1.867-4.601-5.233.341-11.275-7.103 3.473-9.117 6.309-10.881 10.469-1.087 2.564-1.471 4.914-4.462 6.243-2.294 1.02-4.215.509-5.324-.908"}),(0,v.jsx)("path",{stroke:"#17171A",d:"M124.642 47.17c-7.103 3.473-9.117 6.309-10.881 10.469-1.087 2.564-1.471 4.914-4.462 6.243-2.294 1.02-4.215.509-5.324-.908-3.941-5.03-1.949-13.818 7.345-23.034 12.98-11.882 25.529-9.255 26.117-8.98.588.274 13.004 9.06 24.825 21.305s24.193 22.732 24.345 39.535c.153 16.803-17.259 22.885-30.032 22.961s-41.277-.282-46.752-1.194m14.819-66.397c6.999-2.597 6.638-4.972 6.226-5.442s-4.638 2.737-6.226 5.442Zm0 0c-4.942 6.042-4.03 13.142-.341 11.275 4.848-2.453 12.087-12.772 11.642-13.118-.316-.246-2.074.747-5.321 5.497-3.541 5.181-4.345 9.128-3.579 10.777.566 1.219 2.126 1.011 3.37 0 4.793-3.898 9.41-10.885 9.164-11.06s-1.843.447-5.609 6.767c-3.679 6.175-2.538 10.163-.255 10.48 2.283.316 5.338-2.494 6.111-4.707.281.457 12.362 14.013 15.48 16.388m-45.481 34.098c-3.435 4.507-8.898 9.378-10.913 10.434m10.913-10.434c3.584-4.914 6.761-9.938 8.313-15.295m37.168-18.803c-2.262-.021-76.75-1.103-109.448 1.883-7.438.68-19.705 1.857-23.32 4.186-1.922 1.239-4.5 5.539-5.453 9.667-3.396 14.715 5.282 24.619 13.81 29.607M155.305 79.47c2.261.021 6.136.694 5.804 3.1-.216 1.562-4.717-2.12-5.804-3.1ZM98.91 124c4.227 3.632 19.318 18.976 21.133 22.216s9.722 14.519 6.092 32.279c-1.663 8.138-8.169 12.305-14.891 13.612 0 0-9.206-.052-12.334 0-7.776.13-88.02 0-90.353 0s-3.006-2.093 0-8.198 14.09-25.368 19.898-28.806c2.312-1.304 7.533 2.07 8.63 2.852 1.027.731 2.022 1.594 3.444 1.476s8.84-.152 11.209-.075m47.172-35.356H88.098m-36.36 35.356c3.059.099 9.595-.491 11.847 1.543 2.045 1.847.559 4.592-2.534 3.842-3.637-.883-8.128-4.556-9.313-5.385Zm0 0c-4.286-3-20.033-17.685-21.958-24.83-1.53-5.678.3-8.958 1.113-9.715m57.205-.811c-8.087-8.499-17.704-16.179-22.811-19.89m22.811 19.89q1.261 1.323 2.46 2.668c1.944 2.178 8.476 9.597 9.126 14.147.369 2.587.06 6.793-.907 10.96m-67.883-26.964c3.334 1.788 11.877 6.075 19.372 8.912m0 0c9.367 3.547 19.193 6.258 22.376 9.896s-.761 8.672-1.913 12.751c-.29 1.029-.623 2.59-.266 3.493.452 1.14 1.776 1.363 3.744-.17 3.525-2.745 6.653-9.565 7.304-11.572.65-2.006-4.435 8.264-4.977 12.799s3.488 3.792 6.197 0c3.172-4.442 4.8-9.545 5.016-10.521s-2.732 5.445-3.6 9.294c-.233 1.038-.843 3.472 0 4.442.96 1.103 2.872.814 5.077-2.726 2.516-4.042 4.38-9.708 4.598-11.01.216-1.301-3.054 7.306-3.548 11.498-.346 2.942.663 4.377 4.178 0 1.987-2.475 3.435-6.282 4.325-10.122m-48.511-18.052c-1.974 2.717-4.252 5.291-10.807 6.321m59.318 11.731c3.184 2.921 7.344 8.248 8.242 14.176s0 13.463-9.4 21.346m-32.332-83.187c-5.705-4.146-8.966-4.563-11.457-4.563-3.64 0-4.477 1.956-1.16 3.2 3.319 1.245 9.35 1.363 12.617 1.363Zm0 0H72.2"}),(0,v.jsx)("path",{fill:"#17171A",fillRule:"evenodd",d:"m115.942 192.126-5.175-15.667-.124.437c-.829 2.93-1.861 6.538-3.458 9.484-1.599 2.948-3.742 5.196-6.779 5.468l.012.278z",clipRule:"evenodd"}),(0,v.jsx)("path",{fill:"#C6CACD",fillRule:"evenodd",d:"m122.415 137.352 5.094 9.477h-7.45l-5.094-9.477z",clipRule:"evenodd"}),(0,v.jsx)("path",{fill:"#C5C5C5",stroke:"#17171A",d:"M104.098 141.476h33.95l14.826 27.432h-33.95z"}),(0,v.jsx)("path",{fill:"#6B7074",stroke:"#17171A",d:"M183.115 155.135H139.52v38.861h43.595zM139.867 154.692l9.286-16.84h43.454l-9.286 16.84zM139.407 155.135h-28.184v38.861h28.184z"}),(0,v.jsx)("path",{fill:"#17171A",fillRule:"evenodd",d:"m166.555 154.913 3.902-6.969h-6.132l-3.591 6.412h-.312v13.379h6.133z",clipRule:"evenodd"}),(0,v.jsx)("path",{fill:"#47FFF2",fillOpacity:.2,d:"M45.577 71.846c18.32 0 33.172-14.851 33.172-33.171S63.897 5.504 45.577 5.504s-33.17 14.851-33.17 33.171 14.85 33.171 33.17 33.171"}),(0,v.jsx)("path",{fill:"#47FFF2",fillRule:"evenodd",d:"M48.845 47.665c1.772-.45 2.874-2.098 2.465-3.88-.279-1.213.272-2.409 1.139-3.302 3.027-3.12 5.085-7.778 3.663-12.778-.748-2.717-2.77-5.095-5.43-6.596-2.904-1.6-6.473-1.906-9.876-.866l-.17.072c-5.777 1.968-8.302 7.055-8.257 11.964.02 2.047 2.12 3.205 4.09 2.645 2.003-.57 2.972-2.806 3.633-4.782.392-1.168 1.257-2.231 2.93-2.751 1.958-.63 3.35-.209 4.155.259.878.639 1.585 1.35 1.777 2.28.847 2.473-.825 5.205-2.736 6.421-2.684 1.683-3.027 5.479-2.458 8.79.361 2.101 2.545 3.166 4.611 2.642zm.026 3.154a4.097 4.097 0 1 1 2.525 7.795 4.097 4.097 0 0 1-2.525-7.795",clipRule:"evenodd"}),(0,v.jsx)("path",{fill:"#17171A",fillRule:"evenodd",d:"m98.633 82.579-.111-.01-.034.105c-.786 2.422-1.657 5.232-1.519 8.035.139 2.815 1.293 5.614 4.533 8.01 3.165 2.338 6.578 1.775 9.185-.16 2.601-1.93 4.418-5.235 4.418-8.422 0-1.25-.814-2.32-2.047-3.22-1.235-.901-2.917-1.653-4.715-2.265-3.597-1.223-7.694-1.896-9.71-2.073m17.18 21.687c-1.33 3.103-4.628 7.681-6.115 9.585l.115-.146 5.241.372.037-.08c.232-.492.409-1.194.547-1.999.138-.807.237-1.729.306-2.664a58 58 0 0 0 .136-5.016zm-84.955 20.007-.161-.102-1.334 5.038.11.048c4.395 1.897 14.112 4.052 21.09 4.61l.062-.268c-7.776-3.042-16.194-7.067-19.767-9.326",clipRule:"evenodd"}),(0,v.jsx)("path",{stroke:"#17171A",d:"M71.031 48.989c5.249 1.236 16.12 6.398 17.613 17.155"}),(0,v.jsx)("path",{fill:"#C5C5C5",stroke:"#17171A",strokeMiterlimit:10,d:"M108.086 96.577c-5.726 0-10.367-4.641-10.367-10.366 0-5.726 4.641-10.367 10.367-10.367 5.725 0 10.367 4.641 10.367 10.367 0 5.725-4.642 10.366-10.367 10.366Z"}),(0,v.jsx)("path",{fill:"#17171A",fillRule:"evenodd",d:"M110.798 85.862a.42.42 0 0 0-.561-.187c-1.415.707-2.956.884-3.526.884a.418.418 0 1 0 0 .836c.669 0 2.345-.194 3.9-.972a.42.42 0 0 0 .187-.56m-2.662 3.516a.882.882 0 1 1 1.76-.128.882.882 0 0 1-1.76.128m7.103-.945a.883.883 0 1 0 .129 1.76.883.883 0 0 0-.129-1.76",clipRule:"evenodd"}),(0,v.jsx)("path",{fill:"#17171A",d:"M100.585 87.313s-5.735-6.617-.662-11.028c6.618-5.956 21.175-.441 21.175-.441s-.22 7.058-4.852 7.94c-4.412.662-12.573-2.426-12.573-2.426z"}),(0,v.jsx)("path",{fill:"#C5C5C5",stroke:"#17171A",strokeMiterlimit:10,d:"M98.377 88.637a2.647 2.647 0 1 1 0-5.294 2.647 2.647 0 0 1 0 5.294Z"})]}),(0,v.jsx)("defs",{children:(0,v.jsx)("clipPath",{id:"question_svg__a",children:(0,v.jsx)("path",{fill:"#fff",d:"M0 0h200v200H0z"})})})]});var aA=a(1191),aM=a(2309),aI=a(9066),aL=a(6798);function az(e){let{options:t,value:a,shouldChangeConfirm:l=!1,onSelect:n}=e,s=(0,T.useRef)(null),[r,i]=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],[t,a]=(0,T.useState)(e);return[t,(0,T.useMemo)(()=>({toggle:e=>a(e),setTrue:()=>a(!0),setFalse:()=>a(!1)}),[])]}(),o=(0,T.useCallback)(e=>(0,v.jsx)(eY.Z.Ellipsis,{style:{marginBottom:0,lineHeight:"unset"},rows:1,showTooltip:!0,children:e}),[]);return(0,v.jsx)("div",{ref:s,children:(0,v.jsx)(aM.Z,{className:"container-_ecGSX",position:"bl",trigger:"click",content:(0,v.jsxs)(W,{direction:"column",align:"flex-start",gap:8,children:[(0,v.jsxs)(W,{className:"contentTitle-Co3Ej_",justify:"center",align:"center",gap:4,children:[O.getText(I.TABLE_CONFIG_GROUP),(0,v.jsx)(aI.Z,{})]}),(0,v.jsx)(eq.Z,{className:"contentSelector-M6zvaO",placeholder:O.getText(I.SELECT_PARAM_PLACEHOLDER),value:a,renderFormat:()=>o((t.find(e=>e.value===a)||{label:""}).label),onChange:e=>{let a=t.findIndex(t=>t.value===e);n(e,a)},children:t.map((e,t)=>(0,v.jsx)(eq.Z.Option,{value:e.value,extra:e.extra,children:(0,v.jsx)("div",{onClick:e=>{l&&e.stopPropagation()},children:(0,v.jsx)(ej.Z,{disabled:!l,trigger:"click",title:K.t("Are_you_sure_you_want_to_switch_the_table_configuration?_the_current_custom_row__column_configuration_will_be_cleared",{},"确定切换表格配置吗，切换后将清空当前自定义行、列配置"),content:null,onOk:()=>{n(e.value,t)},position:"rt",children:(0,v.jsx)("div",{children:o(e.label)})})},e.value)},e.value))})]}),popupVisible:r,onVisibleChange:i.toggle,getPopupContainer:()=>s.current,children:(0,v.jsxs)(W,{className:ee()("popoverBtn-KruaVW",{"popoverOpen-quTZwG":r}),align:"center",gap:4,children:[O.getText(I.TABLE_CONFIG_BOARD)," ",(0,v.jsx)(aL.Z,{style:{fontSize:12}})]})})})}let aR=function(e,t){let a;if("string"!=typeof e)return e;try{a=JSON.parse(e)}catch(e){a=t}return a},aU={visible:!1,taskId:"",name:"",tableConfigOptions:[],previewPercent:100,loading:!0,customColumns:[],customRows:[],originColumns:[],originRows:[],customColumnsChanged:!1,customRowsChanged:!1},aP=(0,M.U)(e=>({...aU,reset(){e(aU)},setTask(t,a,l,n){e({...aU,taskId:t,name:a,tableConfigOptions:aR(l,[]).filter(e=>"system"!==e.category),selectedConfigOptionIndex:(0,w.isNumber)(n)&&n>=0&&n<l.length?n:void 0})},async openDrawer(){e({visible:!0})}}));aP.getState().openDrawer;let aO=e=>e.filter(e=>!aF(e)).map(e=>{let t=aD(e);return{label:t,value:t,extra:e}});function aZ(e){return(null==e?void 0:e.type)!=="group"}function aD(e){return aZ(e)?`#${e.nodeId}:${e.internal_name}`:e.values.map(e=>aD(e)).join(" + ")}function aF(e){return!!aZ(e)&&"system"===e.category}var aH=a(339);let aB=e=>(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:14,height:14,fill:"none",viewBox:"0 0 14 14",...e,children:(0,v.jsx)("path",{fill:"#fff",fillOpacity:.7,fillRule:"evenodd",d:"M2.041 1.458a.583.583 0 0 0-.583.583v3.792c0 .322.261.583.583.583h3.792a.583.583 0 0 0 .583-.583V2.041a.583.583 0 0 0-.583-.583zm.584 3.792V2.625H5.25V5.25zm5.541-3.792a.583.583 0 0 0-.583.583v3.792c0 .322.261.583.583.583h3.792a.583.583 0 0 0 .583-.583V2.041a.583.583 0 0 0-.583-.583zM8.75 5.25V2.625h2.625V5.25zM1.458 8.166c0-.322.261-.583.583-.583h3.792c.322 0 .583.261.583.583v3.792a.583.583 0 0 1-.583.583H2.041a.583.583 0 0 1-.583-.583zm1.167.584v2.625H5.25V8.75zm5.541-1.167a.583.583 0 0 0-.583.583v3.792c0 .322.261.583.583.583h3.792a.583.583 0 0 0 .583-.583V8.166a.583.583 0 0 0-.583-.583zm.584 3.792V8.75h2.625v2.625z",clipRule:"evenodd"})}),aV=e=>(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:14,height:14,fill:"none",viewBox:"0 0 14 14",...e,children:(0,v.jsx)("path",{fill:"#fff",fillOpacity:.7,fillRule:"evenodd",d:"M3.792 1.75h-1.75V3.5h1.75zm0 4.375h-1.75v1.75h1.75zm0 4.375h-1.75v1.75h1.75zm2.333-8.75h1.75V3.5h-1.75zm0 4.375h1.75v1.75h-1.75zm0 4.375h1.75v1.75h-1.75zm4.084-8.75h1.75V3.5h-1.75zm0 4.375h1.75v1.75h-1.75zm0 4.375h1.75v1.75h-1.75z",clipRule:"evenodd"})});function aW(){let[e]=aP((0,ew.N)(e=>[e.previewPercent])),t=(0,T.useMemo)(()=>(0,w.throttle)(e=>{aP.setState({previewPercent:e})},300,{leading:!1}),[]);return(0,v.jsxs)(W,{className:"container-At15La",gap:12,align:"center",children:[(0,v.jsx)(aV,{}),(0,v.jsx)(aH.Z,{className:"slider-fFZ72L",min:50,max:150,range:!1,value:e,onChange:t,formatTooltip:e=>`${e}%`,getTooltipContainer:()=>document.body}),(0,v.jsx)(aB,{})]})}let a$=e=>(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:12,height:13,fill:"none",viewBox:"0 0 12 13",...e,children:(0,v.jsx)("path",{fill:"#fff",fillOpacity:.85,fillRule:"evenodd",d:"M9.5 1a.5.5 0 0 1 .5.5v1.793l.646-.647a.5.5 0 0 1 .708.708l-1.5 1.5a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L9 3.293V1.5a.5.5 0 0 1 .5-.5m-5.62.5h2.37a.5.5 0 0 1 0 1H3.9c-.428 0-.72 0-.944.019-.22.018-.332.05-.41.09a1 1 0 0 0-.437.437c-.04.078-.072.19-.09.41C2 3.68 2 3.972 2 4.4v4.2c0 .428 0 .72.019.944.018.22.05.332.09.41a1 1 0 0 0 .4.417c.044-.067.09-.118.12-.151a5 5 0 0 1 .286-.273L7.17 6.08c.08-.074.16-.146.233-.203.081-.063.182-.13.31-.171a1 1 0 0 1 .557-.018c.13.034.235.094.32.152.076.052.16.119.245.187l1.41 1.128.032.026c.157.125.296.236.404.373.135.172.23.371.28.584.04.17.04.347.04.549v.382c0 .397 0 .693-.068.949a2 2 0 0 1-1.414 1.414c-.256.068-.552.068-.95.068H3.517c-.128 0-.252 0-.356-.007a6 6 0 0 1-.286-.015c-.281-.023-.54-.072-.782-.196a2 2 0 0 1-.874-.874c-.124-.243-.173-.501-.196-.782C1 9.356 1 9.023 1 8.62V4.379c0-.402 0-.734.022-1.005.023-.281.072-.54.196-.782a2 2 0 0 1 .874-.874c.243-.124.501-.173.782-.196.27-.022.603-.022 1.005-.022m5.915 8.607a1 1 0 0 0 .124-.214 1.1 1.1 0 0 0 .067-.355c.014-.194.014-.443.014-.81 0-.266-.003-.318-.013-.362a.5.5 0 0 0-.094-.194c-.027-.035-.066-.07-.274-.236l-1.398-1.12c-.1-.08-.155-.122-.196-.15l-.004-.003-.004.003c-.04.03-.09.076-.186.163L3.793 10.5h4.435c.367 0 .616 0 .81-.014.189-.013.287-.037.355-.067a1 1 0 0 0 .402-.312M4.25 4.25a.5.5 0 1 0 0 1 .5.5 0 0 0 0-1m-1.5.5a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0",clipRule:"evenodd"})});var aG=((_={}).Waiting="waiting",_.Running="running",_.Completed="completed",_.Failed="failed",_.PartiallySucceeded="partial_success",_.Succeed="success",_.Canceled="cancelled",_.Dirty="dirty",_),aK=((f={}).Waiting="waiting",f.Packing="packing",f.Succeed="succeed",f.Failed="failed",f);function aq(e){let{tooltip:t,...a}=e,l=(0,v.jsx)(E.Z,{shape:"circle",...a});return t?(0,v.jsx)(tG.Z,{..."string"==typeof t?{content:t}:t,getPopupContainer:()=>document.body,children:l}):l}let aY=e=>e?e.startsWith("http")?e:tU(e):"",aX=e=>e?e.startsWith("http")?e:tU(e,"resource"):"",aJ=e=>e?e.startsWith("http")?e:tU(e,"download"):"";a(4445);let aQ=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"result",a=document.createElement("a");a.style.display="none",a.href=e,a.download=`${t}.tar`,document.body.appendChild(a),a.click(),tt.Z.success(O.getText(I.DOWNLOAD_END)),document.body.removeChild(a)},a0=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"result";fetch(e,{method:"GET",credentials:"include"}).then(e=>e.blob()).then(e=>{let a=window.URL.createObjectURL(e),l=document.createElement("a");l.href=a,l.download=`${t}`,l.click(),window.URL.revokeObjectURL(a)})};function a1(e){let{taskId:t,statusInfo:a,size:l="default"}=e,[n,s]=(0,T.useState)(a),r=function(e){let t=(0,T.useRef)(e);return t.current=e,t}(n),[i,o]=(0,T.useState)(0),c=(0,T.useCallback)((0,w.debounce)(async()=>{try{em();let{package_info:e,name:a}=(await al(t)).data.data;if(e.status!==aK.Succeed)throw Error(K.t("system_error",{},"系统错误"));aQ(aJ(e.result),a)}catch(e){console.error("下载失败",e),tt.Z.error(K.t("download_failed",{},"下载失败"))}},500),[t]);return((0,T.useEffect)(()=>{let e=setTimeout(()=>{o(e=>e+1)},1e4),l=()=>clearTimeout(e);if(a){s(a),l();return}return r.current&&[aK.Succeed,aK.Failed].includes(r.current.packageStatus)?void l():((async()=>{let{status:e,package_info:a}=(await al(t)).data.data;s({status:e,packageStatus:a.status})})(),l)},[t,null==a?void 0:a.status,null==a?void 0:a.packageStatus,i]),n&&[aG.Succeed,aG.PartiallySucceeded,aG.Canceled].includes(n.status))?(0,v.jsx)(aq,{icon:(0,v.jsx)(a$,{}),onClick:c,size:l,tooltip:{content:{[aK.Waiting]:K.t("the_result_set_has_been_generated_and_is_to_be_packaged__please_wait_a_moment_",{},"结果集已生成，待打包处理，请稍等"),[aK.Packing]:K.t("the_result_set_is_being_packaged_and_processed__please_wait_a_moment_",{},"结果集已正在打包处理，请稍等"),[aK.Failed]:(0,v.jsx)(v.Fragment,{children:K.t("result_set_packaging_processing_failed",{},"结果集打包处理失败")}),[aK.Succeed]:K.t("the_result_set_has_been_packaged__click_to_download_",{},"结果集已打包完成，点击下载")}[n.packageStatus]},disabled:n.packageStatus!==aK.Succeed}):null}var a2=a(4171),a3=a(5726),a5=a(7100),a4=a(4321),a6=a(2665),a7=a(770);let a8=e=>(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16",...e,children:(0,v.jsx)("path",{fill:"#fff",fillOpacity:.85,fillRule:"evenodd",d:"M8 2a6 6 0 0 0-4.043 10.433l5.499-5.499c.119-.119.235-.235.341-.325.117-.099.264-.205.458-.268.267-.087.556-.087.824 0 .193.063.34.17.457.268.106.09.222.206.341.325l2.044 2.044A6 6 0 0 0 8 2m5.487 8.43L10.95 7.892a6 6 0 0 0-.277-.266l-.006-.006-.007.006c-.06.05-.136.126-.276.266L5.05 13.226a6.001 6.001 0 0 0 8.437-2.796m-9.88 3.442a7.333 7.333 0 1 0 8.787-11.744 7.333 7.333 0 0 0-8.787 11.744M5.667 5a.667.667 0 1 0 0 1.333.667.667 0 0 0 0-1.333m-2 .667a2 2 0 1 1 4 0 2 2 0 0 1-4 0",clipRule:"evenodd"})});var a9=a(9253),le=a(3022),lt=a(2239);(0,a9.MD)();let la=(n={data:[],columnList:[],currentRow:0,currentCol:0,preview:[],cellSize:0,observer:new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){let t=e.target.getAttribute("data-src")??"";la.setState({lazyImgVisibleMap:{...la.getState().lazyImgVisibleMap,[t]:!0}})}})},{root:null,rootMargin:"0px",threshold:.1}),lazyImgVisibleMap:{}},s=(e,t)=>({getCellValue(e,a){let{data:l,columnList:n}=t();return e>=0&&e<l.length&&a>=0&&a<n.length?l[e][n[a].dataIndex]:[]},onCellPreview:(a,l)=>{let{data:n,columnList:s}=t();if(l>=0&&l<n.length&&a>=0&&a<s.length){let t=n[l][s[a].dataIndex],r=[];t.filter(e=>"image"===e.type).forEach(e=>e.value.forEach(e=>r.push({type:ak.Image,url:e}))),r.length>0&&e({preview:r,currentCol:a,currentRow:l})}}}),(e=>{let t=e.getState(),a={};for(let e of Object.keys(t)){let l=t[e];"function"==typeof l&&(a[e]=l)}return e.action=a,e})((0,M.U)((0,le.XR)((0,lt.n)((r=n,i=s,(e,t,a)=>({reset(){e(r)},...r,...i(e,t,a)}))))))),ll={container:"container-R4CNBS",loading:"loading-SZge5z",hidden:"hidden-DvWqet",image:"image-mxvLxv"},ln=e=>{let[t,a]=(0,T.useState)(!0),l=la(e=>e.observer),n=la(e=>e.lazyImgVisibleMap),s=(0,T.useRef)(null);return(0,T.useEffect)(()=>(s.current&&l.observe(s.current),()=>{s.current&&l.unobserve(s.current)}),[l]),(0,v.jsxs)("div",{ref:s,className:ee()(ll.container,e.className,"lazy-image"),style:e.style,"data-src":e.src,children:[n[e.src??""]?(0,v.jsx)(tR.Z,{...e,className:ee()(ll.image,t?ll.hidden:""),preview:!1,onLoad:t=>{e.onLoad&&e.onLoad(t),a(!1)}}):null,t?(0,v.jsx)("div",{className:ll.loading}):null]})},ls={container:"container-Vn8XdU",loading:"loading-nRX3YJ"},lr=e=>(0,v.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:226,height:226,fill:"none",viewBox:"0 0 226 226",...e,children:[(0,v.jsx)("rect",{width:224,height:224,x:1,y:1,fill:"#fff",fillOpacity:.08,stroke:"#fff",strokeOpacity:.08,rx:4}),(0,v.jsx)("path",{fill:"#fff",fillOpacity:.08,fillRule:"evenodd",d:"M113.953 117.392c.007.253-.079.498-.243.69l-9.682 11.15H96c-1.282 0-2.317-1.073-2.317-2.354V99.787c0-1.322 1.034-2.354 2.317-2.354H114l-2.317 2.643H97.407c-.538 0-.993.371-1.076.95v21.557l10.469-12.637q.043-.044.075-.086c.042-.05.078-.094.132-.121l1.613 1.611 5.048 5.369c.176.181.277.421.285.673m2.999-9.163a3.98 3.98 0 0 1 .862-4.332 3.97 3.97 0 0 1 6.785 2.81 3.98 3.98 0 0 1-3.975 3.975 3.97 3.97 0 0 1-3.672-2.453m3.528-10.796h7.928c1.315 0 2.375 1.035 2.375 2.318v27.121a2.36 2.36 0 0 1-.694 1.676 2.34 2.34 0 0 1-1.681.684h-18.825l10.006-11.221c.339-.414.339-.993-.042-1.366l-2.502-2.609.382-.289.054-.036c.356-.232.645-.42 1.048-.42a1.46 1.46 0 0 1 1.103.497l8.479 8.861-.042-21.573c-.042-.579-.509-.993-1.102-.993h-8.777l2.12-2.402c.069-.034.109-.121.145-.197z",clipRule:"evenodd"})]}),li=e=>{let{styles:t}=e;return(0,v.jsx)("div",{className:"container-AW9tcC",style:t,children:(0,v.jsx)(lr,{className:"error-pD5UNj"})})},lo=e=>{let[t,a]=(0,T.useState)("loading"),l=(0,T.useMemo)(()=>"loading"===t?(0,v.jsx)("div",{className:ls.loading,style:{...e.style??{}}}):"failed"===t?(0,v.jsx)(li,{}):null,[t]);return(0,v.jsxs)("div",{className:ls.container,children:[(0,v.jsx)("img",{width:"100%",height:"100%",onError:()=>{a("failed")},onLoad:()=>{a("succeed")},...e}),l]})},lc=e=>(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24",...e,children:(0,v.jsx)("path",{fill:"#fff",fillOpacity:.85,fillRule:"evenodd",d:"M12.707 4.293a1 1 0 0 1 0 1.414L7.414 11H19a1 1 0 1 1 0 2H7.414l5.293 5.293a1 1 0 0 1-1.414 1.414l-7-7a1 1 0 0 1 0-1.414l7-7a1 1 0 0 1 1.414 0",clipRule:"evenodd"})}),ld=e=>(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24",...e,children:(0,v.jsx)("path",{fill:"#fff",fillOpacity:.85,fillRule:"evenodd",d:"M11.293 4.293a1 1 0 0 1 1.414 0l7 7a1 1 0 0 1 0 1.414l-7 7a1 1 0 0 1-1.414-1.414L16.586 13H5a1 1 0 1 1 0-2h11.586l-5.293-5.293a1 1 0 0 1 0-1.414",clipRule:"evenodd"})}),lu=e=>{try{let{currentCol:t,currentRow:a}=la.getState();switch(e){case"ArrowUp":a-=1;break;case"ArrowDown":a+=1;break;case"ArrowLeft":t-=1;break;case"ArrowRight":t+=1}la.action.onCellPreview(t,a)}catch(e){console.error("change preview error",e)}},lh={container:"container-OgOzv9",left:"left-bC1nZO",right:"right-fPhjmK",imgContainer:"imgContainer-ZR_8WR",img:"img-wLCBfQ",icon:"icon-AIO9Z3"},lp=()=>{let[e,t,a]=la((0,ew.N)(e=>[e.currentCol,e.currentRow,e.columnList])),{getCellValue:l}=la.action,n=(0,T.useMemo)(()=>{let n,s,r=a.length-1;n=e-1<0?void 0:l(t,e-1),s=e+1>r?void 0:l(t,e+1);let i="",o="";return n&&(n.filter(e=>"image"===e.type).length>0&&(i=n.filter(e=>"image"===e.type)[0].value[0]),s&&s.filter(e=>"image"===e.type).length>0&&(o=s.filter(e=>"image"===e.type)[0].value[0])),{leftImg:i,rightImg:o}},[a.length,e,t,l]);return(0,T.useEffect)(()=>{let e=e=>{lu(e.code)};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[]),(0,v.jsxs)("div",{className:lh.container,children:[n.leftImg?(0,v.jsxs)("div",{className:lh.left,onClick:()=>lu("ArrowLeft"),children:[(0,v.jsx)("div",{className:lh.imgContainer,children:(0,v.jsx)("img",{className:lh.img,src:n.leftImg,alt:""})}),(0,v.jsx)("span",{children:K.t("previous_cell",{},"前一个单元格")}),(0,v.jsx)(lc,{className:lh.icon})]}):null,n.rightImg?(0,v.jsxs)("div",{className:lh.right,onClick:()=>lu("ArrowRight"),children:[(0,v.jsx)("div",{className:lh.imgContainer,children:(0,v.jsx)("img",{className:lh.img,src:n.rightImg,alt:""})}),(0,v.jsx)("span",{children:K.t("next_cell",{},"后一个单元格")}),(0,v.jsx)(ld,{className:lh.icon})]}):null]})},lm={container:"container-jm9zNJ",video:"video-MEjycV"};var lg=a(1051);let l_=e=>{let{renderMode:t="full",objectFit:a,result:l,extra:n=null,onClose:s,getPopupContainer:r}=e,{url:i,type:o}=l,c=new URLSearchParams(i.split("?")[1]).get("file_name");return o===ak.Image?"full"===t?(0,v.jsx)(tR.Z.Preview,{className:lm.container,visible:!0,src:i,onVisibleChange:s,style:{objectFit:a,background:"var(--color-fill-2)"},extra:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(lp,{}),n||null]}),getPopupContainer:r||(()=>document.body),actions:[{key:"download",name:K.t("download",{},"下载"),content:(0,v.jsx)(lg.Z,{onClick:()=>{c?a0(i,c):console.log("fileName is empty")}})}]}):(0,v.jsx)("div",{className:lm.container,style:{background:"var(--color-fill-2)"},children:(0,v.jsx)(lo,{style:{objectFit:a},src:i})}):o===ak.Video?(0,v.jsx)(tZ,{className:lm.video,width:"100%",src:i,controls:"full"===t,style:{objectFit:a},hoverPlay:!0}):null},lf={container:"container-MywQkT",layout:"layout-zU05PX",resource:"resource-P5gkS8",extra:"extra-rneusQ",extraImage:"extraImage-EpTaTJ",extraActive:"extraActive-YYlbrl"},lx=e=>{let{close:t}=A.Z.confirm({title:null,wrapClassName:"fullscreenWrap-CmW9jp",icon:null,footer:null,className:"fullscreenModal-qVNFk3",content:(0,v.jsx)("div",{className:"fullscreenContent-p4yLzy",children:e}),alignCenter:!0,focusLock:!1,closable:!0,escToExit:!1,maskClosable:!1,closeIcon:null,mask:!1});return()=>{t()}};function lv(e){let{onClose:t}=e;return(0,v.jsx)(E.Z,{icon:(0,v.jsx)(eC.Z,{}),style:{width:40,height:40,position:"absolute",right:36,top:36},shape:"circle",onClick:()=>t()})}let lC="modal-preview-extra-item";function lw(e){let{onClose:t}=e,a=la(e=>e.preview),[l,n]=(0,T.useState)(0),s=(0,T.useRef)(null),r=(0,T.useMemo)(()=>(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:lf.extra,ref:s,children:a.map((e,a)=>(0,v.jsx)("div",{className:ee()({[lf.extraImage]:!0,[lf.extraActive]:l===a}),id:`${lC}-${a}`,onClick:()=>{a!==l&&n(a)},children:(0,v.jsx)(l_,{result:e,onClose:t,renderMode:"clean",objectFit:"cover"})},e.url))}),(0,v.jsx)(lp,{})]}),[t,a,l]);return(0,T.useEffect)(()=>{let e=a.length,t=t=>{if("ArrowDown"===t.code){n(t=>{let a=t+1;return a>=e?0:a}),t.stopImmediatePropagation();return}if("ArrowUp"===t.code){n(t=>{let a=t-1;return a<0?e-1:a}),t.stopImmediatePropagation();return}};return window.addEventListener("keydown",t,!0),()=>{window.removeEventListener("keydown",t,!0)}},[a]),(0,T.useEffect)(()=>{let e=document.getElementById(`${lC}-${l}`),t=s.current;if(e&&t&&!function(e,t){let a=e.getBoundingClientRect(),l=t.getBoundingClientRect();return a.top>=l.top&&a.left>=l.left&&a.bottom<=l.bottom&&a.right<=l.right}(e,t)){let a=e.offsetTop-t.scrollTop-e.offsetHeight,l=e.offsetTop+e.offsetHeight-t.scrollTop-t.clientHeight;if(a<0)return void t.scrollTo({top:Math.max(e.offsetTop-10,0)});if(l>0)return void t.scrollTo({top:Math.max(e.offsetTop-t.clientHeight+e.offsetHeight+10,0)})}},[l]),(0,v.jsxs)("div",{className:lf.container,children:[(0,v.jsx)("div",{className:lf.layout,children:(0,v.jsx)("div",{className:lf.resource,children:(0,v.jsx)(l_,{objectFit:"contain",result:a[l],onClose:t,extra:r})})}),(0,v.jsx)(lv,{onClose:t})]})}function lj(e){let{onClose:t}=e,a=la(e=>e.preview);return a?1===a.length?(0,v.jsxs)("div",{className:lf.container,children:[(0,v.jsx)("div",{className:lf.resource,children:(0,v.jsx)(l_,{result:a[0],onClose:t,renderMode:"full"})}),(0,v.jsx)(lv,{onClose:t})]}):(0,v.jsx)(lw,{onClose:t}):null}let ly=e=>{let{onClose:t}=e,a=lx((0,v.jsx)(lj,{onClose:()=>{a(),t&&t()}}))},lS={container:"container-Cga19o",hiddenCarousel:"hiddenCarousel-WYPUci",carousel:"carousel-FE4EUj",image:"image-ERJ4mF",tag:"tag-qRTsMX"},lN=e=>{let{value:t}=e,a=t.value,[l,n]=(0,T.useState)("loading"),[s,r]=(0,T.useState)(a[0]),i=(0,T.useMemo)(()=>"loading"===l?null:"failed"===l?(0,v.jsx)(li,{styles:{width:"100%",height:"100%",aspectRatio:1}}):null,[l]),o=(0,T.useMemo)(()=>"succeed"===l&&a.length>1?(0,v.jsx)(eQ.Z,{className:lS.tag,color:"rgba(40, 40, 40, 0.58)",icon:(0,v.jsx)(a8,{}),children:`${K.t("a_total_of_{placeholder1}_sheets",{placeholder1:a.length},"共{placeholder1}张")}`}):null,[a.length,l]);return(0,v.jsxs)("div",{className:lS.container,children:[(0,v.jsx)(a7.Z,{className:ee()(lS.carousel,"loading"===l?lS.hiddenCarousel:""),indicatorType:"line",onChange:e=>r(a[e]),children:a.map((e,t)=>(0,v.jsx)(ln,{className:lS.image,width:"100%",src:s,onError:()=>{n("failed")},error:null,preview:!1,onClick:()=>{ly({onClose:()=>{la.setState({preview:void 0})}}),la.setState({preview:a.map(e=>({type:ak.Image,url:e}))})},onLoad:()=>{n("succeed")}},t))}),i,o]})},lb={container:"container-Y9jwD6",block:"block-EIK9Ev",label:"label-NzXwIO",value:"value-WeaUY4"},lk=e=>{let{value:t,isOnlyText:a=!1}=e,{value:l,label:n}=t,s=(0,T.useRef)(null),[r]=la((0,ew.N)(e=>[e.cellSize])),i=(0,T.useMemo)(()=>Math.max(Math.ceil(r/24),2),[r]);return 0===l.length||l.every(e=>(0,w.isNil)(e)||(0,w.isString)(e)&&e.trim().length<=0)?(0,v.jsx)(v.Fragment,{children:"-"}):(0,v.jsx)("div",{className:lb.container,children:l.map(e=>(0,v.jsxs)("div",{className:lb.block,ref:s,children:[n?(0,v.jsx)(eY.Z.Ellipsis,{className:lb.label,rows:1,showTooltip:!0,expandable:!0,children:n}):null,(0,v.jsx)(eY.Z.Ellipsis,{className:lb.value,rows:a?i:2,showTooltip:{getPopupContainer:()=>document.body},children:e})]},eL()))})},lT={container:"container-keIy14",carousel:"carousel-kYoG89",video:"video-XdPFGM",tag:"tag-FPi0R8",responsiveBox:"responsiveBox-M8QKPg",loading:"loading-ZMZbEU"},lE=e=>(0,v.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none",viewBox:"0 0 20 20",...e,children:[(0,v.jsx)("path",{fill:"#fff",fillOpacity:.5,d:"M2.034 18.186a2.42 2.42 0 0 1-.722-3.04L7.95 2.005a1.968 1.968 0 0 1 3.565 1.665L5.699 17.195a2.422 2.422 0 0 1-3.665.991"}),(0,v.jsx)("path",{fill:"#fff",fillOpacity:.5,fillRule:"evenodd",d:"m9.031 13.816 3.607 2.486-2.573-4.89zM10.855 9.33l4.244 7.913a1.88 1.88 0 0 0 3.357-1.694L13.073 4.182a3.5 3.5 0 0 1-.204.603z",clipRule:"evenodd"})]}),lA={loadingContainer:"loadingContainer-YO3BJJ"},lM=e=>{let{styles:t,className:a}=e;return(0,v.jsx)("div",{className:ee()(lA.loadingContainer,a),style:t,children:(0,v.jsx)(lE,{className:lA.loading})})},lI=e=>{let{value:t,hoverPlay:a=!1,autoPlay:l=!1}=e,n=t.value,[s,r]=(0,T.useState)("loading"),[i,o]=(0,T.useState)(n[0]),c=(0,T.useMemo)(()=>"loading"===s?(0,v.jsx)("div",{className:lT.responsiveBox,children:(0,v.jsx)(lM,{className:lT.loading})}):"failed"===s?(0,v.jsx)(li,{styles:{width:"100%",height:"100%",aspectRatio:1}}):null,[s]),d=(0,T.useMemo)(()=>"succeed"===s&&n.length>1?(0,v.jsx)(eQ.Z,{className:lT.tag,color:"rgba(40, 40, 40, 0.58)",icon:(0,v.jsx)(a8,{}),children:`${K.t("a_total_of_{placeholder1}_sheets",{placeholder1:n.length},"共{placeholder1}张")}`}):null,[n.length,s]);return(0,v.jsxs)("div",{className:lT.container,children:[(0,v.jsx)(a7.Z,{className:lT.carousel,indicatorType:"line",onChange:e=>o(n[e]),children:n.map((e,t)=>(0,v.jsx)(tZ,{className:lT.video,width:"100%",src:i,onError:()=>{r("failed")},onClick:()=>{ly({onClose:()=>{la.setState({preview:void 0})}}),la.setState({preview:n.map(e=>({type:ak.Video,url:e}))})},showTime:!0,hoverPlay:a,autoPlay:l,controls:!1,onCanPlay:()=>{r("succeed")}},t))}),c,d]})},lL=["image","video","string","number"],lz=e=>{let{cell:t,defaultText:a="-",hoverPlay:l=!1,autoPlay:n=!1}=e,s=(0,T.useMemo)(()=>{let e={image:lN,video:lI,string:lk,number:lk};if(!t||!(t.length>0))return(0,v.jsx)(lk,{value:{label:"",type:"string",value:[a]}});{let a=t.every(e=>["string","number"].includes(e.type))&&1===t.length;return lL.map(s=>{let r=t.filter(e=>e.type===s);return r.length?r.map(t=>{let r=e[s];return(0,v.jsx)(r,{value:t,isOnlyText:a,hoverPlay:l,autoPlay:n},s)}):null})}},[t,a]);return(0,v.jsx)("div",{className:"container-ZdYUMd",children:s})},lR=["image","video","string","number"],lU=e=>{let{value:t,showTooltip:a=!1}=e;return(0,v.jsx)(eY.Z.Ellipsis,{className:"renderText-Zv3irk",rows:1,showTooltip:!!a&&{getPopupContainer:()=>document.body},children:t})},lP=e=>{let{value:t}=e;return(0,v.jsx)("div",{className:"renderImage-1zBRC4",children:(0,v.jsx)(lo,{src:t,style:{borderRadius:4}})})},lO=e=>{let{value:t}=e;return(0,v.jsx)("div",{className:"renderVideo-soZ6w3",children:(0,v.jsx)(tZ,{style:{width:22,height:22,objectFit:"contain",background:"var(--color-fill-1, rgba(0, 0, 0, 0.12))",borderRadius:4},hoverPlay:!0,src:t,controls:!1})})},lZ=e=>{let{value:t,showTooltip:a=!1}=e,l={image:lP,video:lO,string:lU,number:lU};if(!(t.length>0))return(0,v.jsx)(lU,{value:"-"});{let e=[],n=[];if(lR.forEach(a=>{let s=t.filter(e=>e.type===a);s.length&&s.forEach(t=>{let s=l[a];"string"===a||"number"===a?n.push(t):t.value.forEach((t,a)=>{e.push((0,v.jsx)(s,{value:t},a))})})}),n.length>0){let t=n.map(e=>{let t="",{label:a,value:l}=e;return a?t+=`${a}: ${l}`:t+=`${l}`,t}).join("+");e.push((0,v.jsx)(lU,{value:t,showTooltip:a}))}return e}},lD=(0,a4.W8)(e=>{let{selected:t,value:a,onChange:l}=e,n=(0,T.useMemo)(()=>(0,v.jsx)(lz,{cell:a,autoPlay:!0}),[a]);return(0,v.jsx)(aM.Z,{trigger:"hover",title:null,position:"rt",content:n,className:"popoverContainer-ujJGmq",getPopupContainer:()=>document.body,children:(0,v.jsxs)("div",{style:{zIndex:9999,height:32,display:"flex",alignItems:"center",justifyContent:"flex-start",gap:4,color:"#565856",userSelect:"none",cursor:"move"},className:ee()("sortableItem-Fb_UpF","customDragItem"),children:[(0,v.jsx)(a6.Z,{className:"dragIcon-MTDB1W"}),(0,v.jsx)(a2.Z,{onChange:e=>{l&&l(e)},checked:t,className:"checkbox-uVRcE_"}),(0,v.jsx)(lZ,{value:a})]})})}),lF=(0,a4.JN)(e=>{let{list:t,onChange:a,className:l,style:n}=e,s=(e,l)=>{let n=j().cloneDeep(t);n[l].selected=e,a(n)};return(0,v.jsx)("div",{className:ee()("listContainer-NmzFXX",l),style:n,children:t.map((e,t)=>(0,v.jsx)(lD,{onChange:e=>{s(e,t)},id:e.id,selected:e.selected,value:e.value,index:t},`${e.id}-${t}`))})});function lH(e){e&&e.parentNode&&e.parentNode.contains(e)?e.parentNode.removeChild(e):e&&e.remove&&e.remove()}let lB=e=>{let{list:t,className:a,style:l,onChange:n}=e,s=(0,T.useRef)();return(0,T.useEffect)(()=>()=>{s.current&&clearTimeout(s.current)},[]),(0,v.jsx)(lF,{className:a,distance:2,style:l,list:t,onSortEnd:e=>{let{oldIndex:a,newIndex:l}=e,r=j().cloneDeep(t);n((0,a4.Rp)(r,a,l));try{document.querySelectorAll(".ReactSortableHelper").forEach(e=>{lH(e)}),s.current=setTimeout(()=>{document.querySelectorAll(".ReactSortableHelper").forEach(e=>{lH(e)})},200)}catch(e){console.error("Error during cleanup:",e)}},onChange:n})},lV={popoverContainer:"popoverContainer-clE2GU",triggerContainer:"triggerContainer-zm6ol7",text:"text-cXtKuv",icon:"icon-cBj9LU",contentContainer:"contentContainer-y7Wne3",search:"search-vNVZ1A",actions:"actions-YdqPXr",hightLightText:"hightLightText-_NsQ4H",countText:"countText-bHE7WA",clickableText:"clickableText-H99LrE",selectItemContainer:"selectItemContainer-LPJ5nq",selectItemColumn:"selectItemColumn-mtgFbk",selectItemRow:"selectItemRow-GXgPQd",selectItemCheckbox:"selectItemCheckbox-ewX8oJ",rotateAnimation:"rotateAnimation-YND2v5",footer:"footer-XTX6Js",resetText:"resetText-LBHui7",button:"button-exLKdx",rotate180Animation:"rotate180Animation-oa_jJc",accordionContent:"accordionContent-gpRtjy",accordionContentExpanded:"accordionContentExpanded-DVw_mK"},lW=(e,t)=>{let[a,l]=(0,T.useState)(e),[n,s]=(0,T.useState)(""),[r,i]=(0,T.useState)(0),o=(0,T.useMemo)(()=>a.reduce((e,t)=>t.selected?e+t.options.length:e+t.options.filter(e=>e.selected).length,0),[a]),c=(0,T.useMemo)(()=>n?j().cloneDeep(a).filter(e=>(e.options=e.options.filter(e=>-1!==e.id.indexOf(n)),e.options.length>0)):a,[a,n]),d=(0,T.useMemo)(()=>a.every(e=>!e.selected&&e.options.every(e=>!e.selected)),[a]);return(0,T.useEffect)(()=>{0!==c.length&&i(c.reduce((e,t)=>t.expanded?t.options.length>1?e+32+32*t.options.length:e+32:e,0))},[c]),{currentList:a,selectCount:o,searchList:c,searchValue:n,checkNoSelected:d,emptyHeight:r,setEmptyHeight:i,setSearchValue:s,setCurrentList:l,handleOptionsChange:(e,t)=>{let n=j().cloneDeep(a),s=n.find(e=>e.id===t.id);if(!s)return;s.options=s.options.map(t=>{let a=e.find(e=>e.id===t.id);return a||t});let r=e.map(e=>e.id),i=[],o=new Set(r),c=0;for(let t=0;t<s.options.length;t++){let a=s.options[t];o.has(a.id)?(i.push(e[c]),c++):i.push(a)}s.options=i,i.every(e=>e.selected)?s.selected=!0:s.selected=!1,l(n)},handleSelectedChange:(e,t)=>{l(j().cloneDeep(a).map(a=>(a.id===t.id&&(a.options=a.options.map(a=>(t.options.find(e=>e.id===a.id)&&(a.selected=e),a)),a.selected=a.options.every(e=>e.selected)),a)))},handleSelectAll:()=>{let e=j().cloneDeep(a);e.forEach(e=>{e.selected=!0,e.options=e.options.map(e=>(e.selected=!0,e))}),l(e)},handleClearAll:()=>{let e=j().cloneDeep(a);e.forEach(e=>{e.selected=!1,e.options=e.options.map(e=>(e.selected=!1,e))}),l(e)},handleToggleExpand:e=>{let t=j().cloneDeep(a),n=t.find(t=>t.id===e.id);n&&(n.expanded=!n.expanded,l(t))},handleReset:()=>{l(t),s("")}}},l$={container:"container-O3Wjs0",emptyImg:"emptyImg-lNhUXn",emptyText:"emptyText-TwI9Av",loading:"loading-RFl1fZ",loadingText:"loadingText-KA5khP"},lG=e=>{let{text:t=K.t("no_data_yet",{},"暂无数据"),loading:a=!1,style:l={},extra:n=null}=e;return(0,v.jsxs)("div",{className:l$.container,style:l,children:[a?(0,v.jsxs)("div",{className:l$.loading,children:[(0,v.jsx)(aN.Z,{}),(0,v.jsx)("span",{className:l$.loadingText,children:K.t("loading_please_wait~",{},"加载中，请稍后～")})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("img",{className:l$.emptyImg,src:t3,alt:""}),(0,v.jsx)("span",{className:l$.emptyText,children:t})]}),n]})},lK=e=>{let{label:t,list:a,originList:l,onFilter:n}=e,s=(0,T.useRef)(null),[r,i]=(0,T.useState)(!1),[o,c]=(0,T.useState)(0),{currentList:d,searchList:u,searchValue:h,selectCount:p,checkNoSelected:m,emptyHeight:g,setCurrentList:_,setSearchValue:f,handleOptionsChange:x,handleSelectedChange:C,handleSelectAll:w,handleClearAll:j,handleToggleExpand:y,handleReset:S}=lW(a,l);(0,T.useEffect)(()=>{_(a)},[a,_]);let N=(0,T.useMemo)(()=>Math.min(o-138,Math.max(g,275)),[g,o]),b=(0,T.useMemo)(()=>(0,v.jsxs)("div",{className:lV.contentContainer,style:{maxHeight:o},children:[(0,v.jsx)(eX.Z,{value:h,onChange:f,className:lV.search,placeholder:K.t("please_enter_a_data_item_name",{},"搜索数据项"),suffix:(0,v.jsx)(a3.Z,{}),allowClear:!0}),(0,v.jsxs)("div",{className:lV.actions,children:[(0,v.jsxs)(V.Z,{size:4,children:[(0,v.jsx)("span",{className:lV.hightLightText,children:K.t("has_selected",{},"已选")}),(0,v.jsx)("span",{className:ee()(lV.hightLightText,lV.countText),children:p}),(0,v.jsx)("span",{className:lV.hightLightText,children:K.t("items",{},"项")})]}),(0,v.jsx)("span",{className:lV.clickableText,onClick:w,children:K.t("all_choose",{},"全选")}),(0,v.jsx)("span",{className:lV.clickableText,onClick:j,children:K.t("clear_all",{},"清空")})]}),(0,v.jsx)("div",{className:lV.selectItemContainer,children:u.length>0?u.map(e=>{var t,a,l;let{id:n,selected:s,options:r,label:i,expanded:o}=e;return r.length>1?(0,v.jsxs)("div",{className:lV.selectItemColumn,children:[(0,v.jsxs)(W,{align:"center",justify:"flex-start",gap:4,style:{width:"100%"},children:[(0,v.jsx)(a5.Z,{className:o?lV.rotateAnimation:"",style:{color:"#DDDEDD",cursor:"pointer"},onClick:()=>y(e)}),(0,v.jsx)(a2.Z,{checked:s,className:lV.selectItemCheckbox,onChange:t=>{C(t,e)}}),(0,v.jsx)(lZ,{showTooltip:!0,value:[{label:"",type:"string",value:[i]}]})]}),(0,v.jsx)(lB,{list:r,className:ee()(lV.accordionContent,o?lV.accordionContentExpanded:""),style:{height:o?32*r.length:0},onChange:t=>{x(t,e)}},n)]},n):(0,v.jsxs)("div",{className:lV.selectItemRow,children:[(0,v.jsx)(a2.Z,{checked:(null==(a=u[0].options)||null==(t=a[0])?void 0:t.selected)??!1,className:lV.selectItemCheckbox,onChange:t=>{C(t,e)},style:{padding:"0px 8px 0px 0px"}}),(0,v.jsx)(lZ,{showTooltip:!0,value:(null==(l=r[0])?void 0:l.value)??""})]},n)}):(0,v.jsx)(lG,{style:{height:N},text:K.t("no_search_results_yet__try_searching_for_other_content",{},"暂无搜索结果，试试搜索其他内容")})}),(0,v.jsxs)("div",{className:lV.footer,children:[(0,v.jsx)("span",{className:lV.resetText,onClick:S,children:K.t("reset_to_default",{},"恢复预设")}),(0,v.jsxs)(V.Z,{size:8,children:[(0,v.jsx)(E.Z,{status:"default",style:{borderRadius:100},className:lV.button,onClick:()=>{i(!1)},children:K.t("cancel",{},"取消")}),(0,v.jsx)(E.Z,{type:"primary",style:{borderRadius:100},className:lV.button,onClick:()=>{n(d)},disabled:m,children:K.t("confirm",{},"确定")})]})]})]}),[m,d,N,j,x,S,w,C,y,o,n,u,h,p,f]);return(0,T.useEffect)(()=>{let e=0,t=()=>{if(s.current){let e=s.current.getBoundingClientRect();c(window.innerHeight-e.top-e.height-24-45)}e=window.requestAnimationFrame(t)};return e=window.requestAnimationFrame(t),()=>{window.cancelAnimationFrame(e)}},[]),(0,v.jsx)(aM.Z,{trigger:"click",title:null,position:"bl",popupVisible:r,onVisibleChange:i,content:b,className:lV.popoverContainer,getPopupContainer:()=>s.current?s.current.parentElement:document.body,children:(0,v.jsxs)("div",{className:lV.triggerContainer,ref:s,children:[(0,v.jsx)("span",{className:lV.text,children:t}),(0,v.jsx)(aL.Z,{className:ee()(lV.icon,r?lV.rotate180Animation:"")})]})})};function lq(){let{setState:e}=aP,[t,a,l,n,s,r,i,o,c,d]=aP((0,ew.N)(e=>[e.taskId,e.name,e.tableConfigOptions,e.selectedConfigOptionIndex,e.customColumns,e.customRows,e.originColumns,e.originRows,e.customColumnsChanged,e.customRowsChanged])),u=(0,T.useMemo)(()=>aO(l),[l]),h=(0,T.useMemo)(()=>(0,w.isNumber)(n)?aD(l[n]):void 0,[l,n]);return(0,v.jsxs)(W,{className:"container-ton2c_",justify:"space-between",children:[(0,v.jsxs)("div",{className:"config-f4HcJn",children:[(0,v.jsx)(az,{options:u,value:h,onSelect:(t,a)=>{e({selectedConfigOptionIndex:a})},shouldChangeConfirm:c||d}),(0,v.jsx)(lK,{label:K.t("custom_rows",{},"自定义行"),list:r,onFilter:e=>{aP.setState({customRows:e})},originList:o}),(0,v.jsx)(lK,{label:K.t("custom_columns",{},"自定义列"),list:s,onFilter:e=>{aP.setState({customColumns:e})},originList:i})]}),(0,v.jsx)(tq,{className:"input-aIEvTN",fontSize:14,maxWidth:240,maxLength:50,value:a,onChange:t=>{e({name:(t||"").trim()})}}),(0,v.jsxs)(W,{align:"center",gap:8,children:[(0,v.jsx)(aW,{}),(0,v.jsx)(aA.Z,{type:"vertical"}),(0,v.jsx)(a1,{taskId:t,size:"large"})]})]})}let lY=e=>{var t,a;let{selectedConfigOptionIndex:l,tableConfigOptions:n}=aP.getState();if(!e||0===e.length||void 0===l)return[];let s=aO(n),r=e.filter(e=>{var t;return null==(t=e.extra)?void 0:t.isParams}),i=e.filter(e=>{var t;return!(null==(t=e.extra)?void 0:t.isParams)});return[...r.map(e=>{var t,a;return{id:e.dataIndex,label:null==(t=e.extra)?void 0:t.label,selected:!0,expanded:!0,options:[{id:e.dataIndex,selected:!0,value:null==(a=e.extra)?void 0:a.valueList}]}}),{label:null==(t=s[l])?void 0:t.value,id:null==(a=s[l])?void 0:a.value,selected:!0,expanded:!0,options:i.map(e=>{var t;return{id:e.dataIndex,selected:!0,value:null==(t=e.extra)?void 0:t.valueList}})}]},lX=(e,t)=>{var a;let l=(null==t||null==(a=t.filter(e=>{var t;return null==(t=e.extra)?void 0:t.isParams}))?void 0:a.map(e=>e.dataIndex))||[];return[{id:"row_data",label:K.t("row_data",{},"行数据"),selected:!0,expanded:!0,options:e.map(e=>{let t=[];return l.forEach(a=>{a&&t.push(...e[a])}),{id:e.id,filterKeys:e.custom_params_config_filters,selected:!0,value:t}})}]},lJ=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return`#${e.nodeId}:${e.internal_name}${""!==t?`=${t}`:""}`},lQ=e=>e.split("/").pop()??"",l0=e=>{let t=e.toLowerCase();return eF.test(t)?"video":eH.test(t)?"image":"string"},l1=(e,t,a)=>["image","video"].includes(e)&&a?a:t,l2=(e,t)=>{let a=0,l=e.length-1;for(;a<=l;){let n=Math.floor((a+l)/2);if(e[n]===t)return n;e[n]<t?a=n+1:l=n-1}return a},l3=()=>{let[e,t,a,l]=aP((0,ew.N)(e=>[e.detail,e.tableConfigOptions,e.selectedConfigOptionIndex,e.previewPercent])),n=(l-50)*200/100+100;return(0,T.useMemo)(()=>{let l=[],s=[];if(void 0===a)return l;t.forEach((e,t)=>{if(t!==a)if("group"===e.type){let t=Math.max(...e.values.map(e=>e.values.length)),a=l2(s,t);s.splice(a,0,t);let r=e.values.map(e=>lJ(e)).join("+"),i=[{type:"string",value:[r],label:""}];l.splice(a,0,{title:(0,v.jsx)(lz,{cell:i}),extra:{valueList:i,isParams:!0,label:r},dataIndex:r,fixed:"left",width:n,render:(e,t)=>(0,v.jsx)(lz,{cell:e,defaultText:t.batchTaskName||"-"})})}else{let t=e.values.length,a=l2(s,t);s.splice(a,0,t);let r=lJ(e),i=[{type:"string",value:[r],label:""}];l.splice(a,0,{title:(0,v.jsx)(lz,{cell:i}),dataIndex:r,extra:{valueList:i,isParams:!0,label:r},fixed:"left",width:n,render:(e,t)=>(0,v.jsx)(lz,{cell:e,defaultText:t.batchTaskName||"-"})})}});let r=t[a];if("group"===r.type){let t=Math.max(...r.values.map(e=>e.values.length)),a=Array.from({length:r.values.length});for(let s=0;s<t;s++){let t=a.map((e,t)=>{let a=r.values[t];return lJ(a,String(a.values[s]))}).join("+"),i=a.map((t,a)=>{let l=r.values[a],n=String(l.values[s]),i=lQ(n),o=(null==e?void 0:e.resourcesMap[i])??"",c=l0(i);return{type:c,value:[l1(c,n,o)],label:lJ(l)}});l.push({title:(0,v.jsx)(lz,{cell:i}),extra:{valueList:i,isParams:!1,label:t},width:n,dataIndex:t,render:e=>(0,v.jsx)(lz,{cell:e})})}}else r.values.forEach(t=>{let a=String(t),s=lQ(a),i=(null==e?void 0:e.resourcesMap[s])??"",o=l0(s),c=[{type:o,value:[l1(o,a,i)],label:lJ(r)}],d=lJ(r,a);l.push({title:(0,v.jsx)(lz,{cell:c}),extra:{valueList:c,isParams:!1,label:d},width:n,dataIndex:d,render:e=>(0,v.jsx)(lz,{cell:e})})});return l},[n,null==e?void 0:e.resourcesMap,a,t])},l5=e=>{if(!e)return{resultMap:{},configMap:{}};let t={},a={};return e.forEach(e=>{try{let l=JSON.parse(e.ParamsConfig),n="",s=l.filter(e=>"system"!==e.category),r=[];s.forEach((e,t)=>{let a=t!==s.length-1?"+":"",l="";if("group"===e.type){let{values:t}=e;t.forEach((e,a)=>{let s=a!==t.length-1?"+":"",r=lJ(e,e.value);l+=`${r}${s}`,n+=`${r}${s}`})}else{let t=lJ(e,e.value);l=t,n+=`${t}${a}`}r.push(l)}),t[n]=e,a[n]=r}catch(e){console.error(e)}}),{resultMap:t,configMap:a}},l4=e=>{let t=[];return[ak.Image,ak.Text,ak.Video].forEach(a=>{let l=e.list.filter(e=>e.type===a);l.length>0&&t.push({label:"",type:l6(a),value:l.map(e=>l7(e))})}),t},l6=e=>e===ak.Image?"image":e===ak.Video?"video":e===ak.Text?"string":"string",l7=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a="";try{a=e.type===ak.Image||e.type===ak.Video?t?e.url:aY(e.url):e.type===ak.Text&&e.value?JSON.parse(e.value).join(","):e.value??""}catch(e){console.error(e),a=""}return a},l8="custom_params_config_filters",l9=()=>{let[e,t,a]=aP((0,ew.N)(e=>[e.detail,e.tableConfigOptions,e.selectedConfigOptionIndex]));return(0,T.useMemo)(()=>{if(!e||void 0===a)return[];let l=[];t.forEach((t,n)=>{if(n!==a)if(0===l.length)l.push(...ne(t,e));else{let a=ne(t,e),n=[];l.forEach(e=>{a.forEach(t=>{n.push({...e,...t,id:`${e.id}+${t.id}`,[l8]:[...e[l8],...t[l8]]})})}),l=n}});let n=t[a],s=[];return s="group"===n.type?Array.from({length:Math.max(...n.values.map(e=>e.values.length))}).map((e,t)=>n.values.map(e=>lJ(e,String(e.values[t]))).join("+")):n.values.map(e=>lJ(n,String(e))),!l.length&&e.results&&e.results.length>0&&(l=[{id:"group"===n.type?n.values.map(e=>lJ(e)).join("+"):lJ(n)}]),l=nt(l,s,e)},[e,t,a])},ne=(e,t)=>{let a=[];if("group"===e.type){let l=Math.max(...e.values.map(e=>e.values.length)),n=e.values.map(e=>lJ(e)).join("+");for(let s=0;s<l;s++){let l=e.values.map(e=>lJ(e,String(e.values[s]))).join("+");a.push({id:l,[l8]:[l],[n]:Array.from({length:e.values.length}).map((a,l)=>{let n=e.values[l],r=String(n.values[s]),i=lQ(r),o=t.resourcesMap[i]??"",c=l0(i);return{type:c,value:[l1(c,r,o)],label:lJ(n)}})})}}else e.values.forEach(l=>{let n=String(l),s=lJ(e),r=lQ(n),i=t.resourcesMap[r]??"",o=l0(r),c=lJ(e,n);a.push({id:c,[l8]:[c],[s]:[{type:o,value:[l1(o,l,i)],label:lJ(e)}]})});return a},nt=(e,t,a)=>{let{resultMap:l,configMap:n}=l5(a.results);return e.map(e=>(t.forEach(t=>{let a=(e[l8]??[]).concat(t).filter(e=>e),s=Object.keys(n).find(e=>a.every(t=>n[e].includes(t)));if(s){let a=l[s];e[t]=l4(a)}}),e))};function na(e){let[t,a]=(0,T.useState)(e);return(0,T.useEffect)(()=>{let t=()=>{a(e())};return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),t}let nl=(e,t)=>e.length===t.length&&e.every((e,a)=>{let l=t[a],n=e.dataIndex?"dataIndex":"id";return e[n]===l[n]}),nn=e=>{let{data:t,cellSize:a,columnList:l,renderRect:n}=e,s=(0,T.useMemo)(()=>l.length,[l]),r=(0,T.useRef)(null),[i,o]=(0,T.useState)(0);(0,T.useEffect)(()=>{la.setState({cellSize:a})},[a]);let c=(e,t)=>({onClick:()=>{let a=e instanceof Array;la.setState({currentRow:a?-1:t})},onMouseEnter:e=>{var t;let a=null==(t=e.target)?void 0:t.closest("tr");if(!a)return void console.error("init video row autoplay failed");a.querySelectorAll("video").forEach(e=>{e.currentTime=0,e.loop=!0,e.play()})},onMouseLeave:e=>{var t;let a=null==(t=e.target)?void 0:t.closest("tr");if(!a)return void console.error("init video row autoplay failed");a.querySelectorAll("video").forEach(e=>{e.loop=!1,e.pause(),e.currentTime=0})}});(0,T.useEffect)(()=>{la.setState({data:t,columnList:l})},[l,t]);let d=(0,T.useMemo)(()=>l.map((e,t)=>({...e,onCell:(a,l)=>({...(null==e?void 0:e.onCell)?e.onCell(a,l):{},onClick:n=>{var s,r,i;(null==e||null==(s=e.onCell)?void 0:s.call(e,a,l).onClick)&&(null==(r=(i=e.onCell(a,l)).onClick)||r.call(i,n)),la.setState({currentCol:t})}})})),[l]);return(0,T.useEffect)(()=>{var e;let t=r.current;if(!t)return;let a=null==(e=t.getRootDomElement())?void 0:e.querySelector(".arco-table-tr");if(!a)return;let l=new MutationObserver(()=>{o(a.offsetHeight)});return l.observe(a,{attributes:!0,childList:!0,subtree:!0}),o(a.offsetHeight),()=>{l.disconnect()}},[]),(0,T.useMemo)(()=>(0,v.jsx)(tA.Z,{ref:r,className:"table-kCqfRh",rowKey:"id",columns:d,data:t,style:{width:a*s>window.innerWidth-48?"100%":"min-content"},scroll:{x:!0,y:n.height-i-2},border:{wrapper:!0,cell:!0},noDataElement:K.t("no_data_yet",{},"暂无数据"),pagination:!1,onHeaderRow:c,onRow:c},eL()),[a,s,d,t,i,n.height])},ns=e=>{let t=new Map,a=new Map,l=(e,t)=>t>0?`${e}-${t}`:e;return{get:t=>{let n=a.get(t)||0;return n>0?(a.set(t,n+1),e.get(l(t,n))):(a.set(t,1),e.get(t))},set:(a,n)=>{let s=t.get(a)||0;s>0?(e.set(l(a,s),n),t.set(a,s+1)):(e.set(a,n),t.set(a,1))}}},nr=(e,t)=>{let a=e.length,l=a-1,n=Array(a);for(let s=0;s<a;s++){let a=e[s],r=t(a.dataIndex||"");if(!a.dataIndex||!r){n[s]=a;continue}n[r.order??l--]=a}return n.filter(Boolean)},ni=(e,t)=>{let a=e.length,l=a-1,n=Array(a);for(let s=0;s<a;s++){let a=e[s],r=t(a.id||"");if(!a.id||!r){n[s]=a;continue}n[r.order??l--]=a}return n.filter(Boolean)},no=()=>{let e=na(()=>window.innerHeight-60-76),[t,a,l]=aP((0,ew.N)(e=>[e.previewPercent,e.customColumns,e.customRows])),n=l9(),s=l3();(0,T.useEffect)(()=>{let e=lX(n,s),t=lY(s);aP.setState({customRows:e,originRows:e,customColumns:t,originColumns:t})},[n,s]);let r=(0,T.useMemo)(()=>{let e=new Map,t=1,{set:l}=ns(e);a.forEach(e=>{var a,n;(null==(a=e.options)?void 0:a.length)>1?null==(n=e.options)||n.forEach(e=>{l(e.id,{...e,order:t++})}):l(e.id,{...e,order:t++})});let{get:n}=ns(e),{get:r}=ns(e);return nr(s,r).filter(e=>{let t=n(e.dataIndex||"");return(null==t?void 0:t.selected)!==!1})},[s,a]),i=(0,T.useMemo)(()=>{let e=new Map,t=0,{set:a}=ns(e);l.forEach(e=>{var l;a(e.id,{...e,order:t++}),null==(l=e.options)||l.forEach(e=>{a(e.id,{...e,order:t++})})});let{get:s}=ns(e),{get:r}=ns(e);return ni(n,r).filter(e=>{let t=s(e.id);return(null==t?void 0:t.selected)!==!1})},[n,l]);return(0,T.useEffect)(()=>{aP.setState({customColumnsChanged:!nl(s,r),customRowsChanged:!nl(n,i)})},[r,i,n,s]),(0,v.jsx)("div",{className:"content-uIOfGs",style:{height:e},children:(0,v.jsx)(nn,{data:i,cellSize:(t-50)*200/100+100,columnList:r,cellValue2UrlMap:void 0,renderRect:{height:e}})})},nc={container:"container-Ew_kGn",empty:"empty-UXcBc5",emptyIcon:"emptyIcon-zgJsVo",emptyText:"emptyText-wWxvbQ",spinContainer:"spinContainer-dqrdpP",spinIcon:"spinIcon-rZirSy",drawerContainer:"drawerContainer-QUjt3c"},nd=e=>{let t=new URL(window.location.href);e.forEach(e=>t.searchParams.delete(e)),window.history.replaceState({},"",t.toString())},nu=e=>(0,v.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:28,height:28,fill:"none",viewBox:"0 0 28 28",...e,children:[(0,v.jsx)("g",{filter:"url(#loading_svg__a)",children:(0,v.jsx)("path",{fill:"url(#loading_svg__b)",fillRule:"evenodd",d:"M14 8.667A5.333 5.333 0 1 0 19.333 14 1.333 1.333 0 0 1 22 14a8 8 0 1 1-8-8 1.333 1.333 0 1 1 0 2.667",clipRule:"evenodd"})}),(0,v.jsxs)("defs",{children:[(0,v.jsxs)("linearGradient",{id:"loading_svg__b",x1:6,x2:22.628,y1:9.556,y2:12.291,gradientUnits:"userSpaceOnUse",children:[(0,v.jsx)("stop",{stopColor:"#fff"}),(0,v.jsx)("stop",{offset:.276,stopColor:"#CDD8E7"}),(0,v.jsx)("stop",{offset:.475,stopColor:"#BAC9DF"}),(0,v.jsx)("stop",{offset:.703,stopColor:"#D4D5D6"}),(0,v.jsx)("stop",{offset:1,stopColor:"#A0B3CA"})]}),(0,v.jsxs)("filter",{id:"loading_svg__a",width:26.667,height:26.667,x:.667,y:.733,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,v.jsx)("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),(0,v.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,v.jsx)("feOffset",{dy:.067}),(0,v.jsx)("feGaussianBlur",{stdDeviation:2.667}),(0,v.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,v.jsx)("feColorMatrix",{values:"0 0 0 0 0.121569 0 0 0 0 0.258824 0 0 0 0 0.4 0 0 0 0.04 0"}),(0,v.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1267_335"}),(0,v.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_1267_335",result:"shape"})]})]})]});function nh(){let e=na(()=>window.innerHeight-60-24),t=aP((0,ew.N)(e=>e.loading)),{setState:a}=aP,[l,n,s,r]=aP((0,ew.N)(e=>[e.taskId,e.detail,e.tableConfigOptions,e.selectedConfigOptionIndex]));(0,T.useEffect)(()=>{(async()=>{a({loading:!0});try{let e=await aT(l);Object.keys((null==e?void 0:e.resourcesMap)||{}).forEach(t=>{e.resourcesMap[t]=aX(e.resourcesMap[t])}),a(t=>({detail:e,selectedConfigOptionIndex:(0,w.isNumber)(r)&&r>=0&&r<s.length?t.selectedConfigOptionIndex:function(e){let t=e.filter(e=>!aF(e)).findIndex(e=>aZ(e)?"image"===e.internal_name:e.values.some(e=>"image"===e.internal_name));return t>-1?t:0}(s)}))}finally{a({loading:!1})}})()},[l]);let i=(0,T.useMemo)(()=>n&&(0,w.isNil)(n.results)?(0,v.jsxs)(W,{className:nc.empty,direction:"column",justify:"center",align:"center",children:[(0,v.jsx)(aE,{className:nc.emptyIcon}),(0,v.jsx)("div",{className:nc.emptyText,children:K.t("no_results_generated",{},"无生成结果")})]}):(0,v.jsx)(no,{}),[n]);return(0,v.jsxs)(W,{className:nc.container,style:{height:e},direction:"column",children:[(0,v.jsx)(lq,{}),t?(0,v.jsx)(aN.Z,{className:nc.spinContainer,tip:K.t("data_is_being_prepared__please_wait___",{},"正在准备数据，请稍后..."),icon:(0,v.jsx)(nu,{className:nc.spinIcon})}):i]})}let np=()=>{let[e]=aP((0,ew.N)(e=>[e.visible]));return(0,v.jsx)(ab.Z,{width:"100vw",height:"calc(100vh - 60px)",title:null,footer:null,visible:e,placement:"bottom",onOk:()=>{aP.setState({visible:!1})},className:nc.drawerContainer,onCancel:()=>{aP.setState({visible:!1}),nd(["shareId"])},mountOnEnter:!0,unmountOnExit:!0,autoFocus:!1,children:(0,v.jsx)(nh,{})})},nm=e=>{let[t]=F((0,ew.N)(e=>[e.uiConfig])),[a]=eR((0,ew.N)(e=>[e.checkWorkflowLoading]));return(0,v.jsx)(v.Fragment,{children:t.showCreateTask?(0,v.jsx)(E.Z,{type:"primary",onClick:ay,loading:a,style:e.style??{},children:a?K.t("checking_workflow",{},"正在检测工作流"):O.getText(I.CREATE_BATCH_TASK)}):null})},ng={isError:!1,filted:{},currentPage:1,pageSize:10,total:0,taskList:[],loading:!0,stopPollingList:!1,taskStatusFilter:[]},n_=(0,M.U)(e=>({...ng,reset(){e(ng)},changePagination(t,a,l){let n=[],{status:s}=l;null==s||s.forEach(e=>{n.push(...{[aG.Waiting]:["waiting"],[aG.Running]:["running"],[aG.PartiallySucceeded]:["partial-success"],[aG.Succeed]:["success"],[aG.Failed]:["failed"],[aG.Canceled]:["canceled"],[aG.Dirty]:["dirty"],[aG.Completed]:["completed"]}[e])}),e({currentPage:t.current||1,pageSize:t.pageSize||10,filted:{status:[...new Set(n)]}})}}));function nf(e){let{className:t}=e,[a,l]=F((0,ew.N)(e=>[e.uiConfig,e.task])),[n]=n_((0,ew.N)(e=>[e.taskName])),s=(0,w.debounce)(e=>{n_.setState({taskName:e,currentPage:1})},500);return(0,v.jsxs)(W,{className:ee()("table-header",t),justify:"space-between",align:"center",children:[(0,v.jsx)("span",{className:"table-header-title",children:a.showTitle?O.getText(I.TASK_LIST_TITLE):null}),(0,v.jsxs)(V.Z,{size:8,children:[(0,v.jsx)(eX.Z,{className:"table-header-name-input",placeholder:O.getText(I.TASK_LIST_SEARCH_PLACEHOLDER),suffix:(0,v.jsx)(a3.Z,{}),defaultValue:n,onChange:s,allowClear:!0}),(0,v.jsx)(E.Z,{type:"secondary",size:"default",style:{height:36},onClick:()=>window.open(l.newGuideHelpLink||eE),children:O.getText(I.NEW_GUIDER_HELP)}),(0,v.jsx)(nm,{})]})]})}let nx=e=>{let{filterList:t,value:a,onOk:l,onReset:n}=e,[s,r]=(0,T.useState)(()=>a);return(0,v.jsxs)("div",{className:"container-fuGBxG",style:{width:O.getLanguage()===L.ZH?124:180},children:[(0,v.jsx)(a2.Z.Group,{defaultValue:a,className:"checkbox-pZAE0x",value:s,options:t,onChange:r}),(0,v.jsxs)(V.Z,{className:"operator-ODdVYn",children:[(0,v.jsx)(E.Z,{size:"mini",status:"default",onClick:()=>n&&n(),children:K.t("reset",{},"重置")}),(0,v.jsx)(E.Z,{size:"mini",type:"primary",onClick:()=>l&&l(s),children:K.t("ok",{},"确定")})]})]})},nv=e=>(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:12,height:12,fill:"none",viewBox:"0 0 12 12",...e,children:(0,v.jsx)("path",{stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",d:"M1.5 4.5h6.75a2.25 2.25 0 0 1 0 4.5H6M1.5 4.5l2-2m-2 2 2 2"})}),nC=e=>(0,v.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:12,height:12,fill:"none",viewBox:"0 0 12 12",...e,children:[(0,v.jsx)("g",{clipPath:"url(#copy_svg__a)",children:(0,v.jsx)("path",{stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4V2.6c0-.56 0-.84.109-1.054a1 1 0 0 1 .437-.437C4.76 1 5.04 1 5.6 1h3.8c.56 0 .84 0 1.054.109a1 1 0 0 1 .437.437C11 1.76 11 2.04 11 2.6v3.8c0 .56 0 .84-.109 1.054a1 1 0 0 1-.437.437C10.24 8 9.96 8 9.4 8H8m-5.4 3h3.8c.56 0 .84 0 1.054-.109a1 1 0 0 0 .437-.437C8 10.24 8 9.96 8 9.4V5.6c0-.56 0-.84-.109-1.054a1 1 0 0 0-.437-.437C7.24 4 6.96 4 6.4 4H2.6c-.56 0-.84 0-1.054.109a1 1 0 0 0-.437.437C1 4.76 1 5.04 1 5.6v3.8c0 .56 0 .84.109 1.054a1 1 0 0 0 .437.437C1.76 11 2.04 11 2.6 11"})}),(0,v.jsx)("defs",{children:(0,v.jsx)("clipPath",{id:"copy_svg__a",children:(0,v.jsx)("path",{fill:"#fff",d:"M0 0h12v12H0z"})})})]}),nw=e=>(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:12,height:12,fill:"none",viewBox:"0 0 12 12",...e,children:(0,v.jsx)("path",{stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",d:"M1.5 4.5h9m-6 0v6m-.6-9h4.2c.84 0 1.26 0 1.581.163a1.5 1.5 0 0 1 .656.656c.163.32.163.74.163 1.581v4.2c0 .84 0 1.26-.164 1.581a1.5 1.5 0 0 1-.655.656c-.32.163-.74.163-1.581.163H3.9c-.84 0-1.26 0-1.581-.164a1.5 1.5 0 0 1-.656-.655C1.5 9.361 1.5 8.941 1.5 8.1V3.9c0-.84 0-1.26.163-1.581a1.5 1.5 0 0 1 .656-.656c.32-.163.74-.163 1.581-.163"})}),nj=e=>(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:12,height:13,fill:"none",viewBox:"0 0 12 13",...e,children:(0,v.jsx)("path",{fill:"#fff",fillOpacity:.85,fillRule:"evenodd",d:"M4 2a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3A.5.5 0 0 1 4 2M2.496 3H1.5a.5.5 0 0 0 0 1h.532l.321 4.813c.025.377.046.69.083.944.04.265.101.507.23.733a2 2 0 0 0 .865.81c.234.113.48.159.746.18.257.02.57.02.948.02h1.55c.378 0 .691 0 .948-.02.267-.021.512-.067.746-.18a2 2 0 0 0 .865-.81c.129-.226.19-.468.23-.733.037-.254.058-.567.083-.944L9.967 4h.533a.5.5 0 0 0 0-1H2.496m6.47 1H3.034l.316 4.726c.026.403.045.676.076.886.03.205.067.31.108.383a1 1 0 0 0 .433.405c.076.037.183.066.39.083.212.017.485.017.888.017h1.51c.403 0 .676 0 .889-.017.206-.017.313-.046.389-.083a1 1 0 0 0 .433-.405c.041-.074.078-.178.108-.383.031-.21.05-.483.076-.886zM5 5.25a.5.5 0 0 1 .5.5v2.5a.5.5 0 0 1-1 0v-2.5a.5.5 0 0 1 .5-.5m2 0a.5.5 0 0 1 .5.5v2.5a.5.5 0 0 1-1 0v-2.5a.5.5 0 0 1 .5-.5",clipRule:"evenodd"})});function ny(e,t){var a,l;let{nodeId:n,internal_name:s}=t;return!(!n||!s||(0,w.isUndefined)(null==e||null==(l=e[n])||null==(a=l.inputs)?void 0:a[s]))}async function nS(e){var t;let a;if(!await av())return!1;for(let l of(a=(null==(t=window.app)?void 0:t.ue_modified_prompt)?(await window.app.ue_modified_prompt()).output:(await window.app.graphToPrompt()).output,e)){let{type:e,internal_name:t}=l;if("group"===e){if(!l.values.every(e=>ny(a,e)))return nN(),!1}else{if("filename_prefix"===t)continue;if(!ny(a,l))return nN(),!1}}return!0}let nN=()=>{tt.Z.error({content:K.t("this_task_is_not_compatible_with_the_current_workflow_and_cannot_perform_a_copy_",{},"此任务与当前工作流不兼容，无法执行复制操作"),duration:3e3})};function nb(e){let{task:t,refresh:a}=e,[l]=F((0,ew.N)(e=>[e.uiConfig])),n=t.status,s=function(e){let{changeType:t}=B(),{setTask:a,openDrawer:l}=aP(),{copy:n}=eR(),[s,r]=(0,T.useState)(!1),[i,o]=(0,T.useState)(!1);return(0,T.useMemo)(()=>{let{id:c,name:d,status:u}=e;return{async cancel(){try{o(!0),ef(),await ae(c),tt.Z.success(K.t("cancel_task_successfully",{},"取消任务成功"))}catch(e){tt.Z.error(K.t("cancel_task_failed",{},"取消任务失败"))}finally{o(!1)}},async delete(){try{r(!0),[aG.Running,aG.Waiting].includes(u)&&await ae(c),await at(c),tt.Z.success(K.t("delete_task_successfully",{},"删除任务成功"))}catch(e){tt.Z.error(K.t("delete_task_failed",{},"删除任务失败"))}finally{r(!1)}},restart(){tt.Z.error(K.t("pending",{},"待处理"))},diffResult(){eg(),a(c,d,e.params_config),l()},async copy(){e_();let a=aR(e.params_config,[]);await nS(a)&&(n({taskName:e.name,paramsConfig:a}),t(Z.Creator),tt.Z.success({content:K.t("parameter_copied_successfully",{},"参数复制成功"),duration:2e3}))},remove(){tt.Z.error(K.t("pending",{},"待处理"))},deleteLoading:s,cancelLoading:i}},[e,s,i])}(t),[r,i,o]=[];switch(o=!0,n){case aG.Waiting:case aG.Running:r=!0,i=!0;break;case aG.Canceled:case aG.Succeed:case aG.PartiallySucceeded:case aG.Dirty:i=!0}let c=(0,T.useMemo)(()=>l.showCancel&&r,[r,l.showCancel]),d=(0,T.useMemo)(()=>l.showCopy&&o&&t.scene!==tH.LocalTask,[o,t.scene,l.showCopy]);return(0,v.jsxs)(W,{align:"center",gap:8,children:[c?(0,v.jsx)(ej.Z,{title:K.t("confirm_to_cancel_the_task?",{},"确认取消任务吗？"),onOk:async()=>{await s.cancel(),a()},children:(0,v.jsx)(aq,{loading:s.cancelLoading,icon:(0,v.jsx)(nv,{}),tooltip:O.getText(I.CANCEL_TASK)})}):null,(0,v.jsx)(a1,{taskId:t.id,statusInfo:{status:t.status,packageStatus:t.package_info.status}}),i?(0,v.jsx)(aq,{icon:(0,v.jsx)(nw,{}),tooltip:O.getText(I.RESULT_DIFF_CHECK),onClick:s.diffResult}):null,d?(0,v.jsx)(aq,{icon:(0,v.jsx)(nC,{}),tooltip:O.getText(I.COPY_PARAMS),onClick:s.copy}):null,(0,v.jsx)(ej.Z,{title:K.t("confirm_to_delete_the_task",{},"确认删除任务吗？"),onOk:async()=>{await s.delete(),a()},children:(0,v.jsx)(aq,{icon:(0,v.jsx)(nj,{}),loading:s.deleteLoading,tooltip:K.t("delete_task",{},"删除任务")})})]})}var nk=a(6358),nT=a(198),nE=a(5006),nA=a(9130),nM=a(786);let nI={[aG.Waiting]:{name:O.getText(I.STATUS_WAITING),color:"var(--text-color-text-1, rgba(255, 255, 255, 0.85))",background:"var(--fills-color-fill-2, rgba(255, 255, 255, 0.08))"},[aG.Running]:{name:O.getText(I.STATUS_RUNNING),color:"var(--text-color-text-1, rgba(255, 255, 255, 0.85))",background:"var(--fills-color-fill-2, rgba(255, 255, 255, 0.08))"},[aG.Completed]:{name:O.getText(I.STATUS_COMPLETED),color:"var(--tag-tagtext-green-success, #32D74B)",background:"var(--tag-tagbg-green, rgba(50, 215, 75, 0.15))"},[aG.Failed]:{name:O.getText(I.STATUS_FAILED),color:"var(--tag-tagtext-pink-danger, #FF375F)",background:"var(--tag-tagbg-pink, rgba(255, 55, 95, 0.15))"},[aG.PartiallySucceeded]:{name:O.getText(I.STATUS_PARTIAL_SUCCEED),color:"var(--tag-tagtext-orange-warning, #FF9F0A)",background:"var(--tag-tagbg-orange, rgba(255, 159, 10, 0.15))"},[aG.Succeed]:{name:O.getText(I.STATUS_SUCCEED),color:"var(--tag-tagtext-green-success, #32D74B)",background:"var(--tag-tagbg-green, rgba(50, 215, 75, 0.15))"},[aG.Canceled]:{name:O.getText(I.STATUS_CANCELLED),color:"var(--text-color-text-1, rgba(255, 255, 255, 0.85))",background:"var(--fills-color-fill-2, rgba(255, 255, 255, 0.08))"},[aG.Dirty]:{name:O.getText(I.STATUS_DIRTY),color:"var(--text-color-text-1, rgba(255, 255, 255, 0.85))",background:"var(--fills-color-fill-2, rgba(255, 255, 255, 0.08))"}};aK.Waiting,O.getText(I.STATUS_WAITING),aK.Packing,O.getText(I.STATUS_RUNNING),aK.Failed,O.getText(I.STATUS_FAILED),aK.Succeed,O.getText(I.STATUS_SUCCEED);let nL=async(e,t,a)=>{try{await aa(e,t),a&&await a(),tt.Z.success(K.t("update_task_name_successful",{},"更新任务名称成功"))}catch(e){a&&await a(),tt.Z.error(K.t("failed_to_update_task_name",{},"更新任务名称失败"))}};function nz(e){let{status:t}=e,{name:a,color:l,tooltipContent:n,icon:s,suffix:r,background:i}=(0,T.useMemo)(()=>{var a;let l,n,{name:s,color:r,background:i}=nI[t],{success:o=0,failed:c=0,uploading_failed:d=0,create_failed:u=0}=e.status_counts||{},h=null==(a=e.messages)?void 0:a.filter(e=>e!==K.t("success",{},"成功"));switch(t){case aG.PartiallySucceeded:l=`${K.t("successful_{success};_failed__{placeholder3}",{success:o,placeholder3:c+d+u},"已成功：{success}；已失败：{placeholder3}")}`,n=(0,v.jsx)(nk.Z,{});break;case aG.Failed:l=(0,v.jsxs)(v.Fragment,{children:[K.t("reason_for_failure_",{},"失败原因："),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("span",{style:{color:r},children:"100002"}),K.t("the_specific_reasons_are__{placeholder1}",{placeholder1:null==h?void 0:h.join(", ")},"。具体原因有：\n                {placeholder1}")]})]}),n=(0,v.jsx)(a_.Z,{});break;case aG.Succeed:l=null,n=(0,v.jsx)(nT.Z,{});break;case aG.Canceled:l=null,n=(0,v.jsx)(nE.Z,{});break;case aG.Running:l=null,n=(0,v.jsx)(nA.Z,{});break;case aG.Waiting:l=null,n=(0,v.jsx)(nM.Z,{});break;default:l=null,n=null}let p=c+o+d;return{name:s,color:r,background:i,tooltipContent:l,icon:n,suffix:t===aG.Running?`-${p>0?Math.max(Math.floor(p/e.queue_count*100),1):0}%`:null}},[e,t])||{};return(0,v.jsx)(tG.Z,{disabled:!n,content:n,children:(0,v.jsxs)(eQ.Z,{style:{color:l,background:i},className:"container-ofxwO6",children:[(0,v.jsxs)("span",{style:{fontSize:12},children:[s,"\xa0"]}),a,r]})})}let nR=[{label:K.t("generating",{},"生成中"),value:[aG.Running,aG.Completed]},{label:K.t("in_line",{},"排队中"),value:[aG.Waiting]},{label:K.t("success",{},"成功"),value:[aG.Succeed]},{label:K.t("fail",{},"失败"),value:[aG.Failed]},{label:K.t("partial_success",{},"部分成功"),value:[aG.PartiallySucceeded]},{label:K.t("cancelled",{},"已取消"),value:[aG.Canceled]},{label:K.t("expired",{},"已失效"),value:[aG.Dirty]}];var nU=a(6483),nP=a.n(nU),nO=a(1446),nZ=a.n(nO);nP().extend(nZ());let nD=new class{startPolling(e,t,a){this.clearPolling(a);let l=setInterval(async()=>{this.cbProcessMap.get(a)||(this.cbProcessMap.set(a,!0),await e(),this.cbProcessMap.set(a,!1))},t);this.timerMap.set(a,l)}clearPolling(e){let t=this.timerMap.get(e);t&&clearInterval(t)}clearAll(){this.timerMap.forEach(e=>{e&&clearInterval(e)})}constructor(){(0,U._)(this,"timerMap",new Map),(0,U._)(this,"cbProcessMap",new Map)}};var nF=a(9244),nH=((x=nH||{}).Empty="Empty",x.NetworkError="NetworkError",x);let nB={Empty:{icon:(0,v.jsx)(e=>(0,v.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:200,height:200,fill:"none",viewBox:"0 0 200 200",...e,children:[(0,v.jsx)("path",{fill:"#1C1F23",fillRule:"evenodd",d:"m123.171 114.655-.204-.177-34.606 27.107.465-.042c10.036-.912 16.718-.379 18.794-.002l.096.018z",clipRule:"evenodd"}),(0,v.jsx)("path",{fill:"#C6CACD",stroke:"#1C1F23",d:"M123.339 73.871H67.706v39.8h55.633z"}),(0,v.jsx)("path",{fill:"#888D92",stroke:"#1C1F23",d:"m49.968 136.507 17.705-22.445h55.439l-17.704 22.445z"}),(0,v.jsx)("path",{fill:"#888D92",fillRule:"evenodd",d:"M101.667 78.567H75.749v21.45h18.769v6.256h14.597V92.569h-7.448z",clipRule:"evenodd"}),(0,v.jsx)("path",{fill:"#C6CACD",fillRule:"evenodd",d:"M76.659 79.427h24.265v13.142h-6.406v6.655h-17.86zm17.859 20.623H75.74V78.6h26.009V92.57h7.365v13.704H94.518zm7.232-6.655h6.539v12.051H95.344v-5.396h6.406zm-.826 0v5.829h-5.58v-5.829z",clipRule:"evenodd"}),(0,v.jsx)("path",{fill:"#1C1F23",stroke:"#1C1F23",d:"M43.29 174.887h-9.78c4.188-1.213 4.04-11.984 3.444-17.218.881 5.73 4.591 13.866 6.336 17.218Z"}),(0,v.jsx)("path",{fill:"#47FFF2",fillOpacity:.2,d:"M75.934 40.589c0 18.105-14.677 32.782-32.782 32.782S10.37 58.694 10.37 40.59 25.047 7.807 43.152 7.807s32.782 14.677 32.782 32.782"}),(0,v.jsx)("path",{fill:"#47FFF2",fillRule:"evenodd",d:"M47.56 25.117a4.408 4.408 0 0 0-8.816 0v11.065H27.68a4.408 4.408 0 0 0 0 8.815h11.065v11.065a4.408 4.408 0 0 0 8.816 0V44.997h11.064a4.408 4.408 0 1 0 0-8.815H47.56z",clipRule:"evenodd"}),(0,v.jsx)("path",{stroke:"#1C1F23",d:"M63.824 83.328c-4.525-1.833-13.534-7.957-13.38-17.787"}),(0,v.jsx)("path",{fill:"#C6CACD",d:"M52.588 110.23c2.886.094 6.507.914 9.973 4.883 2.482 2.842 4.666 7.208 7.452 14.497.828-6.658 3.073-13.256 4.27-16.322 1.198-3.066 5.287-10.25 9.346-10.513s4.468 3.563 2.57 4.643c-1.899 1.081-3.008.964-4.79 3.417-1.781 2.453-2.957 4.942-2.018 11.331.725-2.938 1.765-4.583 2.775-5.705s8.798-8.057 14.364-8.349c3.857-.202 5.192.705 4.783 1.73 1.45-.392 2.867-.562 4.076-.326 2.084.407 2.777 1.897 1.827 3.179 2.19-.164 4.28.225 5.362 1.836.329.489.242 1.637-.557 2.585-.774.918-2.247 1.639-2.832 1.949-1.19.628-5.934 3.715-7.348 8.104s-2.731 7.462 3.463 20.825c4.706 10.153 5.633 21.323 1.865 29.605 8.962-.282 16.886-2.151 22.02-5.047 4.391-2.477 8.275-5.497 10.389-10.509-2.327-19.654-2.263-57.256.915-57.421 4.492-.234 1.729 48.005 0 54.701q-.376 1.45-.915 2.72c.671 5.667 1.541 9.842 2.592 11.197 1.698 2.189 40.438 4.757 50.207 1.59 1.277-.414 2.06-.927 2.199-1.551 1.011-4.542-14.794-8.263-20.879-13.956-4.187-3.918-2.768-32.426-4.963-50.458s-7.913-36.472-25.263-40.708c-13.623-3.326-24.986 1.736-30.146 5.64H85.617c2.715-5.594 10.459-16.054 26.404-19.18 19.261-3.777 36.177 5.193 46.956 17.466 4.954 5.242 7.748 8.71 9.229 8.71s9.225-4.682 17.608-5.226c2.495-.153 2.452 2.645 1.183 6.807-.52 1.704-1.091 3.064-2.083 5.066-2.447 4.939-7.838 14.301-16.18 21.425 2.195 18.032.776 46.54 4.963 50.458 6.085 5.693 21.89 9.414 20.879 13.956-.139.624-.922 1.137-2.199 1.551-9.769 3.167-48.509.599-50.207-1.59-1.051-1.355-1.921-5.53-2.592-11.197-2.114 5.012-5.998 8.032-10.389 10.509-5.134 2.896-13.058 4.765-22.02 5.047-1.192 2.618-2.853 4.948-5.013 6.866-8.99 7.984-28.984 11.675-47.77 1.678-9.561-5.088-14.718-17.62-17.498-30.17l.005.053c.846 8.928 1.339 14.129-2.186 18.523-7.071.619-13.388 0-19.576-1.915-5.223-1.617-12.913-8.316-8.377-22.616s27.978-32.778 30.134-34.211 7.958-5.577 15.7-5.577"}),(0,v.jsx)("path",{fill:"#888D92",d:"M70.013 129.61c-1.779 10.705.132 28.068 3.327 27.289 1.003-.245 1.574-1.582 1.672-3.896 7.154.333 27.77 7.983 34.468 11.793.154 4.622-.588 9.014-2.311 12.802-1.192 2.619-2.853 4.949-5.013 6.867-8.99 7.984-28.984 11.674-47.77 1.677-9.561-5.088-14.718-17.619-17.498-30.17l.005.054c.846 8.927 1.339 14.129-2.186 18.522-7.071.619-13.388 0-19.576-1.915-5.223-1.617-12.913-8.316-8.377-22.615 4.536-14.3 27.978-32.778 30.134-34.212 2.156-1.433 7.958-5.577 15.7-5.577 2.886.095 6.507.915 9.973 4.884 2.482 2.842 4.666 7.208 7.452 14.497"}),(0,v.jsx)("path",{fill:"#C6CACD",d:"M105.304 147.994c4.706 10.153 5.633 21.323 1.865 29.605 8.962-.282 16.886-2.151 22.02-5.047 4.391-2.477 8.275-5.497 10.389-10.509-2.327-19.654-2.263-57.256.915-57.421 4.492-.234 1.729 48.005 0 54.701q-.376 1.45-.915 2.72c.671 5.667 1.541 9.842 2.592 11.197 1.698 2.189 40.438 4.757 50.207 1.59 1.277-.414 2.06-.927 2.199-1.551 1.011-4.542-14.794-8.263-20.879-13.956-4.187-3.918-2.768-32.426-4.963-50.458s-7.913-36.472-25.263-40.708c-13.623-3.326-24.986 1.736-30.146 5.64H123.5v39.906l-16 27.797-4.958-.071c.685 1.872 1.589 4.034 2.762 6.565"}),(0,v.jsx)("path",{stroke:"#1C1F23",d:"M70.013 129.61c5.504 16.514 6.26 26.574 3.327 27.29-3.195.779-5.106-16.585-3.327-27.29Zm0 0c-2.786-7.289-4.97-11.655-7.452-14.497-3.466-3.969-7.087-4.789-9.974-4.883-7.741 0-13.543 4.144-15.699 5.577S11.29 135.719 6.754 150.018c-4.536 14.3 3.154 20.999 8.377 22.616 6.188 1.915 12.505 2.534 19.576 1.915 3.532-4.403 3.03-9.616 2.181-18.576m33.125-26.363c.828-6.658 3.073-13.256 4.27-16.322 1.198-3.066 5.287-10.25 9.346-10.513s4.468 3.563 2.57 4.643c-1.899 1.081-3.008.964-4.79 3.417-1.781 2.453-2.957 4.942-2.018 11.331.725-2.938 1.765-4.583 2.775-5.705s8.798-8.057 14.364-8.349 5.881 1.728 3.277 3.075c-2.603 1.346-7.613 2.603-14.342 12.164 0 0-.596-5.243 10.01-11.042 2.871-1.57 6.999-3.363 9.914-2.793 3.146.615 3.121 3.694-.936 4.808-1.211.332-3.372 1.468-5.089 2.916-2.854 2.407-5.264 5.569-5.782 6.536.427-3.524 4.308-8.512 8.96-10.073 3.21-1.078 8.151-1.978 10.036.828.329.489.242 1.637-.557 2.585-.774.918-2.247 1.639-2.832 1.949-1.19.628-5.934 3.715-7.348 8.104-1.146 3.558-2.229 6.251.701 14.26m-65.654 14.544c-2.682-12.109-3.15-24.236-3.226-29.71m3.226 29.71c2.78 12.55 7.937 25.082 17.498 30.17 18.786 9.997 38.78 6.306 47.77-1.678 2.16-1.918 3.821-4.248 5.013-6.866m-4.627-36.17c.685 1.872 1.589 4.034 2.762 6.565 4.706 10.153 5.633 21.323 1.865 29.605m-4.627-36.17 4.958.071 16-27.797V73.798h-10.175m-6.156 103.801c8.962-.282 16.886-2.151 22.02-5.047 4.391-2.477 8.275-5.497 10.389-10.509m0 0c.671 5.667 1.541 9.842 2.592 11.197 1.698 2.189 40.438 4.757 50.207 1.59m-52.799-12.787c-2.327-19.654-2.263-57.256.915-57.421 4.492-.234 1.729 48.005 0 54.701q-.376 1.45-.915 2.72Zm29.156-53.178c2.195 18.032.776 46.54 4.963 50.458 6.085 5.693 21.89 9.414 20.879 13.956-.139.624-.922 1.137-2.199 1.551m-23.643-65.965c-2.195-18.031-7.913-36.472-25.263-40.708-13.623-3.326-24.986 1.736-30.146 5.64m55.409 35.068c8.342-7.124 13.733-16.486 16.18-21.425.992-2.002 1.563-3.362 2.083-5.066m5.38 92.456c-.423-2.915-1.248-3.562-4.803-4.603m-74.249-96.43H85.617c2.715-5.594 10.459-16.054 26.404-19.18 19.261-3.777 36.177 5.193 46.956 17.466 4.954 5.242 7.748 8.71 9.229 8.71s9.225-4.682 17.608-5.226c2.495-.153 2.452 2.645 1.183 6.807m0 0c.014-1.01.153-2.073-.431-2.74-1.769-2.022-5.884-2.07-6.455 1.979"}),(0,v.jsx)("path",{fill:"#C6CACD",stroke:"#1C1F23",d:"M58.124 104.222c0 5.846-4.675 10.574-10.43 10.574-5.754 0-10.43-4.728-10.43-10.574s4.676-10.574 10.43-10.574c5.755 0 10.43 4.728 10.43 10.574Z"}),(0,v.jsx)("path",{fill:"#1C1F23",fillRule:"evenodd",d:"M49.015 93.79c6.178.586 4.56 12.303.588 17.577-2.88 3.824-1.17 7.132.907 11.154.424.82.863 1.67 1.281 2.559 1.96 2.869 3.094 6.271 3.094 9.919 0 10.247-8.95 18.553-19.99 18.553-11.041 0-19.992-8.306-19.992-18.553 0-7.888 5.305-14.626 12.784-17.31 7.303-4.039 9.583-8.075 9.855-15.111.235-6.093 5.295-9.374 11.473-8.788",clipRule:"evenodd"}),(0,v.jsx)("mask",{id:"empty_svg__a",width:41,height:61,x:14,y:93,maskUnits:"userSpaceOnUse",style:{maskType:"luminance"},children:(0,v.jsx)("path",{fill:"#fff",fillRule:"evenodd",d:"M49.015 93.79c6.178.586 4.56 12.303.588 17.577-2.88 3.824-1.17 7.132.907 11.154.424.82.863 1.67 1.281 2.559 1.96 2.869 3.094 6.271 3.094 9.919 0 10.247-8.95 18.553-19.99 18.553-11.041 0-19.992-8.306-19.992-18.553 0-7.888 5.305-14.626 12.784-17.31 7.303-4.039 9.583-8.075 9.855-15.111.235-6.093 5.295-9.374 11.473-8.788",clipRule:"evenodd"})}),(0,v.jsx)("g",{mask:"url(#empty_svg__a)",children:(0,v.jsx)("path",{fill:"#1C1F23",d:"m51.791 125.08-2.714 1.277.102.217.135.198zm-24.104-7.391 1.013 2.824.227-.082.212-.117zM52 113.171c2.404-3.192 3.966-8.055 4.113-12.245.074-2.103-.194-4.367-1.178-6.265-1.062-2.05-2.95-3.603-5.637-3.858l-.566 5.973c.403.038.629.169.876.646.326.629.564 1.734.509 3.293-.11 3.133-1.343 6.766-2.91 8.847zm1.176 7.973c-1.099-2.126-1.796-3.533-2.026-4.808-.182-1.003-.076-1.935.85-3.165l-4.793-3.609c-1.954 2.595-2.434 5.229-1.962 7.842.424 2.34 1.62 4.597 2.6 6.494zm1.33 2.659c-.446-.948-.91-1.846-1.33-2.659l-5.33 2.754c.426.827.84 1.628 1.23 2.459zm-5.192 2.969c1.638 2.398 2.571 5.215 2.571 8.227h6c0-4.284-1.335-8.271-3.616-11.611zm2.571 8.227c0 8.383-7.392 15.553-16.99 15.553v6c12.482 0 22.99-9.442 22.99-21.553zm-16.99 15.553c-9.6 0-16.992-7.17-16.992-15.553h-6c0 12.111 10.509 21.553 22.991 21.553zm-16.992-15.553c0-6.47 4.36-12.177 10.797-14.486l-2.027-5.648c-8.521 3.058-14.77 10.828-14.77 20.134zm16.641-32.537c-.124 3.222-.696 5.406-1.827 7.19-1.144 1.805-3.064 3.522-6.482 5.412l2.904 5.25c3.885-2.148 6.757-4.469 8.646-7.45 1.903-3.003 2.607-6.355 2.755-10.17zm14.754-11.66c-3.665-.347-7.244.43-10.017 2.454-2.835 2.07-4.585 5.277-4.737 9.206l5.996.232c.083-2.165.98-3.644 2.279-4.592 1.36-.993 3.4-1.564 5.913-1.326z"})}),(0,v.jsx)("path",{fill:"#C6CACD",stroke:"#1C1F23",d:"M54.098 105.948c0 1.691-1.432 3.096-3.24 3.096-1.807 0-3.239-1.405-3.239-3.096s1.432-3.095 3.24-3.095c1.807 0 3.239 1.404 3.239 3.095Z"}),(0,v.jsx)("path",{fill:"#1C1F23",stroke:"#1C1F23",strokeWidth:3,d:"M37.119 95.066c0 1.831-1.541 3.39-3.534 3.39s-3.534-1.559-3.534-3.39 1.541-3.39 3.534-3.39 3.534 1.558 3.534 3.39Z"}),(0,v.jsx)("path",{stroke:"#1C1F23",d:"M147.224 155.647c-.108 3.583 1.267 4.886 4.705 6.08"})]}),{}),message:K.t("no_relevant_content__try_another_word~",{},"无相关内容，换个词试试～")},NetworkError:{icon:(0,v.jsx)(e=>(0,v.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:200,height:200,fill:"none",viewBox:"0 0 200 200",...e,children:[(0,v.jsxs)("g",{clipPath:"url(#network_error_svg__a)",children:[(0,v.jsx)("path",{fill:"#47FFF2",fillOpacity:.2,fillRule:"evenodd",d:"M64.09 64.865V8.563L5.759 78.94h44.258V99.23h14.075V78.94h8.817V64.865zm110.178 0V8.563l-50.157 60.512a64 64 0 0 0 1.069-11.759c0-10.997-2.708-21.098-7.246-28.549-4.506-7.397-11.137-12.622-19.008-12.622s-14.503 5.225-19.01 12.622c-4.537 7.451-7.246 17.552-7.246 28.55 0 10.997 2.709 21.098 7.247 28.548 4.506 7.398 11.138 12.623 19.008 12.623 7.872 0 14.503-5.225 19.009-12.623 1.285-2.11 2.423-4.431 3.395-6.926h38.865V99.23h14.074V78.94h8.817V64.865zm-138.564 0 14.312-17.268v17.268zm124.49 0h-14.313l14.313-17.268zm-49.088-7.548c0 8.846-2.206 16.324-5.192 21.227-3.088 5.072-5.878 5.87-6.989 5.87s-3.899-.798-6.988-5.87c-2.986-4.903-5.193-12.38-5.193-21.227s2.207-16.325 5.193-21.228c3.089-5.072 5.877-5.87 6.989-5.87 1.11 0 3.9.798 6.988 5.87 2.986 4.903 5.192 12.38 5.192 21.228",clipRule:"evenodd"}),(0,v.jsx)("path",{fill:"#C5C5C5",d:"M178.338 186.569c-1.853 2.194-6.664 1.021-8.133.237a2.5 2.5 0 0 1-.337-.218c-1.934.224-14.935-.498-15.117-.455-6.123 1.424-14.062 1.03-15.202.991-1.359-.047-4.534-1.324-5.752-5.071-1.194-3.675-.002-7.124 2.159-13.375l.131-.376q-.713 1.413-1.432 2.824c-7.363 14.43-11.046 19.703-17.426 20.148-6.38.444-34.338-.092-41.088-.784-6.751-.691-9.419-1.679-9.353-2.832.053-.922 2.984-2.195 4.443-2.716-5.887-1.573-20.165-5.972-30.183-10.98-12.521-6.261-25.136-15.793-21.913-28.922 3.224-13.129 15.76-16.799 25.591-17.377 2.748-.162 5.144-.104 7.163.07 3.76.325 6.212 1.055 7.193 1.526-1.108-6.373-3.325-19.337-3.325-20.21 0-1.092-3.02-10.665-3.638-14.353-.091-.546-1.115-5.593 3.638-5.019 4.753.575 12.396 18.202 15.886 28.706 5.711-4.967 10.773-9.411 11.15-9.87.833-1.019 9.358-9.755 14.87-13.848 5.513-4.093 16.707-10.934 32.996-11.752s34.489 2.362 40.891 11.909c6.402 9.546 6.102 34.442 6.452 48.71s.841 27.641 2.111 29.757 6.442 5.021 9.769 7.138 4.445 3.901 4.354 4.203-.393.575-2.233 1.08c.331.473.118 1.383-2.121 1.609-4.709.474-8.646-.75-11.544-.75"}),(0,v.jsx)("path",{stroke:"#17171A",d:"M192.003 185.71c-1.612-2.307-9.703-5.341-15.044-5.752s-6.445.532-7.404 1.853c-.996 1.371-1.042 3.724.313 4.777m22.135-.878c.331.473.118 1.383-2.121 1.609-4.709.474-8.646-.75-11.544-.75-1.853 2.194-6.664 1.021-8.133.237a2.5 2.5 0 0 1-.337-.218m22.135-.878c1.84-.505 2.142-.777 2.233-1.08.091-.302-1.027-2.086-4.354-4.203s-8.499-5.021-9.769-7.138-1.762-15.489-2.111-29.757-.05-39.164-6.452-48.71c-6.402-9.547-24.601-12.727-40.891-11.909s-27.483 7.66-32.995 11.752c-5.513 4.093-14.038 12.829-14.872 13.848-.376.459-5.438 4.903-11.15 9.87-3.49-10.504-11.132-28.13-15.885-28.706-4.753-.574-3.729 4.473-3.638 5.019.617 3.688 3.638 13.261 3.638 14.353 0 .873 2.217 13.837 3.325 20.21-.981-.471-3.433-1.201-7.193-1.526m117.979 58.855c-1.934.224-14.935-.498-15.117-.455m-102.862-58.4c-2.02-.174-4.415-.232-7.163-.07-9.831.578-22.367 4.248-25.59 17.377-3.224 13.129 9.39 22.661 21.912 28.922 10.018 5.008 24.296 9.407 30.183 10.98M51.89 127.733s1.237 7.122 3.868 11.415c2.044 3.335 4.268 5.914 6.614 7.799m8.86 37.995c-1.459.521-4.39 1.794-4.443 2.716-.066 1.153 2.602 2.141 9.353 2.832 6.75.692 34.708 1.228 41.088.784 6.38-.445 10.063-5.718 17.426-20.148q.719-1.41 1.432-2.824m-64.856 16.64c5.886-2.492 12.352-6.324 16.485-10.113 5.07-4.649 9.55-13.457 9.963-14.282.083-.165.367-.708.823-1.558m37.585 9.313c6.81-13.513 12.913-26.867 12.863-30.864-.053-4.275-5.18 4.22-6.65 11.031-1.583 7.336-.844 11.664-.369 14.672m-5.844 5.161c-2.243 6.49-3.508 10.003-2.29 13.751s4.393 5.024 5.752 5.071c1.14.039 9.079.433 15.202-.991m-56.25-27.144c-6.868-3.097-17.87-6.803-22.513-8.27m22.514 8.27a395 395 0 0 1 7.76-13.739m48.489 40.883c1.175-.273 2.283-.613 3.264-1.035 6.09-2.624 10.92-8.552 13.535-24.261s1.493-42.358-10.288-50.773-21.319-6.078-34.036 5.797c-5.334 4.981-11.857 14.523-17.418 23.52m0 0a162 162 0 0 1-1.936-10.418m1.936 10.418a342 342 0 0 0-3.546 5.869m1.61-16.287c-.879-5.812-1.289-10.866-1.289-14.607m1.289 14.607c-2.316 2.458-7.774 7.149-13.664 11.543m12.054 4.744c-2.32-.935-9.002-3.552-12.054-4.744m0 0c-6.293 4.696-13.08 9.052-17.052 9.98q-.585.137-1.168.233m-13.617-3.772c4.257 3.422 8.915 4.557 13.617 3.772m-13.617-3.772c-3.289-.843-11.286-2.383-12.858-2.411"}),(0,v.jsx)("path",{fill:"#6B7074",d:"m77.742 73.314 23.732 43.204-1.696 2.492-22.742 9.549-24.579-44.48 21.895-10.765z"}),(0,v.jsx)("path",{stroke:"#17171A",d:"M74.352 73.314h3.39l23.732 43.204-1.696 2.492M74.352 73.314 52.457 84.079l24.579 44.48 22.742-9.549M74.352 73.314l25.426 45.696"}),(0,v.jsx)("path",{fill:"#C5C5C5",d:"M83.893 116.955c.97 1.96-4.906 4.567-8.319 6.175-1.327.626-2.096.978-2.7 1.208.908 3.287 1.249 8.129-4.478 9.815-5.728 1.687-15.064-1.02-18.006-9.611s.02-19.966 9.062-27.029c5.664-4.424 15.012-5.769 19.415-4.05 2.154.815 1.38 2.707-.563 4.432-1.35 1.198-2.92 2.434-4.521 3.587q.592-.022 1.225-.011c4.127.073 7.263 1.121 7.418 3.151.071.936-.802 2.124-1.948 3.444a15.7 15.7 0 0 1-1.946 1.883c2.796-.223 5.937 1.047 2.904 4.196-.42.436-.855.835-1.295 1.198 1.727.031 3.237.57 3.752 1.612"}),(0,v.jsx)("path",{stroke:"#17171A",d:"M69.73 125.092c1.654-.336 2.194-.393 3.144-.754m0 0c.604-.23 1.373-.582 2.7-1.208 3.413-1.608 9.289-4.215 8.32-6.175-.867-1.751-4.54-2.082-7.339-.964-2.835 1.132-3.576 2.243-3.458 2.557.117.313 4.755-.683 8.339-4.403 3.4-3.53-.958-4.699-3.891-4.05-2.261.5-6.408 2.06-6.166 2.844.157.51 5.334-.535 9.099-4.873 1.146-1.32 2.02-2.508 1.948-3.444-.155-2.03-3.29-3.078-7.418-3.151-8.826-.157-11.556 4.784-11.16 5.108 1.105.908 9.358-4.158 14.456-8.684 1.944-1.725 2.717-3.617.563-4.431-4.403-1.72-13.751-.375-19.415 4.05-9.041 7.062-12.004 18.437-9.062 27.028s12.278 11.298 18.006 9.611 5.386-6.528 4.478-9.815Z"}),(0,v.jsx)("path",{fill:"#17171A",fillRule:"evenodd",d:"M106.483 120.146c-.199 1.566-.527 3.988-1.206 6.517-.68 2.53-1.708 5.156-3.302 7.136l.198.19 5.675-4.969-1.092-8.873zm31.087 45.328-.25-.113-11.297 21.279h11.921l-.432-.256c-3.507-2.079-4.072-5.793-3.459-9.774.523-3.4 1.9-6.953 2.99-9.765q.28-.72.527-1.371m-85.81-37.895-.24.117c.297 1.464 1.045 4.801 1.647 6.39l.018.049.047.025c1.63.84 4.407 1.847 7.454 2.141s6.38-.124 9.103-2.153l-.131-.24c-3.134 1.195-11.137 1.629-17.899-6.329M133.546 82.826l.015-.159-.159.008c-1.819.092-5.842.381-9.875.952-2.016.285-4.036.64-5.785 1.079-1.745.437-3.235.959-4.178 1.582l-.06.04-.002.071c-.042 1.8.124 3.687.645 5.353.522 1.667 1.402 3.123 2.796 4.046 2.821 1.866 6.693 1.626 9.991-.576 3.302-2.205 6.035-6.377 6.612-12.396",clipRule:"evenodd"}),(0,v.jsx)("path",{fill:"#C5C5C5",stroke:"#17171A",d:"M126.661 84.732c0 5.457-4.351 9.868-9.701 9.868s-9.702-4.41-9.702-9.868 4.351-9.869 9.702-9.869c5.35 0 9.701 4.41 9.701 9.868Z"}),(0,v.jsx)("path",{fill:"#17171A",fillRule:"evenodd",d:"M109.413 70.596c.652.25 1.246.476 1.892.26.53-.176.833-.692 1.187-1.294.749-1.276 1.725-2.936 5.562-2.562 3.856.376 4.59 2.173 5.103 3.43.203.496.371.908.682 1.115.48.32.839.335 1.262.353.547.023 1.202.05 2.368.75 1.415.848 2.488 5.65.236 9.935l.252.43c-.447 2.151-3.046 4.365-3.046 4.141 0-3.045 0-4.751-2.924-7.431-4.261 1.597-10.886 1.126-13.935.139h-.001c-4.007-1.283-5.986-6.814-2.531-9.005 1.719-1.09 2.877-.649 3.893-.26",clipRule:"evenodd"}),(0,v.jsx)("path",{fill:"#17171A",fillRule:"evenodd",d:"M116.693 81.608a.413.413 0 1 0-.731.384c.206.393.466.747.893.96.419.207.934.246 1.584.165a.413.413 0 1 0-.103-.82c-.579.072-.905.017-1.114-.086-.202-.1-.357-.276-.529-.603m-6.561 4.21a1.066 1.066 0 0 0 1.002-1.125 1.063 1.063 0 0 0-1.107-1.019 1.066 1.066 0 0 0-1.002 1.125 1.06 1.06 0 0 0 1.107 1.019m6.821.73a1.067 1.067 0 0 0 1.003-1.124 1.063 1.063 0 0 0-1.107-1.019 1.066 1.066 0 0 0-1.002 1.125 1.06 1.06 0 0 0 1.106 1.019",clipRule:"evenodd"}),(0,v.jsx)("path",{fill:"#C5C5C5",stroke:"#17171A",d:"M127.421 88.488a2.48 2.48 0 1 0 0-4.959 2.48 2.48 0 0 0 0 4.959Z"}),(0,v.jsx)("path",{fill:"#47FFF2",stroke:"#000",strokeWidth:3,d:"M71.748 79.083a4.671 4.671 0 1 0 6.606-6.606 4.671 4.671 0 0 0-6.606 6.606Z"}),(0,v.jsx)("path",{fill:"#C5C5C5",fillRule:"evenodd",d:"M77.9 72.973a1.11 1.11 0 0 0-1.568 0l-1.265 1.265-1.307-1.308a1.108 1.108 0 1 0-1.568 1.568l1.308 1.308-1.308 1.307a1.109 1.109 0 0 0 1.568 1.568l1.307-1.307 1.265 1.264A1.108 1.108 0 1 0 77.9 77.07l-1.265-1.264L77.9 74.54a1.11 1.11 0 0 0 0-1.568",clipRule:"evenodd"}),(0,v.jsx)("path",{fill:"#47FFF2",fillRule:"evenodd",d:"M99.411 49.113a32.26 32.26 0 0 0-19.002-9.84c-1.262-.18-2.348.787-2.42 2.021-.07 1.196.82 2.197 1.968 2.366a27.86 27.86 0 0 1 16.132 8.355c.833.874 2.237.992 3.166.157.883-.792.995-2.17.156-3.059m-35.798-8.526a32.5 32.5 0 0 0-18.748 15.73c-.581 1.1-.077 2.42 1.017 2.93 1.112.52 2.4.024 2.961-1.022a28.08 28.08 0 0 1 15.959-13.39c1.124-.368 1.835-1.545 1.523-2.73-.309-1.17-1.523-1.9-2.712-1.518m27.75 15.783a21.47 21.47 0 0 0-11.537-6.219c-1.286-.24-2.396.75-2.469 1.994-.069 1.185.801 2.164 1.906 2.387a17.07 17.07 0 0 1 8.75 4.717c.846.851 2.257.997 3.2.15.868-.78.999-2.149.15-3.03m-24.645-4.65a21.64 21.64 0 0 0-11.66 9.805c-.615 1.099-.096 2.423.992 2.93 1.117.522 2.393.016 2.98-.994a17.22 17.22 0 0 1 8.914-7.498c1.091-.402 1.808-1.564 1.495-2.75-.308-1.167-1.527-1.914-2.72-1.494m16.63 11.951a10.7 10.7 0 0 0-3.995-2.47c-1.355-.467-2.559.617-2.633 1.897-.066 1.138.729 2.047 1.65 2.447a6.3 6.3 0 0 1 1.522.939c.886.739 2.327.995 3.316.107.823-.74 1.009-2.07.14-2.92m-14.273-.76a10.77 10.77 0 0 0-4.51 3.826c-.724 1.084-.156 2.424.912 2.923 1.133.529 2.37-.02 3.046-.878a6.4 6.4 0 0 1 1.925-1.632c.948-.522 1.686-1.634 1.371-2.83-.303-1.151-1.542-1.952-2.745-1.408",clipRule:"evenodd"})]}),(0,v.jsx)("defs",{children:(0,v.jsx)("clipPath",{id:"network_error_svg__a",children:(0,v.jsx)("path",{fill:"#fff",d:"M0 0h200v200H0z"})})})]}),{}),message:K.t("network_exception__try_again_later~",{},"网络异常，稍后再试～")}};function nV(e){let{status:t,...a}=e,{icon:l,message:n}=t&&t in nH?nB[t]:{icon:void 0,message:void 0};return(0,v.jsx)(nF.Z,{status:null,icon:l,title:n?(0,v.jsx)("div",{className:"global-result",children:n}):null,...a})}function nW(){let[e,t]=F((0,ew.N)(e=>[e.containerRect,e.uiConfig.listPaddingHorizontal])),a=na(()=>window.innerHeight-270),[l,n,s,r,i,o,c]=n_((0,ew.N)(e=>[e.taskName,e.isError,e.taskList,e.currentPage,e.pageSize,e.total,e.loading])),{changePagination:d}=n_(),{runSimple:u}=function(){let[e,t,a,l,n,s]=n_((0,ew.N)(e=>[e.taskName,e.filted.status,e.currentPage,e.pageSize,e.stopPollingList,e.taskStatusFilter])),{setState:r}=n_,i=(0,T.useRef)(!1),o=(0,T.useRef)(!1),c=(0,T.useRef)(eL()),d=(0,T.useMemo)(()=>{let e=[];return s.forEach(t=>e.push(...t)),e},[s]),u=async()=>{let e=eL();c.current=e,o.current=!0,r({loading:!0});let{taskName:t,pageSize:a,currentPage:l}=n_.getState(),n=[];n_.getState().taskStatusFilter.forEach(e=>n.push(...e));try{let s=await t9(t,a,l,n);if(e===c.current){if(l>1&&0===s.data.data.length){n_.setState({currentPage:l-1}),await u();return}r({taskList:s.data.data,total:s.data.total})}}catch(e){console.error("获取任务列表失败")}finally{r({loading:!1}),o.current=!1}},h=(0,T.useCallback)(async function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(o.current||n)return;let s=eL();c.current=s,i.current=!0,r({loading:!t});try{let t=await t9(e,l,a,d);if(n||o.current||s!==c.current)return;let u=t.data.data;r({isError:!1,taskList:u,total:t.data.total,loading:!1}),i.current=!1}catch(e){console.error("获取任务列表失败"),r({isError:!0,loading:!1}),i.current=!1}},[e,t,l,a,n,d]);return(0,T.useEffect)(()=>{let e="getTaskListIntervalKey";return nD.startPolling(()=>{i.current||o.current||n||h(!0)},2e3,e),()=>{nD.clearPolling(e)}},[h,n]),(0,T.useEffect)(()=>{u()},[e,t,l,a,d]),{run:h,runSimple:u}}(),h=function(e){let[t,a,l,n]=n_((0,ew.N)(e=>[e.taskList,e.pageSize,e.currentPage,e.taskStatusFilter]));return(0,T.useMemo)(()=>[{width:100,title:K.t("serial_number",{},"序号"),fixed:"left",render:(e,t,n)=>tF(a*(l-1)+n+1)},{width:300,title:K.t("task_name",{},"任务名称"),fixed:"left",dataIndex:"name",render:(a,l,n)=>(0,v.jsx)(tq,{value:a,fontSize:14,maxWidth:240,maxLength:50,onChange:async a=>{if(null==a?void 0:a.trim()){let s=a.trim();s!==t[n].name&&(t[n].name=s,n_.setState({taskList:[...t],stopPollingList:!0}),await nL(l.id,s,e),n_.setState({taskList:[...t],stopPollingList:!1}))}}})},{width:200,title:K.t("creation_time",{},"创建时间"),dataIndex:"created_at",render:e=>{var t;return(t=new Date(e).getTime())?nP()(t).format("YYYY-MM-DD HH:mm"):"-"}},{width:180,title:K.t("generation_quantity",{},"生成数量"),dataIndex:"queue_count"},{width:180,title:K.t("state",{},"状态"),fixed:"right",dataIndex:"status",filterDropdown:e=>(0,v.jsx)(nx,{filterList:nR,value:n,onOk:t=>{var a;n_.setState({taskStatusFilter:t}),null==(a=e.confirm)||a.call(e,t)},onReset:()=>{var t;n_.setState({taskStatusFilter:[]}),null==(t=e.confirm)||t.call(e,[])}}),render:(e,t)=>(0,v.jsx)(nz,{...t})},{width:220,title:K.t("operation",{},"操作"),dataIndex:"_",fixed:"right",render:(t,a)=>(0,v.jsx)(nb,{task:a,refresh:e})}],[l,a,e,t,n])}(u),p=(0,T.useMemo)(()=>{let t=60*(o>0);return e.clientHeight?e.clientHeight-108-t:a},[e.clientHeight,a,o]);(0,T.useEffect)(()=>()=>{var e,t;null==(e=(t=F.getState()).closeShareModal)||e.call(t)},[]);let m=(0,T.useMemo)(()=>l&&!s.length?(0,v.jsx)(lG,{style:{height:p-60},text:K.t("no_search_results_yet__try_searching_for_other_content",{},"暂无搜索结果，试试搜索其他内容")}):(0,v.jsx)(lG,{style:{height:p-60},text:K.t("task_list_is_empty",{},"任务列表为空"),loading:c,extra:c?null:(0,v.jsx)(nm,{style:{marginTop:8}})}),[c,p,s,l]),g=(0,T.useMemo)(()=>(0,v.jsx)(np,{}),[]);return(0,v.jsxs)("div",{className:"task-list",children:[(0,v.jsxs)(W,{className:"task-list-table",style:{padding:`0 ${t}px`},direction:"column",gap:16,children:[(0,v.jsx)(nf,{}),n?(0,v.jsx)(nV,{className:"task-list-table-result",status:nV.Status.NetworkError}):(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(tA.Z,{rowKey:"id",columns:h,data:s,loading:null!=l&&!!l.length&&c,size:"default",noDataElement:m,onChange:d,pagination:{pageSize:i,total:o,current:r,sizeCanChange:!0,showTotal:!0,showJumper:!0},scroll:{x:h.reduce((e,t)=>e+Number(t.width??0),0),y:p}})})]}),g]})}function n$(e){let{children:t}=e;return(0,v.jsxs)(W,{direction:"column",children:[(0,v.jsx)(W,{justify:"flex-end",style:{padding:"10px 32px"},children:(0,v.jsx)(E.Z,{icon:(0,v.jsx)(eC.Z,{}),size:"large",shape:"circle",onClick:()=>B.getState().changeType(Z.List)})}),t]})}function nG(){let[e,t]=F((0,ew.N)(e=>[e.uiConfig,e.i18n])),[a,l]=B((0,ew.N)(e=>[e.type,e.isLock])),{showVersion:n}=e;(0,T.useEffect)(()=>{t&&O.setRuntimeLanguage(t)},[]);let s={[Z.List]:nW,[Z.Creator]:aS,[Z.Result]:nh}[a];return(0,v.jsxs)(v.Fragment,{children:[a===Z.Result?(0,v.jsx)(n$,{children:(0,v.jsx)(s,{})}):(0,v.jsx)(s,{}),l?(0,v.jsx)("div",{className:"batch-tools-container-lock"}):null,n?(0,v.jsx)(W,{style:{fontSize:10,position:"fixed",bottom:0,left:0,zIndex:9999},align:"center",children:(0,v.jsx)("span",{children:K.t("batch_tool_version_number__{batchtoolsversion}",{BatchToolsVersion:"v1.0.7"},"批量工具版本号: {BatchToolsVersion}")})}):null]})}function nK(){return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(ev,{}),(0,v.jsx)("div",{className:"batch-tools-container",children:(0,v.jsx)("div",{className:"batch-tools-render-content",children:(0,v.jsx)(nG,{})})})]})}nV.Status=nH;let nq=()=>{var e,t;null==(t=window)||null==(e=t.LiteGraph)||e.closeAllContextMenus(),ed();let{close:a}=A.Z.confirm({title:null,wrapClassName:"batch-tools-container-modal-wrap",icon:null,footer:null,className:"batch-tools-container-modal",content:(0,v.jsx)(nK,{}),alignCenter:!0,focusLock:!1,closable:!0,escToExit:!1,maskClosable:!1,closeIcon:null});F.setState({i18n:O.getLanguage(),uiConfig:{showVersion:!0,showTitle:!1,showCreateTask:!0,showCopy:!0,showCancel:!0,listPaddingHorizontal:24},containerRect:{clientHeight:0,clientWidth:0}}),B.setState({closeModal:()=>{a()}})},nY=e=>(0,v.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24",...e,children:[(0,v.jsx)("path",{fill:"#000",d:"M16.73 13.639a1.25 1.25 0 1 0 0-2.501 1.25 1.25 0 0 0 0 2.5M8.297 13.661a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5"}),(0,v.jsx)("path",{fill:"#000",d:"M11.998 0C5.372 0 0 5.372 0 11.998c0 5.175 3.275 9.583 7.865 11.268l3.12-3.348-2.437-1.11 4.217-2.618h-.01l-.004-1.412a1.02 1.02 0 0 0-.687-1.776 1.017 1.017 0 0 0-.655 1.799l.005 1.393-3.763.009a4.28 4.28 0 0 1-4.292-4.267 4.28 4.28 0 0 1 4.267-4.293l8.73-.023h.014a4.28 4.28 0 0 1 4.292 4.268 4.28 4.28 0 0 1-4.267 4.292h-.014l-1.912.006-2.091 2.245 2.506 1.121-6.423 3.917a12 12 0 0 0 3.54.531C18.629 24 24 18.628 24 12.002S18.626 0 11.998 0"})]}),nX="dragButtonPosition",nJ=()=>{let e=(0,T.useRef)(null),[t,a]=(0,T.useState)(!1),[l,n]=(0,T.useState)(!1),[s,r]=(0,T.useState)({x:window.innerWidth-24,y:60,top:60,right:24}),i=(0,T.useRef)({x:0,y:0}),o=(0,T.useRef)(!1),c=(0,T.useRef)(!1);(0,T.useRef)();let d=e=>{localStorage.setItem(nX,JSON.stringify(e))},u=(0,T.useMemo)(()=>(0,w.debounce)(d,200),[d]);(0,T.useEffect)(()=>(u(s),()=>u.cancel()),[s,u]),(0,T.useEffect)(()=>{o.current=l,c.current=t},[l,t]);let h=(0,T.useCallback)(e=>{(Math.abs(e.clientX-i.current.x)>5||Math.abs(e.clientY-i.current.y)>5)&&(n(!1),a(!0),r(t=>{let a=Math.min(window.innerHeight-40,Math.max(0,t.y+e.movementY)),l=Math.max(0,Math.min(window.innerWidth,t.x+e.movementX));return l<220?{x:l,y:a,left:Math.max(0,l),top:a}:{x:l,y:a,right:Math.max(0,window.innerWidth-l),top:a}}))},[]),p=(0,T.useCallback)(()=>{let e=o.current,t=c.current;document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",p),e&&!t&&nq(),n(!1),a(!1)},[]),m=(0,T.useCallback)(e=>{i.current={x:e.clientX,y:e.clientY},n(!0),a(!1),document.addEventListener("mousemove",h),document.addEventListener("mouseup",p)},[p,h]),g=(0,T.useCallback)(e=>{e.preventDefault(),n(!1),a(!1),document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",p)},[h,p]);return(0,T.useEffect)(()=>{let e=localStorage.getItem(nX);return e&&r(JSON.parse(e)),()=>{document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",p)}},[]),(0,v.jsx)(E.Z,{ref:e,className:"button-YhDfn3",type:"primary",size:"small",icon:(0,v.jsx)(nY,{}),onMouseDown:m,onContextMenu:g,style:{display:"flex",alignItems:"center",position:"fixed",opacity:t?.5:1,height:40,padding:8,transition:"width 0.3s ease",...s},children:"ComfyUI-Lumi-Batcher"})};var nQ=a(2409),n0=a(5996),n1=a(4231);let n2=()=>((0,T.useEffect)(()=>{ec()},[]),(0,v.jsx)(nQ.ZP,{locale:O.getLanguage()===L.EN?n0.Z:n1.Z,children:(0,v.jsx)(nJ,{})})),n3=a(698).ZP.load(),n5=async()=>{let e=await n3,t=await e.get();return console.log("Device ID:",t.visitorId),t},n4=async()=>{try{let e=await n5();ei.config(e.visitorId)}catch(e){console.error("Failed to initialize fingerprint:",e)}},n6=async()=>{document.body.setAttribute("arco-theme","dark"),await n4(),k((0,v.jsx)(n2,{}),"batch-tools-trigger-container")};a(5962),n6(),"serviceWorker"in navigator&&navigator.serviceWorker.register("/api/comfyui-lumi-batcher/sw.js").then(function(e){console.log("Service Worker registered with scope:",e.scope)}).catch(function(e){console.error("Service Worker registration failed:",e)})}},t={};function a(l){var n=t[l];if(void 0!==n)return n.exports;var s=t[l]={id:l,loaded:!1,exports:{}};return e[l].call(s.exports,s,s.exports,a),s.loaded=!0,s.exports}a.m=e,a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var l in t)a.o(t,l)&&!a.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},a.g=(()=>{if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}})(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e=[];a.O=(t,l,n,s)=>{if(l){s=s||0;for(var r=e.length;r>0&&e[r-1][2]>s;r--)e[r]=e[r-1];e[r]=[l,n,s];return}for(var i=1/0,r=0;r<e.length;r++){for(var[l,n,s]=e[r],o=!0,c=0;c<l.length;c++)(!1&s||i>=s)&&Object.keys(a.O).every(e=>a.O[e](l[c]))?l.splice(c--,1):(o=!1,s<i&&(i=s));if(o){e.splice(r--,1);var d=n();void 0!==d&&(t=d)}}return t}})(),a.p="/api/comfyui-lumi-batcher/get-static-file?path=./custom_nodes/comfyui-lumi-batcher/frontend/dist/",a.rv=()=>"1.3.8",(()=>{var e={980:0};a.O.j=t=>0===e[t];var t=(t,l)=>{var n,s,[r,i,o]=l,c=0;if(r.some(t=>0!==e[t])){for(n in i)a.o(i,n)&&(a.m[n]=i[n]);if(o)var d=o(a)}for(t&&t(l);c<r.length;c++)s=r[c],a.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return a.O(d)},l=self.webpackChunkfrontend=self.webpackChunkfrontend||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))})(),a.ruid="bundler=rspack@1.3.8";var l=a.O(void 0,["72","361","560"],function(){return a(7666)});l=a.O(l)})();
//# sourceMappingURL=index.601ac604.js.map