{
  "id": "7200c272-1c07-4834-9c36-c6ec5c140c21",
  "revision": 0,
  "last_node_id": 76,
  "last_link_id": 139,
  "nodes": [
    {
      "id": 28,
      "type": "WanVideoSetBlockSwap",
      "pos": [
        1164.3349609375,
        456.0657043457031
      ],
      "size": [
        202.5749969482422,
        46
      ],
      "flags": {},
      "order": 25,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "WANVIDEOMODEL",
          "link": 119
        },
        {
          "name": "block_swap_args",
          "shape": 7,
          "type": "BLOCKSWAPARGS",
          "link": 36
        }
      ],
      "outputs": [
        {
          "name": "model",
          "type": "WANVIDEOMODEL",
          "links": [
            35
          ]
        }
      ],
      "properties": {
        "cnr_id": "ComfyUI-WanVideoWrapper",
        "ver": "37365817e82c3d6057fcb0a5d7f952f7376f096a",
        "Node name for S&R": "WanVideoSetBlockSwap"
      },
      "widgets_values": [],
      "color": "#223",
      "bgcolor": "#335"
    },
    {
      "id": 32,
      "type": "WanVideoDecode",
      "pos": [
        3053.248046875,
        43.88642501831055
      ],
      "size": [
        270,
        198
      ],
      "flags": {},
      "order": 27,
      "mode": 0,
      "inputs": [
        {
          "name": "vae",
          "type": "WANVAE",
          "link": 39
        },
        {
          "name": "samples",
          "type": "LATENT",
          "link": 40
        }
      ],
      "outputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "links": [
            109
          ]
        }
      ],
      "properties": {
        "cnr_id": "ComfyUI-WanVideoWrapper",
        "ver": "37365817e82c3d6057fcb0a5d7f952f7376f096a",
        "Node name for S&R": "WanVideoDecode"
      },
      "widgets_values": [
        false,
        272,
        272,
        144,
        128,
        "default"
      ]
    },
    {
      "id": 61,
      "type": "SetNode",
      "pos": [
        532.801513671875,
        1144.129638671875
      ],
      "size": [
        210,
        60
      ],
      "flags": {
        "collapsed": true
      },
      "order": 16,
      "mode": 0,
      "inputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "link": 120
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [
            121
          ]
        }
      ],
      "title": "Set_input_image",
      "properties": {
        "previousName": "input_image"
      },
      "widgets_values": [
        "input_image"
      ],
      "color": "#2a363b",
      "bgcolor": "#3f5159"
    },
    {
      "id": 63,
      "type": "MarkdownNote",
      "pos": [
        -122.2835464477539,
        620.6234741210938
      ],
      "size": [
        434.28240966796875,
        283.2594299316406
      ],
      "flags": {},
      "order": 0,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {},
      "widgets_values": [
        "Model links:\n\n[https://huggingface.co/Kijai/WanVideo_comfy_fp8_scaled/tree/main/](https://huggingface.co/Kijai/WanVideo_comfy_fp8_scaled/tree/main/)\n\nLoRA:\n\n[https://huggingface.co/Kijai/WanVideo_comfy/tree/main/Lightx2v](https://huggingface.co/Kijai/WanVideo_comfy/tree/main/Lightx2v)\n\nText encoder:\n\n[https://huggingface.co/Kijai/WanVideo_comfy/blob/main/umt5-xxl-enc-bf16.safetensors](https://huggingface.co/Kijai/WanVideo_comfy/blob/main/umt5-xxl-enc-bf16.safetensors)\n\nVAE:\n\n[https://huggingface.co/Kijai/WanVideo_comfy/blob/main/Wan2_1_VAE_bf16.safetensors](https://huggingface.co/Kijai/WanVideo_comfy/blob/main/Wan2_1_VAE_bf16.safetensors)\n\nLynx models:\n\n[https://huggingface.co/Kijai/WanVideo_comfy/tree/main/Lynx](https://huggingface.co/Kijai/WanVideo_comfy/tree/main/Lynx)"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 21,
      "type": "PreviewImage",
      "pos": [
        1080.525390625,
        1056.8209228515625
      ],
      "size": [
        210,
        258
      ],
      "flags": {},
      "order": 21,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 113
        }
      ],
      "outputs": [],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.59",
        "Node name for S&R": "PreviewImage"
      },
      "widgets_values": []
    },
    {
      "id": 65,
      "type": "Note",
      "pos": [
        1593.0069580078125,
        1237.267822265625
      ],
      "size": [
        210,
        91.1364974975586
      ],
      "flags": {},
      "order": 1,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {},
      "widgets_values": [
        "In the original code, the prompt for the reference extraction pass was hardcoded as this."
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 37,
      "type": "WanVideoTorchCompileSettings",
      "pos": [
        -42.34662628173828,
        193.6160888671875
      ],
      "size": [
        342.74609375,
        202
      ],
      "flags": {},
      "order": 2,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "torch_compile_args",
          "type": "WANCOMPILEARGS",
          "links": [
            111
          ]
        }
      ],
      "properties": {
        "cnr_id": "ComfyUI-WanVideoWrapper",
        "ver": "37365817e82c3d6057fcb0a5d7f952f7376f096a",
        "Node name for S&R": "WanVideoTorchCompileSettings"
      },
      "widgets_values": [
        "inductor",
        false,
        "default",
        false,
        64,
        true,
        128
      ],
      "color": "#223",
      "bgcolor": "#335"
    },
    {
      "id": 60,
      "type": "WanVideoSetLoRAs",
      "pos": [
        1203.847412109375,
        598.7035522460938
      ],
      "size": [
        175.1999969482422,
        46
      ],
      "flags": {},
      "order": 23,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "WANVIDEOMODEL",
          "link": 117
        },
        {
          "name": "lora",
          "shape": 7,
          "type": "WANVIDLORA",
          "link": 139
        }
      ],
      "outputs": [
        {
          "name": "model",
          "type": "WANVIDEOMODEL",
          "links": [
            119
          ]
        }
      ],
      "properties": {
        "cnr_id": "ComfyUI-WanVideoWrapper",
        "ver": "174cba575912a534e8c106c0c318c48f3df0e053",
        "Node name for S&R": "WanVideoSetLoRAs"
      },
      "widgets_values": [],
      "color": "#223",
      "bgcolor": "#335"
    },
    {
      "id": 35,
      "type": "LoadImage",
      "pos": [
        62.843509674072266,
        1122.969482421875
      ],
      "size": [
        335.2794494628906,
        475.0510559082031
      ],
      "flags": {},
      "order": 3,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [
            120
          ]
        },
        {
          "name": "MASK",
          "type": "MASK",
          "links": null
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.59",
        "Node name for S&R": "LoadImage"
      },
      "widgets_values": [
        "oldman_upscaled.png",
        "image"
      ]
    },
    {
      "id": 64,
      "type": "Note",
      "pos": [
        730.4488525390625,
        1214.236328125
      ],
      "size": [
        320.8675842285156,
        233.28762817382812
      ],
      "flags": {},
      "order": 4,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "Note: Insightface",
      "properties": {},
      "widgets_values": [
        "Original code and this node uses insightface only to crop the image, you can use other crop automatic face croppers or manually crop the face for the ip_image as well. The image is tiny 112x112\n\nWhile InsightFace code is MIT licensed, the Buffalo -model used has strictly \"non-commercial research purposes only\" -license\n\nFor the actual encoding Arcface model is used, I couldn't find clear answer to what it's license is.\n\nFor the reference the original code uses different slightly more zoomed out cropping  for 256x256 input image, you can do this manually as well."
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 12,
      "type": "WanVideoModelLoader",
      "pos": [
        384.0904235839844,
        437.55438232421875
      ],
      "size": [
        609.2658081054688,
        318
      ],
      "flags": {},
      "order": 19,
      "mode": 0,
      "inputs": [
        {
          "name": "compile_args",
          "shape": 7,
          "type": "WANCOMPILEARGS",
          "link": 111
        },
        {
          "name": "block_swap_args",
          "shape": 7,
          "type": "BLOCKSWAPARGS",
          "link": null
        },
        {
          "name": "lora",
          "shape": 7,
          "type": "WANVIDLORA",
          "link": null
        },
        {
          "name": "vram_management_args",
          "shape": 7,
          "type": "VRAM_MANAGEMENTARGS",
          "link": null
        },
        {
          "name": "extra_model",
          "shape": 7,
          "type": "VACEPATH",
          "link": 135
        },
        {
          "name": "fantasytalking_model",
          "shape": 7,
          "type": "FANTASYTALKINGMODEL",
          "link": null
        },
        {
          "name": "multitalk_model",
          "shape": 7,
          "type": "MULTITALKMODEL",
          "link": null
        },
        {
          "name": "fantasyportrait_model",
          "shape": 7,
          "type": "FANTASYPORTRAITMODEL",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "model",
          "type": "WANVIDEOMODEL",
          "links": [
            117
          ]
        }
      ],
      "properties": {
        "cnr_id": "ComfyUI-WanVideoWrapper",
        "ver": "37365817e82c3d6057fcb0a5d7f952f7376f096a",
        "Node name for S&R": "WanVideoModelLoader"
      },
      "widgets_values": [
        "WanVideo\\fp8_scaled_kj\\T2V\\Wan2_1-T2V-14B_fp8_e4m3fn_scaled_KJ.safetensors",
        "fp16_fast",
        "disabled",
        "offload_device",
        "sageattn",
        "default"
      ],
      "color": "#223",
      "bgcolor": "#335"
    },
    {
      "id": 36,
      "type": "PreviewImage",
      "pos": [
        1324.6285400390625,
        1061.2957763671875
      ],
      "size": [
        210,
        258
      ],
      "flags": {},
      "order": 22,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 114
        }
      ],
      "outputs": [],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.59",
        "Node name for S&R": "PreviewImage"
      },
      "widgets_values": []
    },
    {
      "id": 66,
      "type": "Note",
      "pos": [
        1838.8494873046875,
        434.2574768066406
      ],
      "size": [
        351.72918701171875,
        174.49427795410156
      ],
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {},
      "widgets_values": [
        "lite lynx model only includes ip adapter for face id.\n\nfull lynx model also includes reference adapter, which works by first running your reference image through the model for 1 step, and the main inference then uses those extracted values on each step.\n\nThe reference adapter feels extremely strong and usually reducing it's strength or limiting the blocks it is applied to helps avoid that"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 52,
      "type": "LynxEncodeFaceIP",
      "pos": [
        1087.304931640625,
        905.4612426757812
      ],
      "size": [
        198.4499969482422,
        46
      ],
      "flags": {},
      "order": 20,
      "mode": 0,
      "inputs": [
        {
          "name": "resampler",
          "type": "LYNXRESAMPLER",
          "link": 89
        },
        {
          "name": "ip_image",
          "type": "IMAGE",
          "link": 95
        }
      ],
      "outputs": [
        {
          "name": "lynx_face_embeds",
          "type": "LYNXIP",
          "links": [
            126
          ]
        }
      ],
      "properties": {
        "cnr_id": "ComfyUI-WanVideoWrapper",
        "ver": "174cba575912a534e8c106c0c318c48f3df0e053",
        "Node name for S&R": "LynxEncodeFaceIP"
      },
      "widgets_values": []
    },
    {
      "id": 16,
      "type": "LoadLynxResampler",
      "pos": [
        62.8701057434082,
        977.65185546875
      ],
      "size": [
        350,
        82
      ],
      "flags": {},
      "order": 6,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "resampler",
          "type": "LYNXRESAMPLER",
          "links": [
            89
          ]
        }
      ],
      "properties": {
        "cnr_id": "ComfyUI-WanVideoWrapper",
        "ver": "37365817e82c3d6057fcb0a5d7f952f7376f096a",
        "Node name for S&R": "LoadLynxResampler"
      },
      "widgets_values": [
        "WanVideo\\lynx\\lynx_lite_resampler_fp32.safetensors",
        "fp16"
      ]
    },
    {
      "id": 51,
      "type": "WanVideoTextEncodeCached",
      "pos": [
        1852.8812255859375,
        973.4616088867188
      ],
      "size": [
        532.5263061523438,
        354.6100769042969
      ],
      "flags": {},
      "order": 7,
      "mode": 0,
      "inputs": [
        {
          "name": "extender_args",
          "shape": 7,
          "type": "WANVIDEOPROMPTEXTENDER_ARGS",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "text_embeds",
          "type": "WANVIDEOTEXTEMBEDS",
          "links": [
            136
          ]
        },
        {
          "name": "negative_text_embeds",
          "type": "WANVIDEOTEXTEMBEDS",
          "links": null
        },
        {
          "name": "positive_prompt",
          "type": "STRING",
          "links": null
        }
      ],
      "properties": {
        "cnr_id": "ComfyUI-WanVideoWrapper",
        "ver": "37365817e82c3d6057fcb0a5d7f952f7376f096a",
        "Node name for S&R": "WanVideoTextEncodeCached"
      },
      "widgets_values": [
        "umt5-xxl-enc-bf16.safetensors",
        "bf16",
        "image of a face",
        "",
        "disabled",
        true,
        "gpu"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 53,
      "type": "LynxInsightFaceCrop",
      "pos": [
        767.8928833007812,
        1115.97900390625
      ],
      "size": [
        180.0749969482422,
        46
      ],
      "flags": {},
      "order": 18,
      "mode": 0,
      "inputs": [
        {
          "name": "image",
          "type": "IMAGE",
          "link": 121
        }
      ],
      "outputs": [
        {
          "name": "ip_image",
          "type": "IMAGE",
          "links": [
            95,
            113
          ]
        },
        {
          "name": "ref_image",
          "type": "IMAGE",
          "links": [
            114,
            137
          ]
        }
      ],
      "properties": {
        "cnr_id": "ComfyUI-WanVideoWrapper",
        "ver": "174cba575912a534e8c106c0c318c48f3df0e053",
        "Node name for S&R": "LynxInsightFaceCrop"
      },
      "widgets_values": []
    },
    {
      "id": 31,
      "type": "WanVideoVAELoader",
      "pos": [
        2551.93994140625,
        30.22148323059082
      ],
      "size": [
        334.9571533203125,
        82
      ],
      "flags": {},
      "order": 8,
      "mode": 0,
      "inputs": [
        {
          "name": "compile_args",
          "shape": 7,
          "type": "WANCOMPILEARGS",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "vae",
          "type": "WANVAE",
          "links": [
            39,
            107
          ]
        }
      ],
      "properties": {
        "cnr_id": "ComfyUI-WanVideoWrapper",
        "ver": "37365817e82c3d6057fcb0a5d7f952f7376f096a",
        "Node name for S&R": "WanVideoVAELoader"
      },
      "widgets_values": [
        "wanvideo\\Wan2_1_VAE_bf16.safetensors",
        "bf16"
      ],
      "color": "#322",
      "bgcolor": "#533"
    },
    {
      "id": 57,
      "type": "ImageConcatMulti",
      "pos": [
        3052.36669921875,
        315.6687316894531
      ],
      "size": [
        270,
        150
      ],
      "flags": {},
      "order": 28,
      "mode": 0,
      "inputs": [
        {
          "name": "image_1",
          "type": "IMAGE",
          "link": 109
        },
        {
          "name": "image_2",
          "shape": 7,
          "type": "IMAGE",
          "link": 122
        }
      ],
      "outputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "links": [
            112
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfyui-kjnodes",
        "ver": "b1fffd33ba8b14cb4900e2c557f4a2ba0b340ff5"
      },
      "widgets_values": [
        2,
        "left",
        true,
        null
      ]
    },
    {
      "id": 62,
      "type": "GetNode",
      "pos": [
        3057.438720703125,
        516.5675659179688
      ],
      "size": [
        210,
        60
      ],
      "flags": {
        "collapsed": true
      },
      "order": 9,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [
            122
          ]
        }
      ],
      "title": "Get_input_image",
      "properties": {},
      "widgets_values": [
        "input_image"
      ],
      "color": "#2a363b",
      "bgcolor": "#3f5159"
    },
    {
      "id": 13,
      "type": "WanVideoExtraModelSelect",
      "pos": [
        -671.5703735351562,
        535.4902954101562
      ],
      "size": [
        477.6412658691406,
        59.95210266113281
      ],
      "flags": {},
      "order": 17,
      "mode": 0,
      "inputs": [
        {
          "name": "prev_model",
          "shape": 7,
          "type": "VACEPATH",
          "link": 134
        }
      ],
      "outputs": [
        {
          "name": "extra_model",
          "type": "VACEPATH",
          "links": [
            135
          ]
        }
      ],
      "properties": {
        "cnr_id": "ComfyUI-WanVideoWrapper",
        "ver": "37365817e82c3d6057fcb0a5d7f952f7376f096a",
        "Node name for S&R": "WanVideoExtraModelSelect"
      },
      "widgets_values": [
        "WanVideo\\lynx\\Wan2_1-T2V-Lynx_full_ref_layers_fp16.safetensors"
      ],
      "color": "#223",
      "bgcolor": "#335"
    },
    {
      "id": 69,
      "type": "WanVideoExtraModelSelect",
      "pos": [
        -683.1736450195312,
        419.47369384765625
      ],
      "size": [
        477.6412658691406,
        59.95210266113281
      ],
      "flags": {},
      "order": 10,
      "mode": 0,
      "inputs": [
        {
          "name": "prev_model",
          "shape": 7,
          "type": "VACEPATH",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "extra_model",
          "type": "VACEPATH",
          "links": [
            134
          ]
        }
      ],
      "properties": {
        "cnr_id": "ComfyUI-WanVideoWrapper",
        "ver": "37365817e82c3d6057fcb0a5d7f952f7376f096a",
        "Node name for S&R": "WanVideoExtraModelSelect"
      },
      "widgets_values": [
        "WanVideo\\lynx\\Wan2_1-T2V-Lynx_lite_ip_layers_fp16.safetensors"
      ],
      "color": "#223",
      "bgcolor": "#335"
    },
    {
      "id": 72,
      "type": "Note",
      "pos": [
        -626.7315673828125,
        664.1754760742188
      ],
      "size": [
        370.65289306640625,
        129.35208129882812
      ],
      "flags": {},
      "order": 11,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {},
      "widgets_values": [
        "Original implementation uses full ip layers with full ref layers, I don't know if there's some mistake in my implementation as the full ip adapter seems very weak, and using lite ip instead seems better, and also uses less memory."
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 74,
      "type": "WanVideoLoraSelectMulti",
      "pos": [
        523.8887939453125,
        18.619842529296875
      ],
      "size": [
        522.9938354492188,
        342
      ],
      "flags": {},
      "order": 12,
      "mode": 0,
      "inputs": [
        {
          "name": "prev_lora",
          "shape": 7,
          "type": "WANVIDLORA",
          "link": null
        },
        {
          "name": "blocks",
          "shape": 7,
          "type": "SELECTEDBLOCKS",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "lora",
          "type": "WANVIDLORA",
          "links": [
            139
          ]
        }
      ],
      "properties": {
        "cnr_id": "ComfyUI-WanVideoWrapper",
        "ver": "174cba575912a534e8c106c0c318c48f3df0e053",
        "Node name for S&R": "WanVideoLoraSelectMulti"
      },
      "widgets_values": [
        "WanVideo\\Lightx2v\\lightx2v_T2V_14B_cfg_step_distill_v2_lora_rank64_bf16_.safetensors",
        1,
        "WanVid\\funreward\\Wan2.1-Fun-14B-InP-HPS2.1_reward_lora_comfy.safetensors",
        0.5,
        "none",
        1,
        "none",
        1,
        "none",
        1,
        false,
        false
      ],
      "color": "#223",
      "bgcolor": "#335"
    },
    {
      "id": 24,
      "type": "WanVideoEmptyEmbeds",
      "pos": [
        1491.357666015625,
        667.6817626953125
      ],
      "size": [
        272.431640625,
        126
      ],
      "flags": {},
      "order": 13,
      "mode": 0,
      "inputs": [
        {
          "name": "control_embeds",
          "shape": 7,
          "type": "WANVIDIMAGE_EMBEDS",
          "link": null
        },
        {
          "name": "extra_latents",
          "shape": 7,
          "type": "LATENT",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "image_embeds",
          "type": "WANVIDIMAGE_EMBEDS",
          "links": [
            101
          ]
        }
      ],
      "properties": {
        "cnr_id": "ComfyUI-WanVideoWrapper",
        "ver": "37365817e82c3d6057fcb0a5d7f952f7376f096a",
        "Node name for S&R": "WanVideoEmptyEmbeds"
      },
      "widgets_values": [
        832,
        480,
        121
      ]
    },
    {
      "id": 29,
      "type": "WanVideoBlockSwap",
      "pos": [
        1147.027587890625,
        164.4652099609375
      ],
      "size": [
        281.404296875,
        202
      ],
      "flags": {},
      "order": 14,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "block_swap_args",
          "type": "BLOCKSWAPARGS",
          "links": [
            36
          ]
        }
      ],
      "properties": {
        "cnr_id": "ComfyUI-WanVideoWrapper",
        "ver": "37365817e82c3d6057fcb0a5d7f952f7376f096a",
        "Node name for S&R": "WanVideoBlockSwap"
      },
      "widgets_values": [
        35,
        false,
        false,
        true,
        0,
        1,
        false
      ],
      "color": "#223",
      "bgcolor": "#335"
    },
    {
      "id": 58,
      "type": "VHS_VideoCombine",
      "pos": [
        3372.08154296875,
        46.2856559753418
      ],
      "size": [
        1784.03125,
        993.3772583007812
      ],
      "flags": {},
      "order": 29,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 112
        },
        {
          "name": "audio",
          "shape": 7,
          "type": "AUDIO",
          "link": null
        },
        {
          "name": "meta_batch",
          "shape": 7,
          "type": "VHS_BatchManager",
          "link": null
        },
        {
          "name": "vae",
          "shape": 7,
          "type": "VAE",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "Filenames",
          "type": "VHS_FILENAMES",
          "links": null
        }
      ],
      "properties": {
        "cnr_id": "comfyui-videohelpersuite",
        "ver": "0edce8ef7ce173ac97a3ed3d6f4636029d1a4530",
        "Node name for S&R": "VHS_VideoCombine"
      },
      "widgets_values": {
        "frame_rate": 24,
        "loop_count": 0,
        "filename_prefix": "Wanlynx",
        "format": "video/h264-mp4",
        "pix_fmt": "yuv420p",
        "crf": 19,
        "save_metadata": true,
        "trim_to_audio": false,
        "pingpong": false,
        "save_output": false,
        "videopreview": {
          "hidden": false,
          "paused": false,
          "params": {
            "filename": "Wanlynx_00041.mp4",
            "subfolder": "",
            "type": "temp",
            "format": "video/h264-mp4",
            "frame_rate": 24,
            "workflow": "Wanlynx_00041.png",
            "fullpath": "N:\\AI\\ComfyUI\\temp\\Wanlynx_00041.mp4"
          }
        }
      }
    },
    {
      "id": 26,
      "type": "WanVideoTextEncodeCached",
      "pos": [
        1806.466796875,
        -51.649444580078125
      ],
      "size": [
        558.2944946289062,
        382.5255432128906
      ],
      "flags": {},
      "order": 15,
      "mode": 0,
      "inputs": [
        {
          "name": "extender_args",
          "shape": 7,
          "type": "WANVIDEOPROMPTEXTENDER_ARGS",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "text_embeds",
          "type": "WANVIDEOTEXTEMBEDS",
          "links": [
            31
          ]
        },
        {
          "name": "negative_text_embeds",
          "type": "WANVIDEOTEXTEMBEDS",
          "links": null
        },
        {
          "name": "positive_prompt",
          "type": "STRING",
          "links": null
        }
      ],
      "properties": {
        "cnr_id": "ComfyUI-WanVideoWrapper",
        "ver": "37365817e82c3d6057fcb0a5d7f952f7376f096a",
        "Node name for S&R": "WanVideoTextEncodeCached"
      },
      "widgets_values": [
        "umt5-xxl-enc-bf16.safetensors",
        "bf16",
        "an old man is sitting in the forest and petting a tame lynx, he's looking at the lynx in amazement, with a wide grin on his face",
        "色调艳丽，过曝，静态，细节模糊不清，字幕，风格，作品，画作，画面，静止，整体发灰，最差质量，低质量，JPEG压缩残留，丑陋的，残缺的，多余的手指，画得不好的手部，画得不好的脸部，畸形的，毁容的，形态畸形的肢体，手指融合，静止不动的画面，杂乱的背景，三条腿，背景人很多，倒着走",
        "disabled",
        true,
        "gpu"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 55,
      "type": "WanVideoAddLynxEmbeds",
      "pos": [
        1840.908447265625,
        668.7803955078125
      ],
      "size": [
        281.57501220703125,
        254
      ],
      "flags": {},
      "order": 24,
      "mode": 0,
      "inputs": [
        {
          "name": "embeds",
          "type": "WANVIDIMAGE_EMBEDS",
          "link": 101
        },
        {
          "name": "vae",
          "shape": 7,
          "type": "WANVAE",
          "link": 107
        },
        {
          "name": "lynx_ip_embeds",
          "shape": 7,
          "type": "LYNXIP",
          "link": 126
        },
        {
          "name": "ref_image",
          "shape": 7,
          "type": "IMAGE",
          "link": 137
        },
        {
          "name": "ref_text_embed",
          "shape": 7,
          "type": "WANVIDEOTEXTEMBEDS",
          "link": 136
        },
        {
          "name": "ref_blocks_to_use",
          "shape": 7,
          "type": "STRING",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "image_embeds",
          "type": "WANVIDIMAGE_EMBEDS",
          "links": [
            104
          ]
        }
      ],
      "properties": {
        "cnr_id": "ComfyUI-WanVideoWrapper",
        "ver": "174cba575912a534e8c106c0c318c48f3df0e053",
        "Node name for S&R": "WanVideoAddLynxEmbeds"
      },
      "widgets_values": [
        0.7,
        0.6,
        2,
        0,
        1
      ]
    },
    {
      "id": 22,
      "type": "WanVideoSampler",
      "pos": [
        2550.7099609375,
        230.54959106445312
      ],
      "size": [
        327.80859375,
        881.5819091796875
      ],
      "flags": {},
      "order": 26,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "WANVIDEOMODEL",
          "link": 35
        },
        {
          "name": "image_embeds",
          "type": "WANVIDIMAGE_EMBEDS",
          "link": 104
        },
        {
          "name": "text_embeds",
          "shape": 7,
          "type": "WANVIDEOTEXTEMBEDS",
          "link": 31
        },
        {
          "name": "samples",
          "shape": 7,
          "type": "LATENT",
          "link": null
        },
        {
          "name": "feta_args",
          "shape": 7,
          "type": "FETAARGS",
          "link": null
        },
        {
          "name": "context_options",
          "shape": 7,
          "type": "WANVIDCONTEXT",
          "link": null
        },
        {
          "name": "cache_args",
          "shape": 7,
          "type": "CACHEARGS",
          "link": null
        },
        {
          "name": "flowedit_args",
          "shape": 7,
          "type": "FLOWEDITARGS",
          "link": null
        },
        {
          "name": "slg_args",
          "shape": 7,
          "type": "SLGARGS",
          "link": null
        },
        {
          "name": "loop_args",
          "shape": 7,
          "type": "LOOPARGS",
          "link": null
        },
        {
          "name": "experimental_args",
          "shape": 7,
          "type": "EXPERIMENTALARGS",
          "link": null
        },
        {
          "name": "sigmas",
          "shape": 7,
          "type": "SIGMAS",
          "link": null
        },
        {
          "name": "unianimate_poses",
          "shape": 7,
          "type": "UNIANIMATE_POSE",
          "link": null
        },
        {
          "name": "fantasytalking_embeds",
          "shape": 7,
          "type": "FANTASYTALKING_EMBEDS",
          "link": null
        },
        {
          "name": "uni3c_embeds",
          "shape": 7,
          "type": "UNI3C_EMBEDS",
          "link": null
        },
        {
          "name": "multitalk_embeds",
          "shape": 7,
          "type": "MULTITALK_EMBEDS",
          "link": null
        },
        {
          "name": "freeinit_args",
          "shape": 7,
          "type": "FREEINITARGS",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "samples",
          "type": "LATENT",
          "links": [
            40
          ]
        },
        {
          "name": "denoised_samples",
          "type": "LATENT",
          "links": null
        }
      ],
      "properties": {
        "cnr_id": "ComfyUI-WanVideoWrapper",
        "ver": "37365817e82c3d6057fcb0a5d7f952f7376f096a",
        "Node name for S&R": "WanVideoSampler"
      },
      "widgets_values": [
        6,
        1,
        8,
        42,
        "fixed",
        true,
        "lcm",
        0,
        1,
        false,
        "comfy",
        0,
        -1,
        false
      ]
    }
  ],
  "links": [
    [
      31,
      26,
      0,
      22,
      2,
      "WANVIDEOTEXTEMBEDS"
    ],
    [
      35,
      28,
      0,
      22,
      0,
      "WANVIDEOMODEL"
    ],
    [
      36,
      29,
      0,
      28,
      1,
      "BLOCKSWAPARGS"
    ],
    [
      39,
      31,
      0,
      32,
      0,
      "WANVAE"
    ],
    [
      40,
      22,
      0,
      32,
      1,
      "LATENT"
    ],
    [
      89,
      16,
      0,
      52,
      0,
      "LYNXRESAMPLER"
    ],
    [
      95,
      53,
      0,
      52,
      1,
      "IMAGE"
    ],
    [
      101,
      24,
      0,
      55,
      0,
      "WANVIDIMAGE_EMBEDS"
    ],
    [
      104,
      55,
      0,
      22,
      1,
      "WANVIDIMAGE_EMBEDS"
    ],
    [
      107,
      31,
      0,
      55,
      1,
      "WANVAE"
    ],
    [
      109,
      32,
      0,
      57,
      0,
      "IMAGE"
    ],
    [
      111,
      37,
      0,
      12,
      0,
      "WANCOMPILEARGS"
    ],
    [
      112,
      57,
      0,
      58,
      0,
      "IMAGE"
    ],
    [
      113,
      53,
      0,
      21,
      0,
      "IMAGE"
    ],
    [
      114,
      53,
      1,
      36,
      0,
      "IMAGE"
    ],
    [
      117,
      12,
      0,
      60,
      0,
      "WANVIDEOMODEL"
    ],
    [
      119,
      60,
      0,
      28,
      0,
      "WANVIDEOMODEL"
    ],
    [
      120,
      35,
      0,
      61,
      0,
      "*"
    ],
    [
      121,
      61,
      0,
      53,
      0,
      "IMAGE"
    ],
    [
      122,
      62,
      0,
      57,
      1,
      "IMAGE"
    ],
    [
      126,
      52,
      0,
      55,
      2,
      "LYNXIP"
    ],
    [
      134,
      69,
      0,
      13,
      0,
      "VACEPATH"
    ],
    [
      135,
      13,
      0,
      12,
      4,
      "VACEPATH"
    ],
    [
      136,
      51,
      0,
      55,
      4,
      "WANVIDEOTEXTEMBEDS"
    ],
    [
      137,
      53,
      1,
      55,
      3,
      "IMAGE"
    ],
    [
      139,
      74,
      0,
      60,
      1,
      "WANVIDLORA"
    ]
  ],
  "groups": [],
  "config": {},
  "extra": {
    "ds": {
      "scale": 0.6830134553650709,
      "offset": [
        -1421.4589565507106,
        130.7726058690394
      ]
    },
    "frontendVersion": "1.28.1",
    "VHS_latentpreview": true,
    "VHS_latentpreviewrate": 0,
    "VHS_MetadataImage": true,
    "VHS_KeepIntermediate": true,
    "node_versions": {
      "ComfyUI-WanVideoWrapper": "1ba1a1662b2db34969c4dbe2d13d8a4780491d30",
      "ComfyUI-KJNodes": "9d7af919b91838fb22e31ad0107a6ddcf8bd7f3f",
      "comfy-core": "0.3.61",
      "comfyui-videohelpersuite": "8e4d79471bf1952154768e8435a9300077b534fa"
    }
  },
  "version": 0.4
}